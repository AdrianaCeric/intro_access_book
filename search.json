[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Introdução à acessibilidade urbana",
    "section": "",
    "text": "O objetivo deste livro é apresentar uma introdução sobre os conceitos e habilidades práticas necessárias para fazer estudos e avaliações de impacto sobre acessibilidade urbana. O livro começa dando uma visão geral sobre o conceito e indicadores de acessibilidade. Em seguida, ensina como analisar dados espaciais e de redes de transporte para se calcular estimativas de acessibilidade por diferentes modos de transporte e como visualizar esses resultados em mapas e gráficos. O livro também busca familiarizar o leitor com dados de redes de transporte público em formato GTFS e ensina como manipular e visualizar esse tipo de dado. Num dos seus principais capítulos, o livro ensina ainda como os dados e metodologia apresentados nos capítulos anteriores podem ser utilizados para avaliar o impacto de projetos de transporte sobre as condições de acesso a oportunidades da população. Por fim, o livro ensina como baixar, analisar e visualizar estimativas de acessibilidade já calculadas para cidades brasileiras e disponibilizadas pela equipe do Projeto Acesso a Oportunidades (AOP) do Ipea.\nO tema da acessibilidade tem recebido cada vez mais atenção de agências de transporte, instituições de financiamento, tomadores de decisão e pesquisadores na área de planejamento urbano e de transportes (Papa et al. 2015; Boisjoly and El-Geneidy 2017). Com isso, existe um crescente número de artigos científicos (Miller 2018; van Wee 2021) e livros (Levine, Grengs, and Merlin 2019; Levinson and King 2020) que trazem rico material para discussão e aprofundamento sobre questões relacionadas à acessibilidade urbana. No entanto, não existem na literatura livros ou artigos que sirvam simultaneamente de material didático introdutório sobre o tema e de manual prático de metodologia e análise de dados. A ausência desse tipo de material explica, ao menos em parte, porque diversas agências de transporte e analistas ainda enfrentam desafios em incorporar questões e indicadores de acessibilidade no seu dia-a-dia de planejamento e pesquisa (Silva et al. 2017; Büttner 2021).\nEste livro foi escrito pensando nas necessidades de trabalho de gestores públicos, analistas, alunos e pesquisadores de planejamento e transporte urbano. Por isso, o livro tem caráter prático. Todo material do livro é apresentado com exemplos reproduzíveis e dados abertos utilizando-se programação em R. O objetivo é equipar seus leitores com os conceitos fundamentais e as ferramentas de análise e processamento de dados necessárias para realizar análises de acessibilidade urbana e conduzir avaliações do impacto de projetos e políticas de transporte a partir de dados e programas de código abertos.\n\nEste livro está dividido em 5 seções:\n\nSeção 1: A primeira seção apresenta o conceito de acessibilidade urbana, esclarece a diferença entre acessibilidade e mobilidade urbana, e apresenta os principais indicadores usados para medir a acessibilidade urbana.\nSeção 2: A segunda seção ensina como calcular estimativas de acessibilidade urbana em R usando os pacotes r5r e accessibility a partir de dados públicos abertos.\nSeção 3: A terceira seção apresenta o que é a especificação GTFS de dados de transporte público, e mostra como trabalhar e analisar dados de GTFS usando o pacote gtfstools.\nSeção 4: A quarta seção mostra como o conhecimento dos capítulos anteriores pode ser utilizado para se avaliar o impacto de políticas urbanas sobre condições de acessibilidade urbana usando R.\nSeção 5: Por fim, a quinta seção mostra como fazer download e analisar os dados do projeto Acesso a Oportunidades (AOP) para analisar a distribuição espacial e socioeconômica das condições de acesso a oportunidades nas cidades brasileiras.\n\nEste livro traz diversos exemplos reproduzíveis de análise de dados em R. A maneira mais fácil de você rodar todo o código do livro no seu navegador (web browser) é utilizando o Binder. Clicando neste link, você será direcionado para uma sessão do RStudio dentro do seu navegador onde você poderá abrir e rodar os scripts de todos os capítulos do livro.\n\n\n\n\n\n\n\n\n\n\n\n\nEste livro foi escrito e publicado com o sistema de publicação Quarto. Todo o código utilizado em seu preparo e na sua publicação do pode ser encontrado neste repositório.\n\n\n\nSe você quiser rodar o conteúdo do livro localmente na sua máquina, você pode clonar o repositório do livro e ter o RStudio instalado. Após abrir o projeto intro_access_book.Rproj, basta rodar a função:\nquarto::quarto_preview().\n\n É permitida a reprodução e a exibição para uso educacional ou informativo, desde que respeitado o crédito ao autor original e citada a fonte. Permitida a inclusão da obra em Repositórios ou Portais de Acesso Aberto, desde que fique claro para os usuários os termos de uso da obra e quem é o detentor dos direitos autorais, o Instituto de Pesquisa Econômica Aplicada (Ipea). Proibido o uso comercial ou com finalidades lucrativas em qualquer hipótese. Proibida a criação de obras derivadas. Para imagens estáticas e em movimento (vídeos e audiovisuais), ATENÇÃO: os direitos de imagem foram cedidos apenas para a obra original, formato de distribuição e repositório. Esta licença está baseada em estudos sobre a Lei Brasileira de Direitos Autorais (Lei 9.610/1998).\n\nCaso você use o material deste livro, pedimos por gentileza que você cite o livro utilizando a seguinte referência:\n\nPereira, Rafael H. M. & Herszenhut, Daniel. (2022) Introdução à acessibilidade urbana um guia prático em R. Instituto de Pesquisa Econômica Aplicada.\n\nEste livro foi elaborado pelo Instituto de Pesquisa Econômica Aplicada (Ipea) no âmbito da parceria entre Ipea e a Secretaria de Mobilidade e Desenvolvimento Regional e Urbano (SMDRU) do Ministério do Desenvolvimento Regional (MDR).\n\n\n\n\nBoisjoly, Geneviève, and Ahmed M. El-Geneidy. 2017. “How to Get There? A Critical Assessment of Accessibility Objectives and Indicators in Metropolitan Transportation Plans.” Transport Policy 55 (April): 38–50. https://doi.org/10.1016/j.tranpol.2016.12.011.\n\n\nBüttner, Benjamin. 2021. “Accessibility Tools for Transport Policy and Planning.” In International Encyclopedia of Transportation, edited by Roger Vickerman, 83–86. Oxford: Elsevier. https://doi.org/10.1016/B978-0-08-102671-7.10618-9.\n\n\nLevine, Jonathan, Joe Grengs, and Louis A. Merlin. 2019. From Mobility to Accessibility: Transforming Urban Transportation and Land-Use Planning. Cornell University Press.\n\n\nLevinson, David, and David King. 2020. Transport Access Manual: A Guide for Measuring Connection Between People and Places. Committee of the Transport Access Manual, University of Sydney.\n\n\nMiller, Eric J. 2018. “Accessibility: Measurement and Application in Transportation Planning.” Transport Reviews 38 (5): 551–55. https://doi.org/10.1080/01441647.2018.1492778.\n\n\nPapa, Enrica, Cecilia Silva, Marco Te Brömmelstroet, and Angela Hull. 2015. “Accessibility Instruments for Planning Practice: A Review of European Experiences.” Journal of Transport and Land Use, June. https://doi.org/10.5198/jtlu.2015.585.\n\n\nSilva, Cecília, Luca Bertolini, Marco te Brömmelstroet, Dimitris Milakis, and Enrica Papa. 2017. “Accessibility Instruments in Planning Practice: Bridging the Implementation Gap.” Transport Policy 53 (January): 135–45. https://doi.org/10.1016/j.tranpol.2016.09.006.\n\n\nvan Wee, Bert. 2021. “Transport Modes and Accessibility.” In International Encyclopedia of Transportation, edited by Roger Vickerman, 32–37. Oxford: Elsevier. https://doi.org/10.1016/B978-0-08-102671-7.10402-6."
  },
  {
    "objectID": "s1_intro.html",
    "href": "s1_intro.html",
    "title": "SEÇÃO 1: Introdução à acessibilidade urbana",
    "section": "",
    "text": "Quantos postos de trabalho uma pessoa em um determinado local consegue alcançar em até uma hora de viagem usando transporte público? Quanto tempo essa pessoa leva para chegar até o posto de saúde ou a escola mais próxima de sua casa? As respostas a essas perguntas dependem diretamente das políticas locais de transporte e de desenvolvimento urbano. Essas políticas determinam os níveis de acessibilidade urbana em cada cidade - isto é, a facilidade com que cada indivíduo consegue acessar oportunidades de emprego, serviços de saúde e educação, atividades culturais e de lazer, entre outros tipos de atividade. A acessibilidade, portanto, é simultaneamente um resultado da conectividade e performance dos sistemas de transporte, da organização espacial das cidades em termos da distribuição da população, atividades econômicas e serviços públicos por seu território. Assim, a promoção da acessibilidade tem papel-chave para o desenvolvimento econômico, e para promoção de cidades mais sustentáveis e inclusivas. Ao longo desta seção vamos entender com mais detalhes o conceito de acessibilidade, por que ele é importante para entendermos o funcionamento das cidades e quais os indicadores mais comumente utilizados para medir a acessibilidade urbana."
  },
  {
    "objectID": "1_conceito.html",
    "href": "1_conceito.html",
    "title": "1  O que é acessibilidade?",
    "section": "",
    "text": "Acessibilidade é a facilidade com que as pessoas conseguem alcançar lugares e oportunidades – ou, inversamente, uma característica de lugares e oportunidades em termos do quão facilmente eles podem ser alcançados pela população (Geurs and van Wee 2004; Neutens et al. 2010).\nAs condições de acessibilidade são influenciadas tanto pela co-distribuição espacial da população e de atividades econômicas e serviços públicos quanto pela configuração e desempenho da rede de transportes. Nesse sentido, a acessibilidade urbana tem papel fundamental na capacidade das pessoas de se deslocarem para acessar oportunidades, como empregos, escolas, etc.\nOs níveis de acessibilidade urbana são estabelecidos, portanto, por três componentes distintos:\n\nInfraestrutura: A facilidade de acessar atividades depende da infraestrutura e dos serviços de transporte existentes. Isso inclui, por exemplo, a capilaridade da rede de transporte público, a conectividade da rede viária, a existência de corredores de transporte de alta capacidade, como trens e metrôs, etc. Aqui, tanto a eficiência quanto a conectividade espacial e temporal da rede de transportes são de extrema importância.\nUso do solo: O quão fácil atividades podem ser acessadas também depende da co-distribuição espacial de pessoas e atividades, como escolas, serviços de saúde, áreas de lazer, etc. Esse componente diz respeito à proximidade geográfica entre pessoas e oportunidades: quanto mais longe, mais difícil é o acesso às atividades.\nPessoas: Por fim, não podemos esquecer que a facilidade de acessar atividades também é afetada pelas características individuais de cada pessoa. Fatores como dificuldades motoras e cognitivas, idade, gênero, cor e renda, por exemplo, podem influenciar de maneira importante a capacidade das pessoas se locomoverem, de utilizarem determinados modos de transporte e de circularem pela cidade sem medo de algum tipo de violência ou descriminação.\n\nA consideração desses fatores traz importantes informações para análises sobre equidade e inclusão social. No entanto, a sua influência sobre as condições acessibilidade das pessoas costuma ser melhor captada em análises qualitativas. Por conta de dificuldades operacionais e computacionais, essa dimensão da acessibilidade costuma receber pouca atenção de estudos de larga escala de avaliação de impacto de projetos de transporte. No capítulo Chapter 2, nós ponderamos algumas vantagens e desvantagens de indicadores que conseguem captar essas três dimensões da acessibilidade urbana."
  },
  {
    "objectID": "1_conceito.html#diferença-entre-microacessibilidade-e-acessibilidade-urbana",
    "href": "1_conceito.html#diferença-entre-microacessibilidade-e-acessibilidade-urbana",
    "title": "1  O que é acessibilidade?",
    "section": "1.2 Diferença entre microacessibilidade e acessibilidade urbana",
    "text": "1.2 Diferença entre microacessibilidade e acessibilidade urbana\nPara fins de esclarecimento de conceitos, é importante distinguir entre o que nós chamamos de acessibilidade urbana e o que em geral se entende por acessibilidade, em português.\nO termo acessibilidade é comumente utilizado para se referir a questões de padrões e normas de design universal e de construção e planejamento para inclusão de pessoas com diferentes graus de dificuldades motoras e cognitivas. Isso é o que normalmente entende-se por microacessibilidade, pois abrange questões de acesso a serviços e atividades na escala micro - ou seja, como detalhes do planejamento de espaços públicos e privados, e a construção de veículos e equipamentos o, por exemplo, afetam a capacidade de cada indivíduo de conseguir acessar lugares, serviços, produtos, etc.\nA acessibilidade urbana, por sua vez, pode ser entendida como macroacessibilidade, pois trata de questões de acesso de uma maneira mais ampla. Ou seja, quando falamos de acessibilidade urbana nos concentramos em como questões estruturais de planejamento e desenvolvimento urbano, como a disposição de corredores de transportes e a distribuição espacial de pessoas e atividades, afetam a capacidade das pessoas de acessar oportunidades. Ela trata de como a capacidade de acessar atividades considerando tanto as capacidades das pessoas utilizarem tecnologias de transporte quanto a distribuição espacial de atividades vis-à-vis a cobertura e conectividade da rede de transporte.\nNotadamente, a microacessibilidade e a macroacessibilidade são elementos complementares de uma noção mais ampla de acessibilidade. Condições de microacessibilidade, por exemplo, afetam diretamente a capacidade de pessoas embarcarem e utilizarem diferentes modos de transporte, de se locomoverem com segurança sobre calçadas, de atravessarem ruas, etc. De pouco adianta um indivíduo morar em uma região atendida por uma grande oferta de modos de transporte se a pessoa é cadeirante, por exemplo, e a rede de transporte não é adaptada para pessoas com dificuldade de locomoção. Neste livro focaremos apenas em análises de acessibilidade urbana e muitas vezes utilizaremos o termo acessibilidade como um sinônimo de macroacessibilidade por uma questão de fluência do texto. É importante reconhecer, no entanto, que a macroacessibilidade de forma isolada não é suficiente para descrever as condições de acessibilidade de um indivíduo em sua totalidade, e que para tal precisaríamos olhar também para a microacessibilidade."
  },
  {
    "objectID": "1_conceito.html#por-que-a-acessibilidade-urbana-importa",
    "href": "1_conceito.html#por-que-a-acessibilidade-urbana-importa",
    "title": "1  O que é acessibilidade?",
    "section": "1.3 Por que a acessibilidade urbana importa?",
    "text": "1.3 Por que a acessibilidade urbana importa?\nO conceito de acessibilidade é central em estudos de transporte por diferentes razões. Primeiramente, este conceito articula de maneira explícita como políticas de transporte e políticas de desenvolvimento e uso do solo urbano interagem e impactam a capacidade das pessoas de se deslocarem nas cidades. Por sua vez, o acesso a oportunidades e atividades, como postos de trabalho e serviços de educação e de saúde, por exemplo, tem papel fundamental para a satisfação das necessidades individuais e sociais e para promoção da inclusão social (Pereira and Karner 2021; Luz and Portugal 2022). A promoção da acessibilidade também é uma condição necessária, embora não suficiente, para a expansão da liberdade de escolha das pessoas (Church, Frost, and Sullivan 2000; Lucas et al. 2016; van Wee 2022). O conceito de acessibilidade, portanto, serve como fio condutor para relacionar investimentos e políticas de transportes e uso do solo a questões relacionadas à exclusão social e qualidade de vida de indivíduos, como o potencial de satisfação de necessidades básicas e a liberdade.\nAdicionalmente, a ideia de acessibilidade traz à tona a dimensão espacial de um problema central de justiça social, que é a desigualdade de oportunidades. Ela ajuda, portanto, a explicitamente incorporar a noção de espaço no desenho de políticas destinadas a enfrentar essas injustiças (Farrington and Farrington 2005; Pereira, Schwanen, and Banister 2017). Assim, a noção de acessibilidade se torna peça fundamental para se pensar a equidade de políticas públicas, e de se avaliar os aspectos distributivos de quais grupos sociais e quais bairros se beneficiam dessas políticas.\nComo vimos anteriormente, os níveis de acesso a oportunidades numa cidade são resultado conjunto da capacidade de cada pessoa utilizar tecnologias de transporte e da integração entre a distribuição geográfica de atividades, a distribuição espacial da população na cidade e a conectividade espacial e temporal da rede de transportes (Miller 2018; Páez, Scott, and Morency 2012). O planejamento com foco na acessibilidade, desta forma, passa por um planejamento integrado entre o uso do solo e o sistema de transportes, buscando criar maior proximidade entre pessoas e atividades e reduzindo a dependência de modos de transporte motorizados (Banister 2011). Planejar as cidades e sistemas de transporte visando melhorar a acessibilidade, portanto, é essencial para o desenvolvimento de cidades inclusivas e sustentáveis."
  },
  {
    "objectID": "1_conceito.html#diferença-entre-acessibilidade-e-mobilidade",
    "href": "1_conceito.html#diferença-entre-acessibilidade-e-mobilidade",
    "title": "1  O que é acessibilidade?",
    "section": "1.4 Diferença entre acessibilidade e mobilidade",
    "text": "1.4 Diferença entre acessibilidade e mobilidade\nA diferença entre os conceitos de acessibilidade e mobilidade é frequentemente ignorada, mesmo por pesquisadores e planejadores que lidam com esses temas diariamente. Afinal de contas, existe uma grande intersecção temática entre a acessibilidade e o que se entende de por “mobilidade urbana” enquanto área de pesquisa e política pública: uma área que lida com os deslocamentos das pessoas, que está relacionada ao planejamento de sistemas de transporte coletivo e individual, com o planejamento de redes cicloviárias e de pedestres, etc. Neste contexto, não é raro, por exemplo, ouvir que um determinado grupo populacional “tem menos mobilidade” do que outro, quando na verdade o que se quer dizer é que esse grupo apresenta piores condições de acessibilidade. Qual é, então, a diferença entre acessibilidade e mobilidade?\nNa literatura científica de planejamento urbano e de transportes, o conceito de mobilidade diz respeito aos padrões de viagens que as pessoas efetivamente fazem no seu dia a dia – por exemplo, quantas viagens foram feitas, quais modos de transporte foram usados, qual a distância média das viagens, quanto tempo se gasta no deslocamento casa-trabalho, etc. Informações de mobilidade são tradicionalmente captadas por meio de pesquisas domiciliares origem-destino. Recentemente, com o surgimento de novas tecnologias digitais, dados de GPS de telefones celulares, de cartões de bilhetagem eletrônica, de radares e semáforos urbanos, entre outros, vêm também sendo usados com a finalidade de descrever os deslocamentos diários da população (Anda, Erath, and Fourie 2017; Kandt and Batty 2021). Dados e análises de mobilidade trazem informações sobre as condições diárias de uso do sistema de transportes e sobre os padrões de viagens de indivíduos de diferentes grupos socioeconômicos, o que permite captar aspectos importantes do desempenho econômico e ambiental das cidades e do bem-estar da população.\nO conceito de acessibilidade, por sua vez, está intrinsecamente relacionado ao potencial que as pessoas têm de alcançar atividades e oportunidades. Enquanto uma análise de mobilidade foca, por exemplo, no que as pessoas levam no seu deslocamento diário de sua casa até o seu trabalho, uma análise de acessibilidade tenta identificar, digamos, se as pessoas conseguiriam alcançar seus empregos em um tempo de viagem tido como razoável ou qual a quantidade de empregos potencialmente alcançáveis dentro de um determinado custo de viagem. A acessibilidade trata do quão fácil/factível é alcançar um local, a mobilidade trata de como esse local foi alcançado. Níveis de acessibilidade são, portanto, medidas potenciais, ao passo que os dados de mobilidade descrevem padrões reais, realizados.\nTradicionalmente, o planejamento urbano e de transportes tem como foco a mobilidade, (Banister 2011; Vasconcellos 2018; Levinson and King 2020). Ainda hoje, o foco na mobilidade motiva políticas que priorizam a circulação de automóveis e visam aumentar a velocidade e a fluidez de trânsito para reduzir congestionamentos e, consequentemente, reduzir tempos de deslocamento (Levine, Grengs, and Merlin 2019). Essas políticas, no entanto, tendem a dar um enfoque quantitativo na mobilidade: aumentar o número de viagens, aumentar a velocidade média, diminuir o tempo de congestionamento, etc. Neste contexto, portanto, a mobilidade é vista como um fim em si mesma, e “melhorar” a mobilidade dependeria de políticas como soluções puramente técnicas que deveriam “otimizar” os aspectos quantitativos mencionados anteriormente.\nA mobilidade, no entanto, não pode ser encarada como uma finalidade em si. As pessoas raramente se deslocam pelo simples prazer de se deslocar. Ao contrário, na grande maioria das vezes as pessoas se deslocam como um meio para acessar as atividades no destino da viagem. Neste sentido, tem-se observado um crescente consenso entre pesquisadores e agências de transporte de que o objetivo de uma política de transportes é melhorar o acesso da população (Pereira, Schwanen, and Banister 2017; Martens 2012; Bertolini, le Clercq, and Kapoen 2005). Se o que as pessoas querem é acessar atividades, então é possível pensar em formas de planejamento que facilitem seu acesso a tais atividades sem necessariamente promover o aumento da motorização e da velocidade no trânsito, que implicam no aumento de externalidades econômicas, ambientais, de saúde pública, entre outras.\nNeste caso, há uma mudança de paradigma no planejamento urbano e de transportes: a busca por padrões de viagem mais sustentáveis implica na mudança do foco da mobilidade para a acessibilidade (Banister 2008). Políticas de aumento de velocidade nas vias e de expansão de faixas, por exemplo, podem ser substituídas por políticas de promoção de maior mix de uso do solo e de aproximação de pessoas e atividades, promovendo maior integração entre planejamento de transporte e uso do solo. Quando o foco da política muda da mobilidade para a acessibilidade urbana, abre-se um leque maior de possíveis instrumentos e ações de políticas públicas para promover um desenvolvimento urbano mais integrado e calcado na promoção da sustentabilidade e da inclusão social (Banister 2011; Levine, Grengs, and Merlin 2019).\n\n\n\n\nAnda, Cuauhtemoc, Alexander Erath, and Pieter Jacobus Fourie. 2017. “Transport Modelling in the Age of Big Data.” International Journal of Urban Sciences 21 (sup1): 19–42. https://doi.org/10.1080/12265934.2017.1281150.\n\n\nBanister, David. 2008. “The Sustainable Mobility Paradigm.” Transport Policy 15 (2): 73–80. https://doi.org/10.1016/j.tranpol.2007.10.005.\n\n\n———. 2011. “The Trilogy of Distance, Speed and Time.” Journal of Transport Geography 19 (4): 950–59. https://doi.org/10.1016/j.jtrangeo.2010.12.004.\n\n\nBertolini, L., F. le Clercq, and L. Kapoen. 2005. “Sustainable Accessibility: A Conceptual Framework to Integrate Transport and Land Use Plan-Making. Two Test-Applications in the Netherlands and a Reflection on the Way Forward.” Transport Policy 12 (3): 207–20. https://doi.org/10.1016/j.tranpol.2005.01.006.\n\n\nChurch, A, M Frost, and K Sullivan. 2000. “Transport and Social Exclusion in London.” Transport Policy 7 (3): 195–205. https://doi.org/10.1016/S0967-070X(00)00024-X.\n\n\nFarrington, John, and Conor Farrington. 2005. “Rural Accessibility, Social Inclusion and Social Justice: Towards Conceptualisation.” Journal of Transport Geography 13 (1): 1–12. https://doi.org/10.1016/j.jtrangeo.2004.10.002.\n\n\nGeurs, Karst, and Bert van Wee. 2004. “Accessibility Evaluation of Land-Use and Transport Strategies: Review and Research Directions.” Journal of Transport Geography 12 (2): 127–40. https://doi.org/10.1016/j.jtrangeo.2003.10.005.\n\n\nKandt, Jens, and Michael Batty. 2021. “Smart Cities, Big Data and Urban Policy: Towards Urban Analytics for the Long Run.” Cities 109 (February): 102992. https://doi.org/10.1016/j.cities.2020.102992.\n\n\nLevine, Jonathan, Joe Grengs, and Louis A. Merlin. 2019. From Mobility to Accessibility: Transforming Urban Transportation and Land-Use Planning. Cornell University Press.\n\n\nLevinson, David, and David King. 2020. Transport Access Manual: A Guide for Measuring Connection Between People and Places. Committee of the Transport Access Manual, University of Sydney.\n\n\nLucas, Karen, Giulio Mattioli, Ersilia Verlinghieri, and Alvaro Guzman. 2016. “Transport Poverty and Its Adverse Social Consequences.” Proceedings of the Institution of Civil Engineers - Transport 169 (6): 353–65. https://doi.org/10.1680/jtran.15.00073.\n\n\nLuz, Gregório, and Licinio Portugal. 2022. “Understanding Transport-Related Social Exclusion Through the Lens of Capabilities Approach.” Transport Reviews 42 (4): 503–25. https://doi.org/10.1080/01441647.2021.2005183.\n\n\nMartens, Karel. 2012. “Justice in Transport as Justice in Accessibility: Applying Walzer’s ‘Spheres of Justice’ to the Transport Sector.” Transportation 39 (6): 1035–53. https://doi.org/10.1007/s11116-012-9388-7.\n\n\nMiller, Eric J. 2018. “Accessibility: Measurement and Application in Transportation Planning.” Transport Reviews 38 (5): 551–55. https://doi.org/10.1080/01441647.2018.1492778.\n\n\nNeutens, Tijs, Tim Schwanen, Frank Witlox, and Philippe De Maeyer. 2010. “Equity of Urban Service Delivery: A Comparison of Different Accessibility Measures.” Environment and Planning A: Economy and Space 42 (7): 1613–35. https://doi.org/10.1068/a4230.\n\n\nPáez, Antonio, Darren M. Scott, and Catherine Morency. 2012. “Measuring Accessibility: Positive and Normative Implementations of Various Accessibility Indicators.” Journal of Transport Geography 25 (November): 141–53. https://doi.org/10.1016/j.jtrangeo.2012.03.016.\n\n\nPereira, Rafael H. M., and Alex Karner. 2021. “Transportation Equity.” In International Encyclopedia of Transportation, edited by Roger Vickerman, 271–77. Oxford: Elsevier. https://doi.org/10.1016/B978-0-08-102671-7.10053-3.\n\n\nPereira, Rafael H. M., Tim Schwanen, and David Banister. 2017. “Distributive Justice and Equity in Transportation.” Transport Reviews 37 (2): 170–91. https://doi.org/10.1080/01441647.2016.1257660.\n\n\nvan Wee, Bert. 2022. “Accessibility and Equity: A Conceptual Framework and Research Agenda.” Journal of Transport Geography 104 (October): 103421. https://doi.org/10.1016/j.jtrangeo.2022.103421.\n\n\nVasconcellos, Eduardo Alcantara. 2018. “Urban Transport Policies in Brazil: The Creation of a Discriminatory Mobility System.” Journal of Transport Geography 67 (February): 85–91. https://doi.org/10.1016/j.jtrangeo.2017.08.014."
  },
  {
    "objectID": "2_indicadores.html",
    "href": "2_indicadores.html",
    "title": "2  Medidas de acessibilidade",
    "section": "",
    "text": "A mudança de paradigma no planejamento urbano e de transportes para a promoção da acessibilidade traz com si diversos desafios. Entre eles está a necessidade de criar métodos que busquem medir as condições de acessibilidade nas cidades. A busca por estimativas de acessibilidade facilmente comunicáveis, metodologicamente robustas e pouco intensivas computacionalmente levou ao desenvolvimento de um grande número de diferentes medidas (Páez, Scott, and Morency 2012). Essas medidas podem ser divididas em dois grandes grupos: medidas baseadas em lugares e medidas baseadas em pessoas (Dijst, de Jong, and van Eck 2002)."
  },
  {
    "objectID": "2_indicadores.html#medidas-baseadas-em-lugares",
    "href": "2_indicadores.html#medidas-baseadas-em-lugares",
    "title": "2  Medidas de acessibilidade",
    "section": "2.1 Medidas baseadas em lugares",
    "text": "2.1 Medidas baseadas em lugares\nMedidas baseadas em lugares medem a acessibilidade como uma característica de um determinado local. Por simplificação, esses indicadores assumem que todas as pessoas que se encontram em um mesmo local têm as mesmas condições de acesso às atividades distribuídas pela cidade. Ou seja, se uma análise de acessibilidade utiliza uma medida baseada em lugares para calcular a acessibilidade e divide a área de estudo em uma grade quadriculada, cada célula dessa grade (um quadrado) terá a ela associado um nível de acessibilidade, que é posteriormente atribuído a todas as pessoas que residem dentro daquela célula. Essas medidas são sensíveis a fatores relacionados à distribuição espacial de atividades e à configuração e desempenho da rede de transporte, mas não levam em consideração as características individuais das pessoas.\nAs medidas desse tipo são as mais amplamente utilizadas por agências de transporte e pesquisadores Papa et al. (2015). Isto porque elas exigem menor quantidade de dados e tendem a ser consideravelmente mais fáceis de serem calculadas e interpretadas do que suas contrapartes baseadas em pessoas. Por este motivo, os exemplos e estudos de caso apresentados neste nos próximos capítulos deste livro focam somente neste grupo de medidas.\nMedidas de acessibilidade baseadas em lugares associam a cada deslocamento um custo, usualmente expresso em termos de viagem (El-Geneidy et al. 2016; Venter 2016) - ou seja, se um local pode ser alcançado a partir de outro em meia hora, o custo para realizar essa viagem é de 30 minutos. Nada impede, no entanto, que outros tipos de custo, como a distância da viagem, seu custo monetário e a percepção de conforto dos usuários, por exemplo, sejam considerados (Arbex and Cunha 2020; Herszenhut et al. 2022). Nós apresentamos abaixo uma rápida descrição de algumas das medidas baseadas em lugares mais frequentemente utilizadas na literatura científica e na prática de agências de transporte. O termo “custo” é utilizado aqui de maneira ampla, e pode se referir a qualquer tipo de unidade quantitativa utilizada para quantificar a impedância de uma viagem, seja ela tempo de viagem, custo monetário ou demais alternativas.\n\n2.1.1 Custo mínimo de viagem\nUma das medidas de acessibilidade mais simples, a medida de custo mínimo de viagem indica qual é o menor custo necessário para alcançar a oportunidade mais próxima a partir de uma determinada origem. Ela permite captar, por exemplo, qual é o tempo de viagem até o posto de saúde mais próximo a partir de cada quarteirão de uma cidade. O indicador é calculado com a seguinte fórmula:\n\\[A_i = min(c_{i1}, c_{i2}, \\dots, c_{ij}, \\dots, c_{i(n-1)}, c_{in}) \\iff O_j \\geq 1\\]\nem que \\(A_i\\) é a acessibilidade na origem \\(i\\), \\(c_{ij}\\) é o custo de deslocamento entre a origem \\(i\\) e o destino \\(j\\), \\(n\\) é o número total de destinos na área de estudo e \\(O_j\\) é o número de oportunidades no destino \\(j\\).\nVantagens e desvantagens: Esta medida tem as vantagens de ser fácil de se calcular e exigir poucos dados, além de ser fácil de comunicar. Duas desvantagens, no entanto, são que ela não capta a quantidade de oportunidades acessíveis e nem aspectos de competição na demanda pela oportunidade. Por exemplo, uma pessoa pode morar muito perto de um hospital, mas essa proximidade pode não garantir um bom acesso aos serviços de saúde se esse for o único hospital da região e estiver sujeito a picos de demanda que sobrecarregam os serviços além de suas capacidades.\n\n\n2.1.2 Medida de oportunidades cumulativas\nA medida de oportunidades cumulativas mede a quantidade de oportunidades que pode ser alcançada dentro de um determinado limite de custo de viagem. Por exemplo, este indicador pode ser utilizado para medir a quantidade de empregos acessíveis por transporte público em até 60 minutos ou a quantidade de escolas acessíveis em até 30 minutos de viagem a pé. A medida é calculada com a seguinte fórmula:\n\\[A_i = \\sum_{j=1}^{n}{O_j \\times f(c_{ij})}\\]\n\\[\nf(c_{ij}) =\n  \\begin{cases}\n    1 & \\text{se } c_{ij} \\leq C\\\\\n    0 & \\text{caso contrário}\n  \\end{cases}\n\\]\nem que \\(A_i\\) é a acessibilidade na origem \\(i\\), \\(O_j\\) é o número de oportunidades no destino \\(j\\), \\(n\\) é o número total de destinos na área de estudo, \\(f(c_{ij})\\) é uma função binária que assume os valores 0 ou 1, a depender do custo de deslocamento \\(c_{ij}\\) entre a origem \\(i\\) e o destino \\(j\\), e \\(C\\) é o limite de custo de deslocamento estabelecido.\nVantagens e desvantagens: A medida de oportunidades cumulativas também é fácil de se calcular, exige poucos dados, e é fácil de comunicar. Isso contribui para que este indicador seja um dos mais utilizados por agências de transporte e de financiamento em análises de acessibilidade (Papa et al. 2015; Boisjoly and El-Geneidy 2017). Entre as suas desvantagens estão o fato de que este indicador não considera a influência da competição sobre oportunidades e exige a escolha de um único ponto de corte como custo máximo de viagem. Além disso, esta medida assume que todas as oportunidades são igualmente desejáveis e alcançáveis pelas pessoas, desde que os custos de viagem estejam dentro do limite pré-estabelecido - ou seja, uma oportunidade a 10 minutos de viagem é igualmente acessível a outra que esteja a 40 minutos de viagem, por exemplo, se o custo limite for de 60 minutos.\n\n\n2.1.3 Medidas gravitacionais\nMais do que um tipo de medida específica, podemos entender as medidas gravitacionais como uma família de medidas. Assim como no caso da medida de oportunidades cumulativas, esta família de métricas considera a soma das oportunidades que podem ser alcançadas a partir de um determinado local. A contagem de oportunidade, no entanto, é gradualmente descontada à medida que o custo da viagem aumenta. Assim, oportunidades mais fáceis de acessar têm uma importância maior, e o peso de cada oportunidade na soma total diminui com a sua dificuldade de acesso em relação à origem.\nO ritmo de decaimento desse peso em função do custo da viagem é ditado por uma função de impedância, que pode ser definida de diferentes formas. Por exemplo, a função de decaimento linear considera que o peso de cada oportunidade diminui de maneira constante ao longo do trajeto até um determinado custo limite, onde ele passa a ser zero. Já a função de decaimento exponencial negativa considera que o peso de cada oportunidade é dividido por um fator que cresce exponencialmente, fazendo com que ele diminua rapidamente a custos de viagem baixos e se aproxime de 0 a custos altos. As fórmulas abaixo apresentam a formulação genérica de uma medida gravitacional e as funções de decaimento linear e exponencial negativa, mencionadas acima.\n\\[A_i = \\sum_{j=1}^{n}{O_j \\times f(c_{ij})}\\]\n\\[\nf_{lin}(c_{ij}) =\n  \\begin{cases}\n    1-c_{ij}/C & \\text{se } c_{ij} \\leq C\\\\\n    0 & \\text{caso contrário}\n  \\end{cases}\n\\]\n\\[f_{exp}(c_{ij}) = e^{-\\beta c_{ij}}\\]\nem que \\(A_i\\) é a acessibilidade na origem \\(i\\), \\(O_j\\) é o número de oportunidades no destino \\(j\\), \\(n\\) é o número total de destinos na área de estudo, \\(f(c_{ij})\\) é uma função de decaimento cujo resultado varia com o custo de deslocamento \\(c_{ij}\\) entre a origem \\(i\\) e o destino \\(j\\), \\(f_{lin}(c_{ij})\\) é a função de decaimento linear, \\(C\\) é o limite de custo de deslocamento estabelecido, \\(f_{exp}(c_{ij})\\) é a função de decaimento exponencial negativa e \\(\\beta\\) é um parâmetro que dita a velocidade de decaimento.\nUm sem-número de diferentes funções de decaimento podem ser utilizadas no cálculo de medidas gravitacionais. A medida de oportunidades cumulativas, por exemplo, pode ser pensada simplesmente como um caso especial de medida gravitacional em que o peso de cada oportunidade é ditado por uma função binária, em vez de decair gradualmente. Levinson and King (2020, 49) apresentam uma lista de funções de decaimento utilizadas por agências de transportes e pesquisadores em análises que envolvem medidas gravitacionais.\nVantagens e desvantagens: A principal vantagem de medidas gravitacionais é que o desconto do peso das oportunidades pelo custo da viagem reflete, de alguma maneira, a forma como as pessoas costumam perceber o acesso a oportunidades: serviços e atividades costumam ser mais atrativas quanto mais próximos eles estiverem, tudo mais constante. Este indicador, no entanto, tem ao menos duas desvantagens. A primeira delas é que os níveis de acessibilidade estimados são de difícil interpretação, pela forma como a contagem de oportunidades é descontada pelo custo de viagem. Além disso, para que esses níveis sejam mais representativos do comportamento de viagem das pessoas, o ritmo de decaimento da função de impedância (o parâmetro \\(\\beta\\) da função exponencial negativa, por exemplo) precisa ser calibrado. Por isso, esta medida requer a disponibilidade de dados de comportamento de viagens ou outros dados que possam ser usados no processo de calibração, disponíveis, por exemplo, a partir de pesquisas tipo origem-destino, dados de telefone celular etc.\n\n\n2.1.4 Medidas de acessibilidade com competição: floating catchment area\nEm muitos casos, o acesso a oportunidades é afetado não apenas por questões de proximidade geográfica e de custos de transporte, mas também pela competição de diferentes pessoas por uma mesma oportunidade. Isso é muito comum, por exemplo, em casos de acesso a serviços de saúde, escolas e empregos. Uma vaga de emprego só pode ser ocupada por uma pessoa de cada vez, e o mesmo vale para um leito de UTI ou uma vaga em uma escola.\nExiste uma gama de medidas de acessibilidade que buscam incorporar essa competição pelas oportunidades na estimativa dos níveis de acessibilidade. Algumas das medidas de competição mais amplamente utilizadas são as do tipo floating catchment area (FCA, em tradução livre área de influência flutuante). A título de exemplo, esses indicadores tentam levar em consideração como uma mesma pessoa pode potencialmente acessar vários leitos de UTI e, simultaneamente, como cada leito de UTI pode ser acessado por diversas pessoas. Assim, o acesso de uma pessoa ao serviço de leito de UTI é influenciado simultaneamente tanto por questões de custos de transporte como também pela disponibilidade de leitos de UTI considerando a potencial concorrência na demanda por aqueles leitos.\nDentro da família de medidas de FCA, a mais comumente utilizada é a 2-Step Floating Catchment Area (2SFCA), proposta originalmente por Luo and Wang (2003). Uma limitação da 2SFCA é que ela contabiliza que uma mesma pessoa pode demandar várias oportunidades ao mesmo tempo e que, analogamente, um mesmo serviço pode ser utilizado por várias pessoas ao mesmo tempo. Esses fenômenos são conhecidos como problemas de inflação de demanda e de oferta, respectivamente, e podem gerar estimativas de acessibilidade enviesadas ou pouco precisas (Paez, Higgins, and Vivona 2019). Para lidar com esses problemas, Paez, Higgins, and Vivona (2019) propuseram a Balanced Floating Catchment Area (BFCA), uma das mais novas da família de medidas de FCA.\nVantagens e desvantagens: Diferentes medidas de FCA têm diferentes vantagens e desvantagens, em maior ou menor grau. No entanto, de maneira geral, a principal vantagem de medidas desta família é a sua capacidade de incorporar aspectos de competição em estimativas de acessibilidade. A principal desvantagem, por outro lado, é a difícil interpretação e comunicação dos seus resultados."
  },
  {
    "objectID": "2_indicadores.html#medidas-baseadas-em-pessoas",
    "href": "2_indicadores.html#medidas-baseadas-em-pessoas",
    "title": "2  Medidas de acessibilidade",
    "section": "2.2 Medidas baseadas em pessoas",
    "text": "2.2 Medidas baseadas em pessoas\nMedidas de acessibilidade baseadas em pessoas são sensíveis não apenas à distribuição espacial de atividades e à configuração e desempenho da rede de transporte. Indicadores desta categoria também levam em consideração como que características pessoais de cada indivíduo (como sexo, idade, deficiência física, etc.) e até questões como participação em atividades e compromissos pessoais podem afetar a facilidade de acesso de uma pessoa a determinadas atividades. Esta categoria inclui, por exemplo, medidas de acessibilidade baseadas em utilidade Miller (2018), indicadores baseadas em atividades (Dong et al. 2006) e medidas de espaço-tempo Neutens et al. (2012).\nVantagens e desvantagens: Embora indicadores desta categoria sejam mais sofisticados, eles costumam demandar grandes quantidades de dados, incluindo registros de diários de viagem, pesquisas domiciliares tipo origem-destino, etc. Por isso, o cálculo dessas medidas é computacionalmente mais intensivo e complexo, o que faz com que elas sejam menos utilizadas do que as medidas baseadas em lugares Miller (2018).\n\n\n\n\nArbex, Renato, and Claudio B. Cunha. 2020. “Estimating the Influence of Crowding and Travel Time Variability on Accessibility to Jobs in a Large Public Transport Network Using Smart Card Big Data.” Journal of Transport Geography 85 (May): 102671. https://doi.org/10.1016/j.jtrangeo.2020.102671.\n\n\nBoisjoly, Geneviève, and Ahmed M. El-Geneidy. 2017. “How to Get There? A Critical Assessment of Accessibility Objectives and Indicators in Metropolitan Transportation Plans.” Transport Policy 55 (April): 38–50. https://doi.org/10.1016/j.tranpol.2016.12.011.\n\n\nDijst, Martin, Tom de Jong, and Jan Ritsema van Eck. 2002. “Opportunities for Transport Mode Change: An Exploration of a Disaggregated Approach.” Environment and Planning B: Planning and Design 29 (3): 413–30. https://doi.org/10.1068/b12811.\n\n\nDong, Xiaojing, Moshe E. Ben-Akiva, John L. Bowman, and Joan L. Walker. 2006. “Moving from Trip-Based to Activity-Based Measures of Accessibility.” Transportation Research Part A: Policy and Practice 40 (2): 163–80. https://doi.org/10.1016/j.tra.2005.05.002.\n\n\nEl-Geneidy, Ahmed, David Levinson, Ehab Diab, Genevieve Boisjoly, David Verbich, and Charis Loong. 2016. “The Cost of Equity: Assessing Transit Accessibility and Social Disparity Using Total Travel Cost.” Transportation Research Part A: Policy and Practice 91 (September): 302–16. https://doi.org/10.1016/j.tra.2016.07.003.\n\n\nHerszenhut, Daniel, Rafael H. M. Pereira, Licinio da Silva Portugal, and Matheus Henrique de Sousa Oliveira. 2022. “The Impact of Transit Monetary Costs on Transport Inequality.” Journal of Transport Geography 99 (February): 103309. https://doi.org/10.1016/j.jtrangeo.2022.103309.\n\n\nKim, Hyun-Mi, and Mei-Po Kwan. 2003. “Space-Time Accessibility Measures: A Geocomputational Algorithm with a Focus on the Feasible Opportunity Set and Possible Activity Duration.” Journal of Geographical Systems 5 (1): 71–91. https://doi.org/10.1007/s101090300104.\n\n\nLevinson, David, and David King. 2020. Transport Access Manual: A Guide for Measuring Connection Between People and Places. Committee of the Transport Access Manual, University of Sydney.\n\n\nLuo, Wei, and Fahui Wang. 2003. “Measures of Spatial Accessibility to Health Care in a GIS Environment: Synthesis and a Case Study in the Chicago Region.” Environment and Planning B: Planning and Design 30 (6): 865–84. https://doi.org/10.1068/b29120.\n\n\nMiller, Eric J. 2018. “Accessibility: Measurement and Application in Transportation Planning.” Transport Reviews 38 (5): 551–55. https://doi.org/10.1080/01441647.2018.1492778.\n\n\nNassir, Neema, Mark Hickman, Ali Malekzadeh, and Elnaz Irannezhad. 2016. “A Utility-Based Travel Impedance Measure for Public Transit Network Accessibility.” Transportation Research Part A: Policy and Practice 88 (June): 26–39. https://doi.org/10.1016/j.tra.2016.03.007.\n\n\nNeutens, Tijs, Matthias Delafontaine, Darren M. Scott, and Philippe De Maeyer. 2012. “An Analysis of Day-to-Day Variations in Individual Spacetime Accessibility.” Journal of Transport Geography, Special Issue on Time Geography, 23 (July): 81–91. https://doi.org/10.1016/j.jtrangeo.2012.04.001.\n\n\nNeutens, Tijs, Tim Schwanen, Frank Witlox, and Philippe De Maeyer. 2010. “Equity of Urban Service Delivery: A Comparison of Different Accessibility Measures.” Environment and Planning A: Economy and Space 42 (7): 1613–35. https://doi.org/10.1068/a4230.\n\n\nPaez, Antonio, Christopher D. Higgins, and Salvatore F. Vivona. 2019. “Demand and Level of Service Inflation in Floating Catchment Area (FCA) Methods.” Edited by Tayyab Ikram Shah. PLOS ONE 14 (6): e0218773. https://doi.org/10.1371/journal.pone.0218773.\n\n\nPáez, Antonio, Darren M. Scott, and Catherine Morency. 2012. “Measuring Accessibility: Positive and Normative Implementations of Various Accessibility Indicators.” Journal of Transport Geography 25 (November): 141–53. https://doi.org/10.1016/j.jtrangeo.2012.03.016.\n\n\nPapa, Enrica, Cecilia Silva, Marco Te Brömmelstroet, and Angela Hull. 2015. “Accessibility Instruments for Planning Practice: A Review of European Experiences.” Journal of Transport and Land Use, June. https://doi.org/10.5198/jtlu.2015.585.\n\n\nVenter, Christoffel. 2016. “Assessing the Potential of Bus Rapid Transit-Led Network Restructuring for Enhancing Affordable Access to Employment The Case of Johannesburg’s Corridors of Freedom.” Research in Transportation Economics 59 (November): 441–49. https://doi.org/10.1016/j.retrec.2016.05.006."
  },
  {
    "objectID": "s2_calculo.html",
    "href": "s2_calculo.html",
    "title": "SEÇÃO 2: Calculando acessibilidade",
    "section": "",
    "text": "O cálculo dos níveis de acessibilidade em um determinado local compreende duas etapas principais: primeiro, nós precisamos calcular uma matriz de custo, geralmente o tempo de viagem, entre as origens e os destinos de uma determinada cidade ou região considerando um modo de transporte; feito isso, calculamos a acessibilidade em cada ponto de origem considerando os custos de transporte entre cada origem e o número de oportunidades em cada destino. Nesta seção nós aprenderemos mais sobre essas duas etapas usando R, quais dados são necessários para executá-las e quais as vantagens e desvantagens dos diferentes métodos que podem ser usados para isso."
  },
  {
    "objectID": "3_calculando_acesso.html",
    "href": "3_calculando_acesso.html",
    "title": "3  Calculando acessibilidade urbana em R",
    "section": "",
    "text": "A primeira etapa necessária para estimar os níveis de acessibilidade de uma área urbana é calcular a matriz de custo de viagem entre as diversas origens e destinos que a compõem. Como comentado anteriormente, na literatura científica e na prática do planejamento de sistemas de transporte esse custo é mais frequentemente representado pelo tempo de viagem que separa dois pontos (El-Geneidy et al. 2016; Venter 2016), embora trabalhos recentes tenham considerado também outros fatores, como o dinheiro necessário para realizar uma viagem e o nível de conforto da viagem entre um ponto e outro (Arbex and Cunha 2020; Herszenhut et al. 2022). Pela prevalência deste tipo de matriz na literatura e na prática, porém, iremos nos focar em matrizes de tempo de viagem.\nAtualmente, a forma mais fácil e rápida de gerar uma matriz de tempo de viagem em R é utilizando o pacote r5r (Rafael H. M. Pereira et al. 2021), desenvolvido pela equipe do Projeto Acesso a Oportunidades, do Ipea. O pacote utiliza, por trás dos panos, o software de roteamento de transporte multimodal R5, desenvolvido pela Conveyal1.\n\nA instalação do r5r funciona como a instalação de qualquer pacote de R (todos os exemplos de código a seguir devem ser rodados em uma sessão de R).\n\ninstall.packages(\"r5r\")\n\nAlém do R, o pacote r5r requer também a instalação do Java 112. Use o comando abaixo para checar a versão do Java instalada em seu computador.\n\ncat(processx::run(\"java\", args = \"-version\")$stderr)\n\nopenjdk version \"11.0.17\" 2022-10-18 LTS\nOpenJDK Runtime Environment Zulu11.60+19-CA (build 11.0.17+8-LTS)\nOpenJDK 64-Bit Server VM Zulu11.60+19-CA (build 11.0.17+8-LTS, mixed mode)\n\n\nComo podemos ver, a versão instalada no livro é compatível com o r5r. Caso a versão instalada na sua máquina não seja (resultado do código mencionando a versão 12 ou 1.8.0, por exemplo), por favor atualize o Java para a versão 11.\n\nO uso do pacote r5r requer diferentes tipos de dados. A lista abaixo descreve cada um deles, comenta sobre sua obrigatoriedade e apresenta algumas fontes onde esses dados podem ser obtidos:\n\n\nRede viária (obrigatório): um arquivo com a rede viária e de infraestrutura de pedestres do OpenStreetMap, em formato .pbf. Pode ser baixado com:\n\n\nosmextract, pacote de R;\n\nGeofabrik, website;\n\nHOT Export Tool, website;\n\nBBBike Extract Service, website.\n\n\n\n\n\n\n\n\n\nQualidade dos Dados OpenStreetMap\n\n\n\nO OpenStreetMap (OSM) é uma base de dados geográfica que traz informações sobre malha viária, prédios, parques, etc. Por ser uma base de dados alimentada voluntariamente pela comunidade, a cobertura e a qualidade dos dados do OSM podem variar muito entre regiões (Barrington-Leigh and Millard-Ball 2017). Via de regra, os dados do OSM no Brasil e no mundo tendem a ter melhor cobertura e qualidade em regiões mais desenvolvidas, em áreas urbanas e com maior população (Barrington-Leigh and Millard-Ball 2017; Camboim, Bravo, and Sluter 2015).\n\n\n\n\nRede de transporte público (opcional): um arquivo GTFS descrevendo a rede de transporte público da área de estudo. Caso ausente, deslocamentos por transporte público não podem ser roteados. Pode ser baixado com:\n\n\ntidytransit, pacote de R;\n\nTransitland, website;\nNo capítulo Chapter 4 deste livro (Tabela 4.9) nós indicamos também onde baixar os dados de GTFS de algumas cidades brasileiras que compartilham seus dados publicamente.\n\n\n\nTopografia (opcional): um arquivo de dados raster, com o modelo digital de elevação em formato .tif. Utilizado caso deseje-se levar em consideração os efeitos da topografia do local sobre os tempos de caminhada e de viagens de bicicleta. Pode ser baixado com:\n\n\nelevatr, pacote de R;\nNasa’s SRTMGL1, website.\n\n\n\nEsses dados devem ser salvos em uma mesma pasta que, preferencialmente, não contenha nenhum outro arquivo. Como veremos adiante, o r5r combina todos os dados salvos nesta pasta para criar uma rede de transporte multimodal que é utilizada para roteamento e cálculo das matrizes de tempo de viagem. Note que é possível ter mais de um arquivo GTFS na mesma pasta: nesse caso, o r5r considera as redes de transporte públicos de todos os feeds de forma conjunta. No entanto, a pasta deve conter um único arquivo de rede viária. Assumindo que os scripts de R estarão em uma pasta chamada R, uma possível organização dos arquivos segue o esquema abaixo:\n\n\n/tmp/Rtmpa4kvhO/projeto_acessibilidade\n├── R\n│   ├── script1.R\n│   └── script2.R\n└── r5\n    ├── rede_transporte_publico.zip\n    ├── rede_viaria.osm.pbf\n    └── topografia.tif\n\n\nPara ilustrar as funcionalidades do r5r, nós vamos usar uma pequena amostra de dados da cidade de Porto Alegre, Brasil. Esses dados estão disponíveis dentro do próprio pacote r5r, e seu endereço pode ser acessado com o comando system.file(\"extdata/poa\", package = \"r5r\"):\n\n\n/home/runner/work/intro_access_book/intro_access_book/renv/library/R-4.2/x86_64-pc-linux-gnu/r5r/extdata/poa\n├── poa.zip\n├── poa_elevation.tif\n├── poa_hexgrid.csv\n├── poa_osm.pbf\n└── poa_points_of_interest.csv\n\n\nEsta pasta possui quatro arquivos que vamos usar agora:\n\nA rede viária do OpenStreetMap: poa_osm.pbf;\nDois feeds de GTFS das redes de ônibus e de trens: poa_eptc.zip e poa_trensurb.zip;\nO modelo digital de elevação da cidade: poa_elevation.tif;\nO arquivo poa_hexgrid.csv, com as coordenadas geográficas dos centróides de uma grade hexagonal regular que cobre toda a área de estudo e com informações sobre o tamanho da população residente e o número de oportunidades (empregos, escolas e hospitais) em cada hexágono. Esses pontos serão utilizados como as origens e destinos no cálculo da matriz de tempo de viagem.\n\nAntes de calcular a matriz de tempo de viagem, precisamos aumentar a memória disponível para o Java. Isto é necessário porque, por padrão, o R aloca apenas 512MB de memória para processos do Java, o que frequentemente não é suficiente para o cálculo de grandes matrizes com o r5r. Para aumentar a memória disponível para 2GB, por exemplo, usamos o seguinte comando no início do script, antes mesmo de carregar as bibliotecas de R necessárias:\n\noptions(java.parameters = \"-Xmx2G\")\n\nFeito isso, agora podemos carregar as bibliotecas que vamos utilizar neste capítulo.\n\nlibrary(r5r)\nlibrary(accessibility)\nlibrary(sf)\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(aopdata)\n\nO cálculo de uma matriz de tempo de viagem de uma área de estudo é feito em dois passos. O primeiro é gerar a rede de transporte multimodal que será utilizada no roteamento. Para isso, nós utilizamos a função setup_r5(), que baixa o software de roteamento R5 e o utiliza para criar a rede. Esta função recebe como input o caminho da pasta onde os dados necessários para o roteamento estão armazenados. Como resultado, a função salva na pasta alguns arquivos necessários para o roteamento e retorna uma conexão com o R5, neste exemplo chamada de r5r_core, que é utilizada no cálculo da matriz de tempo de viagem.\n\npath <- system.file(\"extdata/poa\", package = \"r5r\")\n\nr5r_core <- setup_r5(path, use_elevation = TRUE, verbose = FALSE)\n\nfs::dir_tree(path)\n\n/home/runner/work/_temp/renv/cache/v5/R-4.2/x86_64-pc-linux-gnu/r5r/0.7.1/61db001154cd833466a25c4eb195c9b0/r5r/extdata/poa\n├── network.dat\n├── poa.zip\n├── poa_elevation.tif\n├── poa_hexgrid.csv\n├── poa_osm.pbf\n├── poa_osm.pbf.mapdb\n├── poa_osm.pbf.mapdb.p\n└── poa_points_of_interest.csv\n\n\nO passo final é usar a função travel_time_matrix() para o cálculo da matriz de tempo de viagem. Como inputs básicos, a função recebe a conexão com o R5 criada acima, pontos de origem e destino em formato de data.frame com as colunas id, lon e lat, o modo de transporte a ser utilizado e o horário de partida, o tempo máximo de caminhada permitido da origem até o embarque no transporte público e do desembarque até o destino, e o tempo máximo de viagem a ser considerado.\n\npoints <- fread(file.path(path, \"poa_hexgrid.csv\"))\n\nttm <- travel_time_matrix(\n  r5r_core,\n  origins = points,\n  destinations = points,\n  mode = c(\"WALK\", \"TRANSIT\"),\n  departure_datetime = as.POSIXct(\n    \"13-05-2019 14:00:00\",\n    format = \"%d-%m-%Y %H:%M:%S\"\n  ),\n  max_walk_dist = 800,\n  max_trip_duration = 120,\n  verbose = FALSE,\n  progress = FALSE\n)\n\nhead(ttm)\n\n            fromId            toId travel_time\n1: 89a901291abffff 89a901291abffff           1\n2: 89a901291abffff 89a901295b7ffff          41\n3: 89a901291abffff 89a9012809bffff          43\n4: 89a901291abffff 89a901285cfffff          35\n5: 89a901291abffff 89a90e934d7ffff          71\n6: 89a901291abffff 89a90129b47ffff          58\n\n\nNa prática, o que a função travel_time_matrix() faz é encontrar a rota mais rápida partindo de cada ponto de origem para todos os possíveis pontos de destino, considerando o modo de viagem, o horário de partida e os demais parâmetros passados pelo usuário. Para isso, o r5r considera tempos de viagem de porta-a-porta: no caso de uma viagem por transporte público, por exemplo, o tempo total de viagem inclui a) o tempo de caminhada até a parada de transporte público; b) o tempo de espera pelo veículo na parada; c) o tempo de deslocamento dentro do veículo; e d) o tempo de viagem a pé da parada de desembarque até o destino. Em casos em que mais de uma rota de transporte público é utilizada, o r5r também contabiliza o tempo gasto nas conexões, considerando a caminhada entre paradas e o tempo de espera pelo próximo veículo.\nDiversos outros inputs podem ser passados para o cálculo da matriz, como a velocidade de caminhada e o número máximo de pernas de transporte público permitido, entre outros. Para mais informações sobre cada um dos parâmetros, por favor consulte a documentação da função disponível no pacote em uma sessão de R (com os comandos ?travel_time_matrix() e help(“travel_time_matrix”)) ou no site do r5r, aqui.\n\n\n\n\n\n\nA função travel_time_matrix() utiliza uma extensão do algoritmo de roteamento RAPTOR (Conway, Byrd, and van der Linden 2017), o que torna o R5 extremamente rápido. A depender da quantidade de pares de origem-destino, o r5r pode ser entre 6 e 200 vezes mais rápido do que outros softwares de roteamento multimodal no cálculo de uma matriz de tempo de viagem (Higgins et al. 2022)."
  },
  {
    "objectID": "3_calculando_acesso.html#sec-accessibility",
    "href": "3_calculando_acesso.html#sec-accessibility",
    "title": "3  Calculando acessibilidade urbana em R",
    "section": "\n3.2 Cálculo de acessibilidade",
    "text": "3.2 Cálculo de acessibilidade\nApós calculada a matriz de tempo de viagem entre as origens e os destinos da área de estudo, nós precisamos utilizá-la para calcular os níveis de acessibilidade do local. Para isso, nós utilizaremos o pacote accessibility3, também desenvolvido pela equipe do Projeto Acesso a Oportunidades, Ipea, que contém diversas funções para o cálculo de vários indicadores de acessibilidade. Como input básico, todas as funções requerem uma matriz de custo pré-calculada (no nosso caso, a matriz de tempo de viagem calculada na seção anterior) e dados de uso do solo, como, por exemplo, o número de determinados tipos de oportunidades em cada célula da grade que cobre a área de estudo.\nMedida de oportunidades cumulativas\nA função cumulative_cutoff() é utilizada para calcular o número de oportunidades que pode ser alcançado em um determinado limite de custo de viagem. No exemplo abaixo, nós calculamos o número de escolas que podem ser alcançados em até 30 minutos de viagem a partir de cada origem presente em nossa matriz de tempo de viagem.\n\n# renomear nome das colunas\nsetnames(ttm, c(\"fromId\", \"toId\"), c(\"from_id\", \"to_id\"))\n\ncumulative_access <- cumulative_cutoff(\n  travel_matrix = ttm,\n  land_use_data = points,\n  opportunity = \"schools\",\n  travel_cost = \"travel_time\",\n  cutoff = 30\n)\n\nhead(cumulative_access)\n\n                id schools\n1: 89a901291abffff      19\n2: 89a9012a3cfffff       0\n3: 89a901295b7ffff      15\n4: 89a901284a3ffff       0\n5: 89a9012809bffff      20\n6: 89a901285cfffff      82\n\n\nCusto mínimo de viagem\nA função cost_to_closest(), por sua vez, calcula o custo mínimo de viagem necessário para alcançar um determinado número de oportunidades. O código abaixo, por exemplo, calcula o tempo de viagem mínimo para alcançar o hospital mais próximo a partir de cada origem.\n\nmin_cost <- cost_to_closest(\n  travel_matrix = ttm,\n  land_use_data = points,\n  opportunity = \"schools\",\n  travel_cost = \"travel_time\"\n)\n\nhead(min_cost)\n\n                id travel_time\n1: 89a9012124fffff           0\n2: 89a9012126bffff          16\n3: 89a9012127bffff          11\n4: 89a90128003ffff           7\n5: 89a90128007ffff          20\n6: 89a9012800bffff           0\n\n\nMedidas gravitacionais\nA função gravity() calcula medidas gravitacionais de acessibilidade - ou seja, aquelas nas quais o peso de cada oportunidade diminui gradualmente com o aumento do custo de viagem. Existem, no entanto, uma gama de diferentes tipos de funções de decaimento que podem ser utilizadas, como funções de decaimento exponenciais negativas, de potências inversas, entre outras. Por isso, esta função recebe um input adicional: a função de decaimento a ser utilizada no cálculo. O exemplo abaixo apresenta o cálculo de acessibilidade a estabelecimentos de educação usando uma medida gravitacional exponencial negativa com parâmetro de decaimento igual a 0.2.\n\nnegative_exp_access <- gravity(\n  travel_matrix  = ttm,\n  land_use_data = points,\n  opportunity = \"schools\",\n  travel_cost = \"travel_time\",\n  decay_function = decay_exponential(0.2)\n)\n\nhead(negative_exp_access)\n\n                id   schools\n1: 89a901291abffff 0.3589287\n2: 89a9012a3cfffff 0.0000000\n3: 89a901295b7ffff 0.5206127\n4: 89a901284a3ffff 0.0000000\n5: 89a9012809bffff 0.4476908\n6: 89a901285cfffff 1.9573827\n\n\nMedidas com competição\nPor fim, a função floating_catchment_area() calcula níveis de acessibilidade levando em consideração a competição por oportunidades usando diferentes indicadores do tipo floating catchment area. Como diversos métodos de FCA podem ser utilizados, a função requer que o método desejado seja explicitamente assinalado. E, assim como a função de acessibilidade gravitacional, a função de decaimento utilizada também deve ser definida pelo usuário. O código a seguir mostra um exemplo de cálculo de acessibilidade a oportunidades de emprego usando o método BFCA (Paez, Higgins, and Vivona 2019), levando em consideração os efeitos de competição entre a população como um todo e uma função de decaimento exponencial com parâmetro de decaimento igual a 0.05.\n\nbfca_access <- floating_catchment_area(\n  travel_matrix = ttm,\n  land_use_data = points,\n  opportunity = \"schools\",\n  travel_cost = \"travel_time\",\n  demand = \"population\",\n  method = \"bfca\",\n  decay_function = decay_exponential(0.05)\n)\n\nhead(bfca_access)\n\n                id      schools\n1: 89a901291abffff 0.0002574442\n2: 89a9012a3cfffff 0.0000000000\n3: 89a901295b7ffff 0.0002091911\n4: 89a901284a3ffff 0.0000000000\n5: 89a9012809bffff 0.0002276971\n6: 89a901285cfffff 0.0003928648\n\n\nAs funções apresentadas nesta seção também podem receber outros inputs não explicitamente mencionados aqui. Para mais informações sobre cada um dos parâmetros, por favor consulte a documentação do pacote accessibility em seu site."
  },
  {
    "objectID": "3_calculando_acesso.html#cálculo-de-acessibilidade-com-o-r5r",
    "href": "3_calculando_acesso.html#cálculo-de-acessibilidade-com-o-r5r",
    "title": "3  Calculando acessibilidade urbana em R",
    "section": "\n3.3 Cálculo de acessibilidade com o r5r",
    "text": "3.3 Cálculo de acessibilidade com o r5r\nAo longo das duas seções anteriores, nós mostramos como calcular níveis de acessibilidade passo-a-passo. Para fins didáticos, é importante entender que o cálculo de estimativas de acessibilidade tem como primeiro passo a geração de uma matriz de custos de viagens que posteriormente é utilizada para estimar níveis de acessibilidade. No entanto, o r5r inclui também uma função chamada accessibility() que faz todo esse processamento de uma vez só.\nDe forma parecida com a função de cálculo de matriz de tempo de viagem, a função accessibility() recebe como inputs uma conexão com o R5, as origens, os destinos, os modos de transporte e o tempo de partida, entre outros argumentos. Adicionalmente, devem ser listadas também quais oportunidades devem ser consideradas e a função de decaimento que deve ser utilizada, bem como o valor do limite de custo e do parâmetro de decaimento. O exemplo abaixo mostra uma aplicação desta função.\n\nr5r_access <- accessibility(\n  r5r_core,\n  origins = points,\n  destinations = points,\n  opportunities_colname = \"schools\",\n  decay_function = \"step\",\n  cutoffs = 30,\n  mode = c(\"WALK\", \"TRANSIT\"),\n  departure_datetime = as.POSIXct(\n    \"13-05-2019 14:00:00\",\n    format = \"%d-%m-%Y %H:%M:%S\"\n  ),\n  max_walk_dist = 800,\n  max_trip_duration = 120,\n  verbose = FALSE,\n  progress = FALSE\n)\n\nhead(r5r_access)\n\n           from_id percentile cutoff accessibility\n1: 89a901291abffff         50     30            17\n2: 89a9012a3cfffff         50     30             0\n3: 89a901295b7ffff         50     30            13\n4: 89a901284a3ffff         50     30             0\n5: 89a9012809bffff         50     30            17\n6: 89a901285cfffff         50     30            78\n\n\nComo podemos observar, o resultado desta função são os mesmos níveis de acessibilidade já calculados anteriormente, no exemplo da medida de oportunidades cumulativas. A informação “intermediária” do tempo de viagem entre origens e destinos, consequentemente, não fica disponível ao usuário com o uso desta função. Ainda assim, este fluxo de trabalho pode ser uma boa alternativa para pessoas que estejam interessadas unicamente nos níveis de acessibilidade, não dependendo do tempo de viagem em suas análises."
  },
  {
    "objectID": "3_calculando_acesso.html#análises-de-acessibilidade",
    "href": "3_calculando_acesso.html#análises-de-acessibilidade",
    "title": "3  Calculando acessibilidade urbana em R",
    "section": "\n3.4 Análises de acessibilidade",
    "text": "3.4 Análises de acessibilidade\nCalculados os níveis de acessibilidade, procedemos então para sua análise. Existe uma grande variedade de análises que podem ser feitas usando esses dados: por exemplo, em diagnósticos das condições de acessibilidade urbana de diferentes bairros, pesquisas sobre desigualdades de acesso a oportunidades entre diferentes grupos sociais, análises sobre exclusão social e accessibility poverty (insuficiência de acessibilidade, em tradução livre), etc. Nesta seção, no entanto, nos restringiremos a apresentar duas análises relativamente simples e de fácil comunicação: a distribuição espacial da acessibilidade e sua distribuição entre diferentes grupos de renda.\nDistribuição espacial de acessibilidade urbana\nPara compreendermos a distribuição espacial da acessibilidade urbana de uma determinada cidade ou região, primeiro precisamos obter as informações espaciais dos pontos que foram utilizados como origens e destinos no cálculo da matriz. Os pontos que nós usamos nos exemplos anteriores, por exemplo, correspondem a células de uma grade hexagonal baseadas no índice H3, desenvolvido pela Uber (Brodsky 2018). O código e o mapa a seguir mostram a distribuição desses hexágonos na nossa área de estudo. Aqui, a gente faz o download da grade espacial disponível no pacote aopdata, que será apresentado com mais detalhes na seção ?sec-s5_dados_aop;\n\n# download grade espacial\npoa_grid <- aopdata::read_grid(city=\"Porto Alegre\")\n\npoa_grid <- poa_grid[poa_grid$id_hex %in% points$id, ]\n\n# cria mapa\nggplot(poa_grid) + geom_sf()\n\n\n\n\nPara visualizarmos os nossos dados de acessibilidade espacialmente, portanto, nós precisamos unir a nossa tabela de estimativas de acessibilidade (vamos usar os níveis calculados com a medida de oportunidades cumulativas) com a tabela que contém os dados espaciais da grade, usando as colunas de identificação dos hexágonos como colunas-chave. A operação de left join usada para isso, bem como o seu resultado em formato de imagem, são apresentados a seguir.\n\n# converte objeto para data.table\nsetDT(poa_grid)\n\n# merge para trazer info do número de escolas\npoa_grid[cumulative_access, on = c(id_hex = \"id\"), schools_access := i.schools]\n\n# converte de volta para objeto espacial sf\npoa_grid <- st_sf(poa_grid)\n\n# plotar mapa\nggplot(poa_grid) +\n  geom_sf(aes(fill = schools_access), color = NA) +\n  scale_fill_viridis_c(option = \"inferno\") + \n  labs(fill='Núm. de escolas\\nacessíveis') +\n  theme_minimal()\n\n\n\n\nComo podemos ver, os níveis de acessibilidade tendem a se concentrar de forma mais acentuada no centro da cidade, onde existe maior concentração de empregos, e próximos aos grandes corredores de transportes da cidade. Por terem fácil acesso a modos de alta capacidade e velocidade, pessoas que moram mais perto desses corredores tendem a acessar locais distantes relativamente rápido. Em contraste, pessoas que moram mais longe desses corredores, dependem de modos de menor menor frequência e velocidade operacional (como os ônibus municipais, por exemplo) e precisam gastar mais tempo para alcançar os corredores de média e alta capacidade. Como consequência, os níveis de acessibilidade de pessoas que moram afastadas do centro e de corredores de alta capacidade tendem a ser menores.\nDistribuição socioeconômica de acessibilidade urbana\nO mapa acima, embora revelador quanto aos locais em que estão dispostas as maiores concentrações de acessibilidade, nada diz sobre quais são os grupos socioeconômicos que possuem os maiores potenciais de acesso a oportunidades na região. Para isso, nós precisamos cruzar informações demográficas e econômicas das pessoas que moram em cada um dos nossos pontos de origem com os dados de acessibilidade previamente calculados.\nNo exemplo abaixo, nós juntamos aos dados de acessibilidade a informação do decil de renda de cada uma das origens, considerando a renda média de cada uma das pessoas que as habitam. Assim, nós conseguimos identificar se um hexágono é de baixa, média ou alta renda. Os dados socioeconômicos que utilizamos no exemplo vêm do censo demográfico brasileiro de 2010, e foram agregados na grade espacial de hexágonos por (pereira2022usosolo?). Aqui, nós acessamos os dados no R usando o pacote aopdata, que será apresentado em mais detalhes na seção ?sec-s5_dados_aop.\n\npoa_population <- aopdata::read_population(\"Porto Alegre\", showProgress = FALSE)\n\nsetDT(poa_grid)\npoa_grid[\n  poa_population,\n  on = \"id_hex\",\n  `:=`(\n    pop_count = i.P001,\n    income_decile = i.R003\n  )\n]\n\npoa_grid[, .(id_hex, schools_access, pop_count, income_decile)] |> head()\n\n            id_hex schools_access pop_count income_decile\n1: 89a9012124fffff             14       733             9\n2: 89a9012126bffff             13       355             9\n3: 89a9012127bffff             14       996            10\n4: 89a90128003ffff             34      1742             4\n5: 89a90128007ffff             15       477             5\n6: 89a9012800bffff             34       501             4\n\n\nTendo a informação do decil de renda em que cada hexágono se encontra, nós podemos calcular a distribuição da acessibilidade da população dentro de cada um desses níveis de renda. Para isso, nós precisamos ponderar o nível de acessibilidade de cada origem pela quantidade de pessoas que residem ali - daí o porquê de termos também trazido a informação da contagem populacional em cada hexágono. Fazendo a ponderação, nós obtemos a distribuição da acessibilidade das pessoas localizadas em origens de um determinado decil de renda. Caso não ponderássemos, no entanto, nós teríamos a distribuição de acessibilidade não das pessoas localizadas em cada hexágono, mas dos hexágonos em si. Como em nossa análise nós nos importamos com as pessoas, e não com as unidades espaciais em que elas estão agregadas, precisamos fazer a ponderação. Nós podemos visualizar a distribuição de acessibilidade de cada decil usando um boxplot, como feito a seguir.\n\nggplot(poa_grid[!is.na(income_decile)]) +\n  geom_boxplot(\n    aes(\n    x = as.factor(income_decile),\n    y = schools_access,\n    color = as.factor(income_decile),\n    weight = pop_count\n    )\n  ) +\n  labs(color=\"Decil de\\nrenda\", x=\"Decil de Renda\", y=\"Número de escolas\\nacessíveis\") +\n  scale_color_brewer(palette = 'RdBu') +\n  scale_x_discrete(labels=c(\"D1 mais\\nPobres\", paste0('D', 2:9), \"D10 mais\\nRicos\")) +\n  theme_minimal()\n\n\n\n\nO gráfico é muito claro em seu conteúdo: pessoas de mais baixa renda tendem a ter níveis de acessibilidade consideravelmente menores do que as de alta renda. Isso é um padrão comum em praticamente todas as cidades brasileiras (R. H. M. Pereira et al. 2019). Isto ocorre, em larga medida, devido à localização espacial das comunidades de baixa e alta renda no território: os mais ricos costumam morar em áreas mais valorizadas, próximas das grandes concentração de empregos (e oportunidades de educação, saúde, lazer, etc., também) e com maior oferta de transporte público de média e alta capacidade. Os mais pobres, por sua vez, tendem a morar em locais mais afastados, onde o valor da terra é menor. Consequentemente, tendem também a se afastar das grandes concentrações de oportunidades. Junta-se a isso o fato de, na maior parte dos casos, a oferta de serviços de transporte público de média e alta capacidade ser pior em locais com maior concentração de pessoas de baixa renda. Como consequência, seus níveis de acessibilidade são, em média, muito menores do que os dos mais ricos, como o gráfico deixa claro.\n\n\n\n\nArbex, Renato, and Claudio B. Cunha. 2020. “Estimating the Influence of Crowding and Travel Time Variability on Accessibility to Jobs in a Large Public Transport Network Using Smart Card Big Data.” Journal of Transport Geography 85 (May): 102671. https://doi.org/10.1016/j.jtrangeo.2020.102671.\n\n\nBarrington-Leigh, Christopher, and Adam Millard-Ball. 2017. “The World’s User-Generated Road Map Is More Than 80% Complete.” PLOS ONE 12 (8): e0180698. https://doi.org/10.1371/journal.pone.0180698.\n\n\nBrodsky, Isaac. 2018. “H3: Uber’s Hexagonal Hierarchical Spatial Index.” Uber Engineering Blog. https://eng.uber.com/h3/.\n\n\nCamboim, Silvana Philippi, João Vitor Meza Bravo, and Claudia Robbi Sluter. 2015. “An Investigation into the Completeness of, and the Updates to, OpenStreetMap Data in a Heterogeneous Area in Brazil.” ISPRS International Journal of Geo-Information 4 (3): 1366–88. https://doi.org/10.3390/ijgi4031366.\n\n\nConway, Matthew Wigginton, Andrew Byrd, and Marco van der Linden. 2017. “Evidence-Based Transit and Land Use Sketch Planning Using Interactive Accessibility Methods on Combined Schedule and Headway-Based Networks.” Transportation Research Record: Journal of the Transportation Research Board 2653 (1): 45–53. https://doi.org/10.3141/2653-06.\n\n\nEl-Geneidy, Ahmed, David Levinson, Ehab Diab, Genevieve Boisjoly, David Verbich, and Charis Loong. 2016. “The Cost of Equity: Assessing Transit Accessibility and Social Disparity Using Total Travel Cost.” Transportation Research Part A: Policy and Practice 91 (September): 302–16. https://doi.org/10.1016/j.tra.2016.07.003.\n\n\nHerszenhut, Daniel, Rafael H. M. Pereira, Licinio da Silva Portugal, and Matheus Henrique de Sousa Oliveira. 2022. “The Impact of Transit Monetary Costs on Transport Inequality.” Journal of Transport Geography 99 (February): 103309. https://doi.org/10.1016/j.jtrangeo.2022.103309.\n\n\nHiggins, Christopher, Matthew Palm, Amber DeJohn, Luna Xi, James Vaughan, Steven Farber, Michael Widener, and Eric Miller. 2022. “Calculating Place-Based Transit Accessibility: Methods, Tools and Algorithmic Dependence.” Journal of Transport and Land Use 15 (1). https://doi.org/10.5198/jtlu.2022.2012.\n\n\nPaez, Antonio, Christopher D. Higgins, and Salvatore F. Vivona. 2019. “Demand and Level of Service Inflation in Floating Catchment Area (FCA) Methods.” Edited by Tayyab Ikram Shah. PLOS ONE 14 (6): e0218773. https://doi.org/10.1371/journal.pone.0218773.\n\n\nPereira, R. H. M., Carlos Kaue Vieira Braga, Bernardo Serra, and Vanessa Nadalin. 2019. “Desigualdades socioespaciais de acesso a oportunidades nas cidades brasileiras, 2019.” {Texto para Discuss\\~ao} 2535. Instituto de Pesquisa Econômica Aplicada (Ipea).\n\n\nPereira, Rafael H. M., Marcus Saraiva, Daniel Herszenhut, Carlos Kaue Vieira Braga, and Matthew Wigginton Conway. 2021. “R5r: Rapid Realistic Routing on Multimodal Transport Networks with R5 in R.” Transport Findings, March, 21262. https://doi.org/10.32866/001c.21262.\n\n\nVenter, Christoffel. 2016. “Assessing the Potential of Bus Rapid Transit-Led Network Restructuring for Enhancing Affordable Access to Employment The Case of Johannesburg’s Corridors of Freedom.” Research in Transportation Economics 59 (November): 441–49. https://doi.org/10.1016/j.retrec.2016.05.006."
  },
  {
    "objectID": "s3_dados_tp.html",
    "href": "s3_dados_tp.html",
    "title": "SEÇÃO 3: Dados de transporte público",
    "section": "",
    "text": "Dados de transporte público são peças fundamentais no planejamento de transportes em geral, e em análises de acessibilidade em particular. Para serem usados de forma que se tenha segurança no resultado das análises, esses dados precisam ser confiáveis e de simples inspeção e interpretação.\nTentando satisfazer esses critérios, cada vez mais agências de transporte público, tomadores de decisão e pesquisadores têm buscado utilizar dados estruturados conforme especificações abertas e colaborativas - ou seja, cujo formato seja decidido por uma comunidade de atores interessados, incluindo partes que produzem esses dados (agências de transporte público, por exemplo) e que os consomem (pesquisadores, desenvolvedores de ferramentas de planejamento, etc). Embora uma especificação aberta não necessariamente resolva o problema da qualidade e da confiabilidade dos dados por ela descritos, ela traz várias vantagens que promovem o compartilhamento de conhecimento e a transparência de análises e aplicações que dependem dessa especificação - fatores que, por sua vez, podem levar a substanciais ganhos de qualidade e confiança nos dados.\nO uso de um formato padrão de dados para transporte público permite o desenvolvimento e compartilhamento de ferramentas e programas computacionais para análise desses dados, o que cria um campo comum de compartilhamento e aprendizado entre agências de transporte de diferentes cidades e países. Assim, um programa desenvolvido por agências de transporte para uma cidade no Brasil, Estados Unidos ou Japão pode ser facilmente utilizado para quaisquer outras cidades do mundo que também organizam seus dados no mesmo formato. Além disso, quanto mais amplamente utilizado é esse formato padrão de dados, maior tende a ser tanto a confiabilidade na especificação em si quanto a facilidade de inspeção e interpretação dos seus dados, visto que múltiplos atores detêm o conhecimento necessário para isso.\nA especificação de dados aberta e colaborativa mais amplamente utilizada no contexto do planejamento de transporte público é o formato GTFS, sigla para General Transit Feed Specification (Especificação Geral de Redes de Transporte Público, em tradução livre). Seus usos abrangem tanto o planejamento quanto a operação de sistemas de transporte público. Como visto no Chapter 3, os dados de GTFS também são uma peça fundamental para calcular estimativas de acessibilidade urbana por transporte público. Nesta seção nós iremos aprender em mais detalhes o que são os dados GTFS, como eles são estruturados e como trabalhar com esses dados no R."
  },
  {
    "objectID": "4_dados_gtfs.html",
    "href": "4_dados_gtfs.html",
    "title": "4  Dados GTFS",
    "section": "",
    "text": "O formato GTFS é uma especificação aberta e colaborativa que visa descrever os principais componentes de uma rede de transporte público. O formato padrão GTFS foi originalmente criado em meados dos anos 2000 por uma parceria entre Google e TriMet, a agência de transporte de Portland, Oregon, nos Estados Unidos (McHugh 2013). Atualmente, dados GTFS podem ser divididos em duas grandes categorias:\nAo longo desta seção, nós focaremos no GTFS Schedule, por ser o formato de GTFS mais amplamente utilizado por agências de transporte e em análises de acessibilidade. Clique aqui para mais informações sobre o GTFS Realtime.\nPor ser uma especificação aberta e colaborativa, o formato GTFS tenta abarcar em sua definição um grande número de usos distintos que agências de transporte e desenvolvedores de ferramentas possam dar a ele. No entanto, agências e softwares podem ainda assim depender de informações que não constem na especificação oficial. Surgem, dessa forma, extensões da especificação. Algumas dessas extensões podem eventualmente se tornar parte da especificação oficial, caso isto seja aceito pela comunidade de usuários do GTFS. Nesta seção, nós focaremos em um subconjunto de informações presentes no formato GTFS Schedule “puro”, e, portanto, não cobriremos suas extensões."
  },
  {
    "objectID": "4_dados_gtfs.html#estrutura-de-arquivos-gtfs",
    "href": "4_dados_gtfs.html#estrutura-de-arquivos-gtfs",
    "title": "4  Dados GTFS",
    "section": "\n4.1 Estrutura de arquivos GTFS",
    "text": "4.1 Estrutura de arquivos GTFS\nUsualmente, refere-se a um arquivo no formato GTFS Schedule (daqui em diante chamado apenas de GTFS) como feed. Neste livro, nós utilizaremos os termos feed e arquivo GTFS como sinônimos.\nUm feed é nada mais do que um arquivo comprimido em formato .zip que contém um conjunto de tabelas, salvas em formato .txt, com algumas informações sobre a rede de transporte público (e.g. localização das paradas, frequências das viagens, traçado das rotas, entre outras). Como em uma base de dados relacional, as tabelas de um feed têm algumas colunas-chaves que permitem vincular os dados de rotas, viagens e tabelas de horários entre si. O esquema geral do GTFS é apresentado na Figura 4.1, que mostra algumas das principais tabelas que compõem a especificação e destaca como algumas delas se relacionam a partir de suas colunas-chaves.\n\n\n\n\nFigura 4.1: Esquema do formato GTFS. Fonte - Pereira, Andrade, and Vieira (2022)\n\n\n\n\nAo todo, 22 tabelas compõem o formato GTFS1. Nem todas, no entanto, devem estar obrigatoriamente presentes para que um feed seja considerado válido - sendo consideradas, portanto, opcionais. A especificação classifica cada tabela conforme sua obrigatoriedade em três possíveis categorias: obrigatórias, opcionais e condicionalmente obrigatórias (quando a obrigatoriedade de uma tabela depende da existência de uma determinada tabela, coluna ou valor). Para fins de simplicidade, neste livro nós consideraremos apenas as duas primeiras categorias e faremos comentários quanto à obrigatoriedade de cada tabela quando apropriado. Desta forma, ficam assim classificadas as tabelas:\n\n\nObrigatórias: agency.txt, stops.txt, routes.txt, trips.txt, stop_times.txt, calendar.txt.\n\nOpcionais: calendar_dates.txt, fare_attributes.txt, fare_rules.txt, fare_products.txt, fare_leg_rules.txt, fare_transfer_rules.txt, areas.txt, stop_areas.txt, shapes.txt, frequencies.txt, transfers.txt, pathways.txt, levels.txt, translations.txt, feed_info.txt, attributions.txt.\n\nAo longo desta seção, nós aprenderemos a estrutura básica de um arquivo GTFS e das tabelas que o compõem. Portanto, vamos olhar apenas para as tabelas obrigatórias e para as tabelas opcionais mais frequentemente utilizadas por produtores e consumidores desses arquivos. Para mais informações sobre as tabelas e as colunas não abordadas nesta seção, por favor verifique a especificação oficial.\nNesta demonstração, nós utilizaremos um subconjunto de dados provenientes do feed da cidade de São Paulo criado pela SPTrans2 e baixado em outubro de 2019. O feed contém as seis tabelas obrigatórias e mais duas tabelas opcionais bastante utilizadas, shapes.txt e frequencies.txt, o que permite uma boa visão geral sobre o formato GTFS.\n\n\n\n\n4.1.1 agency.txt\nArquivo utilizado para descrever as operadoras de transporte que atuam no sistema descrito pelo arquivo GTFS. Embora o termo agency (agência) seja usado em lugar de operators (operadoras), por exemplo, fica a cargo do produtor do feed definir quais instituições serão listadas na tabela.\nPor exemplo: múltiplas concessionárias de ônibus atuam em um determinado local, mas todo o planejamento de cronograma e de tarifa é realizado por uma instituição, em geral uma secretaria de transporte ou empresa pública específica. Esta instituição é também entendida pelos usuários do sistema como a operadora, de fato. Neste caso, devemos listar a instituição responsável pelo planejamento na tabela.\nAgora, imagine um sistema em que a agência de transporte público local transfere a responsabilidade da operação de um sistema multimodal a diversas empresas, por meio de concessões. Cada uma dessas empresas é responsável pelo planejamento de cronogramas e tarifas dos modos que operam, desde que sejam seguidos determinados parâmetros pré-estabelecidos em contrato. Neste caso, deve-se listar as operadoras (concessionárias) na tabela, e não a agência de transporte público em si.\nA Tabela 4.1 mostra o arquivo agency.txt do feed da SPTrans. Como vocês podem ver, os responsáveis pelo feed optaram por listar a própria empresa no arquivo, e não as concessionárias que operam os ônibus e o metrô da cidade.\n\n\n\n\nTabela 4.1: Exemplo de arquivo agency.txt\n\n\n\n\n\n\n\n\n\nagency_id\nagency_name\nagency_url\nagency_timezone\nagency_lang\n\n\n1\nSPTRANS\nhttp://www.sptrans.com.br/?versao=011019\nAmerica/Sao_Paulo\npt\n\n\n\n\n\nÉ necessário notar que, embora estejamos apresentando o agency.txt em formato de tabela, o arquivo deve ser formatado como se fosse salvo em formato .csv. Ou seja, os valores de cada célula da tabela devem ser separados por vírgulas, e cada linha da tabela deve constar em uma linha no arquivo. A tabela acima, por exemplo, é definida da seguinte forma:\n\n\nagency_id,agency_name,agency_url,agency_timezone,agency_lang\n1,SPTRANS,http://www.sptrans.com.br/?versao=011019,America/Sao_Paulo,pt \n\n\nPor uma questão de comunicação e interpretação dos dados, ao longo desta seção sempre apresentaremos os exemplos em formato de tabela. É importante ter em mente, porém, que essas tabelas são internamente organizadas no GTFS como mostrado acima.\n\n4.1.2 stops.txt\nArquivo usado para descrever as paradas de transporte público que compõem o sistema. Os pontos listados neste arquivo podem fazer menção a paradas mais simples (como pontos de ônibus), estações, plataformas, entradas e saídas de estações, etc. A Tabela 4.2 mostra o stops.txt do feed da SPTrans.\n\n\n\n\nTabela 4.2: Exemplo de arquivo stops.txt\n\n\n\n\n\n\n\n\n\nstop_id\nstop_name\nstop_desc\nstop_lat\nstop_lon\n\n\n\n706325\nParada 14 Bis B/C\nViad. Dr. Plínio De Queiroz, 901\n-23.55593\n-46.65011\n\n\n810602\nR. Sta. Rita, 56\nRef.: R. Bresser / R. João Boemer\n-23.53337\n-46.61229\n\n\n910776\nAv. Do Estado, 5854\nRef.: Rua Dona Ana Néri\n-23.55896\n-46.61520\n\n\n1010092\nParada Caetano Pinto\nAv. Rangel Pestana, 1249 Ref.: Rua Caetano Pinto/rua Prof. Batista De Andrade\n-23.54615\n-46.62218\n\n\n1010093\nParada Piratininga\nAv. Rangel Pestana, 1479 Ref.: Rua Monsenhor Andrade\n-23.54509\n-46.62006\n\n\n1010099\nR. Xavantes, 612\nRef.: Rua Joli\n-23.53545\n-46.61368\n\n\n\n\n\n\nAs colunas stop_id e stop_name servem como identificadores de cada parada, porém cumprem papéis distintos. O principal propósito da stop_id é identificar relações entre esta tabela e outras que compõem a especificação (como veremos mais à frente no arquivo stop_times.txt, por exemplo). Já a coluna stop_name serve como um identificador que seja facilmente reconhecido pelo passageiro. Seus valores, portanto, costumam ser nomes de estações, nomes de pontos de interesse da cidade ou endereços (como no caso do feed da SPTrans).\nA coluna stop_desc, presente no feed da SPTrans, é opcional e permite à agência de transporte adicionar uma descrição de cada parada e de seu entorno. As colunas stop_lat e stop_lon, por fim, são as responsáveis por associar cada parada a uma posição espacial, através de suas coordenadas geográficas de latitude e longitude.\nEntre as colunas opcionais não presentes no stops.txt deste feed estão a location_type e a parent_station. A location_type é utilizada para denotar o tipo de localização a que cada ponto se refere. Quando ausente, todos os pontos são interpretados como paradas de transporte público, mas valores distintos podem ser usados para distinguir uma parada (location_type = 0) de uma estação (location_type = 1) ou uma área de embarque (location_type = 2), por exemplo. A coluna parent_station, por sua vez, é utilizada para descrever relações de hierarquia entre dois pontos. Por exemplo, uma área de desembarque deve dizer a qual parada/plataforma ela pertence, assim como uma parada/plataforma pode também, opcionalmente, listar a qual estação ela pertence.\n\n4.1.3 routes.txt\nArquivo usado para descrever as linhas de transporte público que rodam no sistema descrito pelo arquivo GTFS, incluindo os modos de transporte utilizados em cada uma. A Tabela 4.3 mostra o routes.txt do feed da SPTrans.\n\n\n\n\nTabela 4.3: Exemplo de arquivo routes.txt\n\n\n\n\n\n\n\n\n\nroute_id\nagency_id\nroute_short_name\nroute_long_name\nroute_type\n\n\n\nCPTM L07\n1\nCPTM L07\nJUNDIAI - LUZ\n2\n\n\nCPTM L08\n1\nCPTM L08\nAMADOR BUENO - JULIO PRESTES\n2\n\n\nCPTM L09\n1\nCPTM L09\nGRAJAU - OSASCO\n2\n\n\nCPTM L10\n1\nCPTM L10\nRIO GRANDE DA SERRA - BRÁS\n2\n\n\nCPTM L11\n1\nCPTM L11\nESTUDANTES - LUZ\n2\n\n\nCPTM L12\n1\nCPTM L12\nCALMON VIANA - BRAS\n2\n\n\n\n\n\n\nAssim como no caso do arquivo stops.txt, a tabela do routes.txt também possui diferentes colunas que apontam o identificador de cada linha (route_id) e o seu nome. Neste caso, no entanto, existem duas colunas de nome: a route_short_name e a route_long_name. A primeira diz respeito ao nome da linha, usualmente utilizado por passageiros no dia-a-dia, enquanto o segundo tende a ser um nome mais descritivo. A SPTrans, por exemplo, optou por destacar os pontos finais de cada linha nesta coluna. Podemos notar também que os mesmos valores se repetem nas colunas route_id e route_short_name, o que não é obrigatório e nem proibido - neste caso, o produtor do feed julgou que os nomes das linhas poderiam funcionar satisfatoriamente como identificadores por serem razoavelmente curtos e não se repetirem.\nA coluna agency_id é a chave que permite relacionar a tabela das rotas com a tabela descrita no agency.txt. Ela faz menção a uma agência descrita naquele arquivo, no caso a agência de id 1 (a própria SPTrans). Esta coluna é opcional no caso de feeds em que existe apenas uma agência, porém é obrigatória no caso em que existem mais de uma. Imaginemos, por exemplo, um feed que descreve um sistema multimodal que conta com um corredor de metrô e diversas linhas de ônibus: uma configuração possível de routes.txt descreveria as linhas de metrô como de responsabilidade da operadora do metrô, e as de ônibus como de responsabilidade da empresa responsável pelo planejamento das linhas de ônibus, por exemplo.\nA coluna route_type é utilizada para descrever o modo de transporte utilizado em cada linha. Esta coluna aceita diferentes números, cada um representando um determinado modo. Este exemplo descreve linhas de trem, cujo valor numérico correspondente é 2. Os valores correspondentes para outros modos de transporte são listados na especificação.\n\n4.1.4 trips.txt\nArquivo usado para descrever as viagens realizadas no sistema de transporte público descrito pelo feed. A viagem é a unidade básica de movimento do formato GTFS: cada viagem é associada a uma linha de transporte público (route_id), a um serviço que opera em determinados dias da semana (como veremos mais à frente no arquivo calendar.txt) e a uma trajetória espacial (como veremos mais à frente no arquivo shapes.txt). A Tabela 4.4 mostra o trips.txt do feed da SPTrans.\n\n\n\n\nTabela 4.4: Exemplo de arquivo trips.txt\n\n\n\n\n\n\n\n\n\n\ntrip_id\nroute_id\nservice_id\ntrip_headsign\ndirection_id\nshape_id\n\n\n\nCPTM L07-0\nCPTM L07\nUSD\nJUNDIAI\n0\n17846\n\n\nCPTM L07-1\nCPTM L07\nUSD\nLUZ\n1\n17847\n\n\nCPTM L08-0\nCPTM L08\nUSD\nAMADOR BUENO\n0\n17848\n\n\nCPTM L08-1\nCPTM L08\nUSD\nJULIO PRESTES\n1\n17849\n\n\nCPTM L09-0\nCPTM L09\nUSD\nGRAJAU\n0\n17850\n\n\nCPTM L09-1\nCPTM L09\nUSD\nOSASCO\n1\n17851\n\n\n\n\n\n\nA coluna trip_id identifica cada uma das viagens descritas na tabela, assim como a route_id faz referência a uma linha de transporte público identificada no arquivo routes.txt. A coluna service_id identifica serviços que determinam os dias da semana em que cada uma das viagens opera (dias úteis, finais de semana, uma mistura dos dois, etc), descritos detalhadamente no arquivo calendar.txt. A última coluna à direita na tabela acima é a shape_id, que identifica a trajetória espacial de cada uma das viagens, descrita em detalhes no arquivo shapes.txt.\nAs duas colunas restantes, trip_headsign e direction_id, são opcionais e devem ser utilizadas para descrever o sentido/destino da viagem. A primeira, trip_headsign, é utilizada para ditar o texto que aparece no letreiro de veículos (no caso de um ônibus, por exemplo) ou em painéis informativos (como em metrôs e trens) destacando o destino da viagem. Já a coluna direction_id é frequentemente utilizada em conjunto com a primeira para dar uma conotação de ida ou volta para cada viagem, onde 0 representa ida e 1 volta, ou vice-versa (assim como ida e volta são conceitos que mudam conforme o referencial, os valores 0 e 1 podem ser usados como desejado, desde que um represente um sentido e o outro o contrário). No caso do nosso exemplo, as duas primeiras linhas são viagens que fazem menção à mesma rota de transporte público (CPTM L07), porém em sentidos opostos: uma corre em direção a Jundiaí, e a outra à Luz.\n\n4.1.5 calendar.txt\nArquivo usado para descrever os diferentes tipos de serviço existentes no sistema de transporte público descrito pelo feed. Um serviço, neste contexto, denota um conjunto de dias da semana em que viagens são realizadas. Cada serviço também é definido pela data em que começa a valer e pela data a partir do qual ele não é mais válido. A Tabela 4.5 mostra o calendar.txt do feed da SPTrans.\n\n\n\n\nTabela 4.5: Exemplo de arquivo calendar.txt\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nservice_id\nmonday\ntuesday\nwednesday\nthursday\nfriday\nsaturday\nsunday\nstart_date\nend_date\n\n\n\nUSD\n1\n1\n1\n1\n1\n1\n1\n20080101\n20200501\n\n\nU__\n1\n1\n1\n1\n1\n0\n0\n20080101\n20200501\n\n\nUS_\n1\n1\n1\n1\n1\n1\n0\n20080101\n20200501\n\n\n_SD\n0\n0\n0\n0\n0\n1\n1\n20080101\n20200501\n\n\n__D\n0\n0\n0\n0\n0\n0\n1\n20080101\n20200501\n\n\nS\n0\n0\n0\n0\n0\n1\n0\n20080101\n20200501\n\n\n\n\n\n\nA coluna service_id identifica cada um dos serviços descritos na tabela. Como mostrado anteriormente, este identificador é usado também no arquivo trips.txt, e é o responsável por associar cada viagem a um determinado serviço.\nAs colunas monday, tuesday, wednesday, thursday, friday, saturday e sunday (segunda-feira a domingo, em inglês) são utilizadas para delimitar os dias em que cada serviço funciona. Um valor de 1 significa que o serviço opera em um determinado dia, enquanto um valor de 0 significa que ele não opera. Como podemos ver no exemplo acima, o serviço USD opera em todos os dias da semana. Já o serviço U__ opera apenas em dias úteis.\nPor fim, as colunas start_date e end_date delimitam o intervalo em que cada serviço é válido. As datas do formato GTFS são sempre formatadas segundo a regra YYYYMMDD - ou seja, os primeiros quatro números definem o ano, os dois subsequentes definem o mês e os últimos dois, o dia. O valor 20220428, por exemplo, representa o dia 28 de abril de 2022.\n\n4.1.6 shapes.txt\nArquivo usado para descrever a trajetória espacial de cada viagem listada no feed. Este arquivo é opcional, mas é fortemente recomendado que agências de transporte o incluam em seus arquivos GTFS. A Tabela 4.6 mostra o shapes.txt do feed da SPTrans.\n\n\n\n\nTabela 4.6: Exemplo de arquivo shapes.txt\n\n\nshape_id\nshape_pt_lat\nshape_pt_lon\nshape_pt_sequence\n\n\n\n17846\n-23.53517\n-46.63535\n1\n\n\n17846\n-23.53513\n-46.63548\n2\n\n\n17846\n-23.53494\n-46.63626\n3\n\n\n17846\n-23.53473\n-46.63710\n4\n\n\n17846\n-23.53466\n-46.63735\n5\n\n\n17846\n-23.53416\n-46.63866\n6\n\n\n\n\n\n\nA coluna shape_id identifica cada uma das trajetórias descritas na tabela. Como mostrado anteriormente, este identificador é usado também no arquivo trips.txt, e é o responsável por associar cada viagem à sua trajetória espacial. Diferentemente de todos os outros identificadores que vimos até então, no entanto, o identificador shape_id se repete em diversas observações da tabela. Isto porque o arquivo associa cada shape_id a uma série de pontos espaciais, cujas coordenadas geográficas são descritas nas colunas shape_pt_lat e shape_pt_lon. A coluna shape_pt_sequence lista a sequência na qual os pontos se conectam para formar a trajetória de cada shape_id. Os valores listados nesta coluna devem ser ordenados de forma crescente.\n\n4.1.7 stop_times.txt\nArquivo usado para descrever a tabela de horários de cada viagem, incluindo o horário de chegada e partida em cada uma das paradas. A formatação deste arquivo depende da existência ou não de um arquivo frequencies.txt, detalhe que cobriremos mais adiante. Por enquanto olharemos para o stop_times.txt do feed da SPTrans, que também conta com um frequencies.txt, na Tabela 4.7.\n\n\n\n\nTabela 4.7: Exemplo de arquivo stop_times.txt\n\n\ntrip_id\narrival_time\ndeparture_time\nstop_id\nstop_sequence\n\n\n\nCPTM L07-0\n04:00:00\n04:00:00\n18940\n1\n\n\nCPTM L07-0\n04:08:00\n04:08:00\n18920\n2\n\n\nCPTM L07-0\n04:16:00\n04:16:00\n18919\n3\n\n\nCPTM L07-0\n04:24:00\n04:24:00\n18917\n4\n\n\nCPTM L07-0\n04:32:00\n04:32:00\n18916\n5\n\n\nCPTM L07-0\n04:40:00\n04:40:00\n18965\n6\n\n\n\n\n\n\nA viagem cuja tabela de horários está sendo descrita é identificada pela coluna trip_id. De forma análoga ao que acontece na tabela de trajetórias, um mesmo trip_id se repete em muitas observações da tabela. Isto porque, assim como uma trajetória é composta por uma sequência de pontos espaciais, uma tabela de horários é composta por uma sequência de diversos horários de partida/chegada em diversas paradas de transporte público.\nAs colunas seguintes, arrival_time, departure_time e stop_id, são as responsáveis por descrever o cronograma de cada viagem, associando um horário de chegada e um horário de partida para cada uma das paradas visitadas na viagem. As colunas de horário são formatadas segundo a regra HH:MM:SS - ou seja, os dois primeiros números definem a hora, os dois subsequentes os minutos e os últimos dois, os segundos. Esta formatação aceita valores de hora maiores do que 24: ou seja, uma viagem cuja última parada é visitada às 1h da manhã do dia seguinte ao que começou a rodar (digamos que ela tenha partido do ponto inicial às 23h) deve ter como horário de chegada 25:00:00, e não 01:00:00. A coluna stop_id, por sua vez, associa os horários de chegada e partida a uma parada descrita no arquivo stops.txt. Por fim, a coluna stop_sequence lista a sequência na qual cada parada se conecta às demais para formar o cronograma da viagem. Seus valores devem ser sempre ordenados de forma crescente.\nVale destacar aqui a diferença entre os arquivos shapes.txt e stop_times.txt. Embora os dois descrevam uma viagem espacialmente, eles o fazem de forma diferente. O stop_times.txt descreve a sequência de paradas e horários que compõem um cronograma, mas nada diz sobre o trajeto percorrido pelo veículo entre cada uma das paradas. Já o shapes.txt traz a trajetória detalhada da viagem como um todo, mas não descreve em que ponto do espaço estão as paradas da viagem. Quando usamos os dois arquivos em conjunto, portanto, sabemos tanto o cronograma de cada viagem quanto a trajetória espacial da viagem entre paradas.\n\n4.1.8 frequencies.txt\nArquivo opcional usado para descrever a frequência de cada viagem dentro de um determinado período do dia. A Tabela 4.8 mostra o frequencies.txt do feed da SPTrans.\n\n\n\n\nTabela 4.8: Exemplo de arquivo frequencies.txt\n\n\ntrip_id\nstart_time\nend_time\nheadway_secs\n\n\n\nCPTM L07-0\n04:00:00\n04:59:00\n720\n\n\nCPTM L07-0\n05:00:00\n05:59:00\n360\n\n\nCPTM L07-0\n06:00:00\n06:59:00\n360\n\n\nCPTM L07-0\n07:00:00\n07:59:00\n360\n\n\nCPTM L07-0\n08:00:00\n08:59:00\n360\n\n\nCPTM L07-0\n09:00:00\n09:59:00\n480\n\n\n\n\n\n\nA viagem cuja frequência está sendo descrita é identificada pela coluna trip_id. Novamente, um mesmo identificador pode aparecer em várias observações da tabela. Isto porque a especificação GTFS prevê que uma mesma viagem pode ter frequências diferentes ao longo do dia (como em horários de pico e fora-pico, por exemplo). Assim, cada linha da tabela descreve um período do dia que se inicia no horário descrito na coluna start_time e termina no horário assinalado na coluna end_time.\nDentro do período especificado por essas duas colunas, a viagem possui um headway detalhado na coluna headway_secs. O headway é o tempo que separa a passagem de dois veículos que operam a mesma linha de transporte público. No caso desta tabela, esse tempo deve ser especificado em segundos. Um valor de 720 entre 04:00h e 05:00h, portanto, significa que a viagem CPTM L07-0 ocorre de 12 em 12 minutos dentro deste período.\nUsando as tabelas frequencies.txt e stop_times.txt conjuntamente\nÉ importante entender, agora, como a presença da tabela frequencies.txt altera a especificação da tabela stop_times.txt. Como podemos ver no nosso exemplo, o horário de partida definido no stop_times.txt para a viagem CPTM L07-0 é 04:00h, e ela chega na segunda parada às 04:08h. O cronograma de chegada e saída de uma mesma parada de uma viagem, no entanto, não pode ser definido mais de uma vez na tabela. Como então definir o cronograma das viagens que partem às 04:12h, 04:24h, 04:36h, etc (lembre-se que o headway desta viagem é de 12 minutos)?\nNo caso em que a frequência de uma viagem é especificada no frequencies.txt, o cronograma (a tabela de horários) de uma viagem definido no stop_times.txt deve ser entendido como uma referência que descreve o tempo entre paradas. Isto é, os horários ali definidos não devem ser interpretados à risca. Por exemplo, o cronograma listado estabelece que o tempo de viagem entre a primeira e a segunda parada é de 8 minutos, e o tempo entre a segunda e a terceira também. Ou seja, a viagem que parte da primeira parada às 04:00h chega na segunda às 04:08h, e na terceira às 04:16h. A próxima viagem, que parte da primeira parada às 04:12h, por sua vez, chega na segunda parada às 04:20h, e na terceira às 04:28h.\nEntretanto, poderíamos descrever as mesmas viagens no stop_times.txt sem fazer uso do arquivo frequencies.txt. Para isso poderíamos adicionar um sufixo que identificasse cada uma das viagens referentes à linha CPTM L07 no sentido 0 ao longo do dia. A viagem (trip_id) com identificador CPTM L07-0_1, por exemplo, seria a primeira viagem do dia e partiria da primeira parada às 04:00h e chegaria na segunda parada às 04:08h. A viagem CPTM L07-0_2, por sua vez, seria a segunda viagem e partiria da primeira parada às 04:12h e chegaria na segunda às 04:20h, e daí em diante. Cada uma dessas viagens deveria ser também adicionada ao arquivo trips.txt e a quaisquer outros que possuam a coluna trip_id como identificador.\nOutra variável que afeta a forma na qual o frequencies.txt afeta as tabelas de horários na tabela stop_times.txt é a coluna opcional exact_times. Um valor de 0 nesta coluna (ou quando ela está ausente do feed, como no caso do arquivo GTFS da SPTrans) indica que a viagem não necessariamente segue um cronograma fixo ao longo do período. Em vez disso, operadores tentam se ater a um determinado headway durante o período. Usando o mesmo exemplo de uma viagem cujo headway é de 12 minutos entre as 04:00h e 05:00h, isto significaria que não necessariamente a primeira partida sairá exatamente às 04:00h, a segunda às 04:12h, e por aí em diante. A primeira pode, por exemplo, sair às 04:02h. A segunda, às 04:14h ou 04:13h, etc. Caso desejemos definir um cronograma que é seguido à risca, obtendo o mesmo resultado que seria obtido se definíssemos diversas viagens semelhantes partindo em diferentes horários no stop_times.txt (como mostrado no parágrafo anterior), devemos utilizar o valor 1 na coluna exact_times."
  },
  {
    "objectID": "4_dados_gtfs.html#onde-encontrar-gtfs-de-cidades-brasileiras",
    "href": "4_dados_gtfs.html#onde-encontrar-gtfs-de-cidades-brasileiras",
    "title": "4  Dados GTFS",
    "section": "\n4.2 Onde encontrar GTFS de cidades brasileiras",
    "text": "4.2 Onde encontrar GTFS de cidades brasileiras\nNo Brasil, diversas cidades usam dados de GTFS no planejamento e operação de seus sistemas de transportes. Em muitos casos, no entanto, esses dados são de propriedade de empresas operadoras e concessionárias de transporte, e não do poder público. Infelizmente, esses arquivos raramente são disponibilizados aberta e publicamente, contrariando boas práticas de gestão e compartilhamento de dados de interesse público. A Tabela 4.9 mostra as fontes dos dados GTFS de algumas das poucas cidades do Brasil que disponibilizam seus feeds abertamente3.\n\n\n\n\nTabela 4.9: Fontes de dados GTFS publicamente disponíveis no Brasil\n\nCidade\nFonte\nInformações\n\n\n\nBelo Horizonte\nBHTrans\nDado aberto: transporte convencional; transporte suplementar.\n\n\nFortaleza\nETUFOR\n\nDado aberto.\n\n\nFortaleza\nMetrofor\n\nDado aberto.\n\n\nPorto Alegre\nEPTC\n\nDado aberto.\n\n\nRio de Janeiro\nSMTR\n\nDado aberto.\n\n\nSão Paulo\nEMTU\nDownload neste link. Necessário cadastro.\n\n\nSão Paulo\nSPTrans\nDownload neste link. Necessário cadastro.\n\n\n\n\n\n\nObs.: Os dados de GTFS disponibilizados pela Secretaria Municipal de Transportes do Rio de Janeiro não incluem os dados dos sistemas de trem e metrô.\n\n\n\n\nMcHugh, Bibiana. 2013. “Pioneering Open Data Standards: The GTFS Story.” In Beyond Transparency: Open Data and the Future of Civic Innovation, edited by Brett Goldstein and Lauren Dyson, First, 125–35. San Francisco, CA: Code for America Press.\n\n\nPereira, Rafael H. M., Pedro R. Andrade, and João Pedro Bazzo Vieira. 2022. “Exploring the Time Geography of Public Transport Networks with the Gtfs2gps Package.” SocArXiv. https://doi.org/10.31235/osf.io/qydr6."
  },
  {
    "objectID": "5_gtfstools.html",
    "href": "5_gtfstools.html",
    "title": "\n5  Manipulação e visualização de dados GTFS\n",
    "section": "",
    "text": "Usualmente, arquivos GTFS provenientes de fontes oficiais são utilizados para desenvolver análises e pesquisas que possuem diversos elementos comuns. Visando facilitar a leitura, o processamento e a análise desses dados, a equipe do Projeto Acesso a Oportunidades vem desenvolvendo o pacote de R gtfstools1 (Herszenhut et al. 2022), que oferece diversas funções que facilitam a manipulação e a exploração de feeds.\nNeste capítulo, nós iremos passar por algumas das funcionalidades mais frequentemente utilizadas do pacote. Para isso, vamos utilizar uma amostra do feed da SPTrans apresentado no capítulo anterior, disponível dentro do gtfstools."
  },
  {
    "objectID": "5_gtfstools.html#leitura-e-manipulação-básica-de-arquivos-gtfs",
    "href": "5_gtfstools.html#leitura-e-manipulação-básica-de-arquivos-gtfs",
    "title": "\n5  Manipulação e visualização de dados GTFS\n",
    "section": "\n5.1 Leitura e manipulação básica de arquivos GTFS",
    "text": "5.1 Leitura e manipulação básica de arquivos GTFS\nA leitura de arquivos GTFS com o gtfstools é feita com a função read_gtfs(), que recebe uma string com o caminho do arquivo. Após sua leitura, o feed é representado como uma lista de data.tables, uma versão de alta performance da classe data.frame. Ao longo deste capítulo, nós vamos nos referir a esta lista de tabelas como um objeto GTFS. Por padrão, a função lê todas as tabelas .txt do feed:\n\n# carrega biblioteca\nlibrary(gtfstools)\n\n# aponta string com endereço do arquivo\nfile_path <- system.file(\"extdata/spo_gtfs.zip\", package = \"gtfstools\")\n\n# leitura do gtfs\ngtfs <- read_gtfs(path = file_path)\n\n# consulta o nome das tabelas dentro da lista\nnames(gtfs)\n\n[1] \"agency\"      \"calendar\"    \"frequencies\" \"routes\"      \"shapes\"     \n[6] \"stop_times\"  \"stops\"       \"trips\"      \n\n\nComo podemos ver, cada data.table dentro do objeto GTFS é nomeado de acordo com a tabela que ele representa, sem a extensão .txt. Isso nos permite selecionar e manipular cada uma das tabelas separadamente. O código abaixo, por exemplo, mostra os 6 primeiros registros da tabela trips:\n\nhead(gtfs$trips)\n\n   route_id service_id    trip_id trip_headsign direction_id shape_id\n1: CPTM L07        USD CPTM L07-0       JUNDIAI            0    17846\n2: CPTM L07        USD CPTM L07-1           LUZ            1    17847\n3: CPTM L08        USD CPTM L08-0  AMADOR BUENO            0    17848\n4: CPTM L08        USD CPTM L08-1 JULIO PRESTES            1    17849\n5: CPTM L09        USD CPTM L09-0        GRAJAU            0    17850\n6: CPTM L09        USD CPTM L09-1        OSASCO            1    17851\n\n\nAs tabelas dentro de um objeto GTFS podem ser facilmente manipuladas usando a sintaxe do pacote data.table. Este pacote oferece diversas funcionalidades úteis, principalmente para a manipulação de tabelas com uma grande quantidade de registros, como a edição de colunas por referência, filtros de linhas muito rápidos e agregação de dados eficiente2. Para adicionar 100 segundos a todos os headways listados na tabela frequencies e reverter essa mudança em seguida, por exemplo, nós podemos usar o código abaixo:\n\n# original\noriginal_headway <- gtfs$frequencies$headway_secs\nhead(gtfs$frequencies, 3)\n\n      trip_id start_time end_time headway_secs\n1: CPTM L07-0   04:00:00 04:59:00          720\n2: CPTM L07-0   05:00:00 05:59:00          360\n3: CPTM L07-0   06:00:00 06:59:00          360\n\n# frequência modificada\ngtfs$frequencies[, headway_secs := headway_secs + 100]\nhead(gtfs$frequencies, 3)\n\n      trip_id start_time end_time headway_secs\n1: CPTM L07-0   04:00:00 04:59:00          820\n2: CPTM L07-0   05:00:00 05:59:00          460\n3: CPTM L07-0   06:00:00 06:59:00          460\n\n# recupera frequencia original\ngtfs$frequencies[, headway_secs := original_headway]\nhead(gtfs$frequencies, 3)\n\n      trip_id start_time end_time headway_secs\n1: CPTM L07-0   04:00:00 04:59:00          720\n2: CPTM L07-0   05:00:00 05:59:00          360\n3: CPTM L07-0   06:00:00 06:59:00          360\n\n\nApós editarmos um objeto GTFS no R, frequentemente vamos querer usar o GTFS manipulado para fazer análises de diferentes tipos. Para isso, é comum que precisemos do arquivo GTFS em formato .zip novamente, e não como uma lista de tabelas dentro do R. O pacote gtfstools disponibiliza a função write_gtfs() exatamente com a finalidade de transformar objetos GTFS que existem apenas dentro do R em arquivos GTFS armazenados no seu computador. Para usar esta função, é necessário apenas listar o objeto e o endereço no qual o arquivo deve ser salvo:\n\n# aponta endereço onde arquivo deve ser salvo\ndest_path <- tempfile(\"new_gtfs\", fileext = \".zip\")\n\n# salve GTFS localmente\nwrite_gtfs(gtfs, dest_path)\n\n\n# listar arquivos dentro do feed salvo\nzip::zip_list(dest_path)[, c(\"filename\", \"compressed_size\", \"timestamp\")]\n\n         filename compressed_size           timestamp\n1      agency.txt             112 2022-10-23 19:55:42\n2    calendar.txt             129 2022-10-23 19:55:42\n3 frequencies.txt            2381 2022-10-23 19:55:42\n4      routes.txt             659 2022-10-23 19:55:42\n5      shapes.txt          160470 2022-10-23 19:55:42\n6  stop_times.txt            7907 2022-10-23 19:55:42\n7       stops.txt           18797 2022-10-23 19:55:42\n8       trips.txt             717 2022-10-23 19:55:42"
  },
  {
    "objectID": "5_gtfstools.html#cálculo-de-velocidade-das-linhas",
    "href": "5_gtfstools.html#cálculo-de-velocidade-das-linhas",
    "title": "\n5  Manipulação e visualização de dados GTFS\n",
    "section": "\n5.2 Cálculo de velocidade das linhas",
    "text": "5.2 Cálculo de velocidade das linhas\nArquivos GTFS são frequentemente utilizados em estimativas de roteamento de transporte público e para informar passageiros sobre a tabela de horários das diferentes rotas que operam em uma região. Dessa forma, é extremamente importante que o cronograma das viagens e a velocidade operacional de cada linha estejam adequadamente descritos no feed.\nO gtfstools disponibiliza a função get_trip_speed() para facilitar o cálculo da velocidade de cada viagem presente no feed. Por padrão, a função retorna a velocidade (em km/h) de todas as viagens do GTFS, mas viagens individuais também podem ser especificadas:\n\n# calcular velocidade de todas viagens\nspeeds <- get_trip_speed(gtfs)\n\nhead(speeds)\n\n     trip_id origin_file     speed\n1: 2002-10-0      shapes  8.952511\n2: 2105-10-0      shapes 10.253365\n3: 2105-10-1      shapes  9.795292\n4: 2161-10-0      shapes 11.182534\n5: 2161-10-1      shapes 11.784458\n6: 4491-10-0      shapes 13.203560\n\nnrow(speeds)\n\n[1] 36\n\n# calcular velocidade de duas viagens específicas\nspeeds <- get_trip_speed(gtfs, trip_id = c(\"CPTM L07-0\", \"2002-10-0\"))\n\nhead(speeds)\n\n      trip_id origin_file     speed\n1:  2002-10-0      shapes  8.952511\n2: CPTM L07-0      shapes 26.787768\n\n\nCalcular a velocidade de uma viagem requer que nós saibamos o seu comprimento e em quanto tempo ela foi realizada. Para isso, portanto, a get_trip_speed() utiliza duas outras funções do gtfstools por trás dos panos: a get_trip_length() e a get_trip_duration(). O funcionamento das duas é muito parecido com o mostrado anteriormente, retornando o comprimento/duração de todas as viagens por padrão, ou de apenas algumas selecionadas, caso desejado. Abaixo nós mostramos seus comportamentos padrões:\n\n# distância percorrida de todas viagens\nlength <- get_trip_length(gtfs, file = \"shapes\")\n\nhead(length)\n\n      trip_id   length origin_file\n1: CPTM L07-0 60.71894      shapes\n2: CPTM L07-1 60.71894      shapes\n3: CPTM L08-0 41.79037      shapes\n4: CPTM L08-1 41.79037      shapes\n5: CPTM L09-0 31.88906      shapes\n6: CPTM L09-1 31.88906      shapes\n\n# tempo de duração de todas viagens em minutos\nduration <- get_trip_duration(gtfs, unit = 'min')\n\nhead(duration)\n\n     trip_id duration\n1: 2002-10-0       48\n2: 2105-10-0      108\n3: 2105-10-1      111\n4: 2161-10-0       94\n5: 2161-10-1       93\n6: 4491-10-0       69\n\n\nAssim como a get_trip_speed() retorna velocidades em km/h por padrão, a get_trip_length() retorna os comprimentos em km e a get_trip_duration() retorna a duração em minutos. Essas unidades podem ser ajustadas com o argumento unit, presente em todas as funções."
  },
  {
    "objectID": "5_gtfstools.html#combinando-e-filtrando-feeds",
    "href": "5_gtfstools.html#combinando-e-filtrando-feeds",
    "title": "\n5  Manipulação e visualização de dados GTFS\n",
    "section": "\n5.3 Combinando e filtrando feeds\n",
    "text": "5.3 Combinando e filtrando feeds\n\nMuitas vezes o processamento e a edição de arquivos GTFS é realizado, em grande medida, manualmente. Consequentemente, pequenas inconsistências podem passar batidas pelos responsáveis por esse processamento. Um problema comumente observado em feeds é a presença de registros duplicados em uma mesma tabela. O feed da SPTrans, por exemplo, possui registros duplicados tanto no agency.txt quanto no calendar.txt:\n\ngtfs$agency\n\n   agency_id agency_name                               agency_url\n1:         1     SPTRANS http://www.sptrans.com.br/?versao=011019\n2:         1     SPTRANS http://www.sptrans.com.br/?versao=011019\n     agency_timezone agency_lang\n1: America/Sao_Paulo          pt\n2: America/Sao_Paulo          pt\n\ngtfs$calendar\n\n    service_id monday tuesday wednesday thursday friday saturday sunday\n 1:        USD      1       1         1        1      1        1      1\n 2:        U__      1       1         1        1      1        0      0\n 3:        US_      1       1         1        1      1        1      0\n 4:        _SD      0       0         0        0      0        1      1\n 5:        __D      0       0         0        0      0        0      1\n 6:        _S_      0       0         0        0      0        1      0\n 7:        USD      1       1         1        1      1        1      1\n 8:        U__      1       1         1        1      1        0      0\n 9:        US_      1       1         1        1      1        1      0\n10:        _SD      0       0         0        0      0        1      1\n11:        __D      0       0         0        0      0        0      1\n12:        _S_      0       0         0        0      0        1      0\n    start_date   end_date\n 1: 2008-01-01 2020-05-01\n 2: 2008-01-01 2020-05-01\n 3: 2008-01-01 2020-05-01\n 4: 2008-01-01 2020-05-01\n 5: 2008-01-01 2020-05-01\n 6: 2008-01-01 2020-05-01\n 7: 2008-01-01 2020-05-01\n 8: 2008-01-01 2020-05-01\n 9: 2008-01-01 2020-05-01\n10: 2008-01-01 2020-05-01\n11: 2008-01-01 2020-05-01\n12: 2008-01-01 2020-05-01\n\n\nO gtfstools disponibiliza a função remove_duplicates() para remover essas duplicatas. Esta função recebe como input um objeto GTFS e retorna o mesmo objeto, porém sem registros duplicados:\n\n# removendo valores duplicados\nno_dups_gtfs <- remove_duplicates(gtfs)\n\n# checagem do resultado\nno_dups_gtfs$agency\n\n   agency_id agency_name                               agency_url\n1:         1     SPTRANS http://www.sptrans.com.br/?versao=011019\n     agency_timezone agency_lang\n1: America/Sao_Paulo          pt\n\nno_dups_gtfs$calendar\n\n   service_id monday tuesday wednesday thursday friday saturday sunday\n1:        USD      1       1         1        1      1        1      1\n2:        U__      1       1         1        1      1        0      0\n3:        US_      1       1         1        1      1        1      0\n4:        _SD      0       0         0        0      0        1      1\n5:        __D      0       0         0        0      0        0      1\n6:        _S_      0       0         0        0      0        1      0\n   start_date   end_date\n1: 2008-01-01 2020-05-01\n2: 2008-01-01 2020-05-01\n3: 2008-01-01 2020-05-01\n4: 2008-01-01 2020-05-01\n5: 2008-01-01 2020-05-01\n6: 2008-01-01 2020-05-01\n\n\nFrequentemente, também, lidamos com múltiplos feeds em uma mesma área de estudo. Por exemplo, quando os dados dos sistemas de ônibus e de trens de uma mesma cidade estão salvos em arquivos GTFS separados. Neste caso, muitas vezes gostaríamos de uni-los em um único arquivo, diminuindo assim o esforço de manipulação e processamento dos dados. Para isso, o gtfstools disponibiliza a função merge_gtfs(). O exemplo abaixo mostra o resultado da combinação de dois feeds distintos, o da SPTrans (sem duplicatas) e o da EMTU, de Porto Alegre:\n\n# leitura do GTFS de Porto Alegre\npoa_path <- system.file(\"extdata/poa_gtfs.zip\", package = \"gtfstools\")\npoa_gtfs <- read_gtfs(poa_path)\n\npoa_gtfs$agency\n\n   agency_id                                 agency_name             agency_url\n1:      EPTC Empresa Publica de Transportes e Circulação http://www.eptc.com.br\n     agency_timezone agency_lang agency_phone\n1: America/Sao_Paulo          pt          156\n                                                  agency_fare_url\n1: http://www2.portoalegre.rs.gov.br/eptc/default.php?p_secao=155\n\nno_dups_gtfs$agency\n\n   agency_id agency_name                               agency_url\n1:         1     SPTRANS http://www.sptrans.com.br/?versao=011019\n     agency_timezone agency_lang\n1: America/Sao_Paulo          pt\n\n# Combinando GTFS de Porto Alegre e São Paulo\ncombined_gtfs <- merge_gtfs(no_dups_gtfs, poa_gtfs)\n\n# checagem dos resultados\ncombined_gtfs$agency\n\n   agency_id                                 agency_name\n1:         1                                     SPTRANS\n2:      EPTC Empresa Publica de Transportes e Circulação\n                                 agency_url   agency_timezone agency_lang\n1: http://www.sptrans.com.br/?versao=011019 America/Sao_Paulo          pt\n2:                   http://www.eptc.com.br America/Sao_Paulo          pt\n   agency_phone                                                agency_fare_url\n1:                                                                            \n2:          156 http://www2.portoalegre.rs.gov.br/eptc/default.php?p_secao=155\n\n\nComo podemos ver, os registros das tabelas de ambos os feeds foram combinados em uma única tabela. Este é o caso quando os dois (ou mais, caso desejado) objetos GTFS possuem registros de uma mesma tabela (a agency, no exemplo). Caso apenas um dos objetos possua uma das tabelas, o resultado da operação de combinação copia esta tabela para o resultado final. É o caso, por exemplo, da tabela frequencies, que existe apenas no feed da SPTrans, mas não no da EMTU:\n\nnames(poa_gtfs)\n\n[1] \"agency\"     \"calendar\"   \"routes\"     \"shapes\"     \"stop_times\"\n[6] \"stops\"      \"trips\"     \n\nnames(no_dups_gtfs)\n\n[1] \"agency\"      \"calendar\"    \"frequencies\" \"routes\"      \"shapes\"     \n[6] \"stop_times\"  \"stops\"       \"trips\"      \n\nnames(combined_gtfs)\n\n[1] \"agency\"      \"calendar\"    \"frequencies\" \"routes\"      \"shapes\"     \n[6] \"stop_times\"  \"stops\"       \"trips\"      \n\nidentical(no_dups_gtfs$frequencies, combined_gtfs$frequencies)\n\n[1] TRUE\n\n\nUm outro tipo de operação muito utilizada no tratamento de arquivos GTFS é o de filtragem desses arquivos. Frequentemente, feeds são usados para descrever redes de transporte público de grande escala, o que pode transformar sua edição, análise e compartilhamento em operações mais complexas. Por esse motivo, pesquisadores e planejadores muitas vezes precisar trabalhar com um subconjunto de dados descritos nos feeds. Por exemplo, caso desejemos estimar a performance da rede de transporte em uma determinada região no horário de pico da manhã, podemos filtrar o nosso arquivo GTFS de modo a manter apenas os registros referentes a viagens que ocorrem nesse intervalo do dia.\nO pacote gtfstools traz diversas funções para facilitar a filtragem de arquivos GTFS. São elas:\n\nfilter_by_agency_id()\nfilter_by_route_id()\nfilter_by_service_id()\nfilter_by_shape_id()\nfilter_by_stop_id()\nfilter_by_trip_id()\nfilter_by_route_type()\nfilter_by_weekday()\nfilter_by_time_of_day()\nfilter_by_sf()\n\nFiltro por identificadores\nAs seis primeiras (filter_by_agency_id(), filter_by_route_id(), filter_by_service_id(), filter_by_shape_id(), filter_by_stop_id() e filter_by_trip_id()) funcionam de forma muito similar. O usuário deve especificar um vetor de identificadores, e a função mantém no objeto GTFS apenas os registros referentes a esses identificadores. O exemplo abaixo demonstra essa funcionalidade com a filter_by_trip_id():\n\n# checando tamanho do feed antes do filtro\nutils::object.size(gtfs)\n\n864568 bytes\n\nhead(gtfs$trips[, .(trip_id, trip_headsign, shape_id)])\n\n      trip_id trip_headsign shape_id\n1: CPTM L07-0       JUNDIAI    17846\n2: CPTM L07-1           LUZ    17847\n3: CPTM L08-0  AMADOR BUENO    17848\n4: CPTM L08-1 JULIO PRESTES    17849\n5: CPTM L09-0        GRAJAU    17850\n6: CPTM L09-1        OSASCO    17851\n\n# filtro mantendo apenas duas viagens\nsmaller_gtfs <- filter_by_trip_id(gtfs, trip_id = c(\"CPTM L07-0\", \"CPTM L07-1\"))\n\n# checando tamanho do feed após o filtro\nutils::object.size(smaller_gtfs)\n\n71592 bytes\n\nhead(smaller_gtfs$trips[, .(trip_id, trip_headsign, shape_id)])\n\n      trip_id trip_headsign shape_id\n1: CPTM L07-0       JUNDIAI    17846\n2: CPTM L07-1           LUZ    17847\n\nunique(smaller_gtfs$shapes$shape_id)\n\n[1] \"17846\" \"17847\"\n\n\nO código acima mostra que a função não filtra apenas a tabela trips, mas também as outras tabelas que fazem referência aos identificadores especificados. Por exemplo, a trajetória das viagens CPTM L07-0 and CPTM L07-1 é descrita pelos shape_ids 17846 and 17847, respectivamente. Esses são, portanto, os únicos identificadores da tabela shapes mantidos no GTFS filtrado.\nA função também pode funcionar com o comportamento diametralmente oposto: em vez de definirmos os identificadores cujos registros devem ser mantidos no feed, podemos especificar os identificadores que devem ser retirados dele. Para isso, usamos o argumento keep com valor FALSE:\n\n# filtro removendo duas viagens do feed\nsmaller_gtfs <- filter_by_trip_id(\n  gtfs,\n  trip_id = c(\"CPTM L07-0\", \"CPTM L07-1\"),\n  keep = FALSE\n)\n\nhead(smaller_gtfs$trips[, .(trip_id, trip_headsign, shape_id)])\n\n      trip_id       trip_headsign shape_id\n1: CPTM L08-0        AMADOR BUENO    17848\n2: CPTM L08-1       JULIO PRESTES    17849\n3: CPTM L09-0              GRAJAU    17850\n4: CPTM L09-1              OSASCO    17851\n5: CPTM L10-0 RIO GRANDE DA SERRA    17852\n6: CPTM L10-1                BRÁS    17853\n\nhead(unique(smaller_gtfs$shapes$shape_id))\n\n[1] \"17848\" \"17849\" \"17850\" \"17851\" \"17852\" \"17853\"\n\n\nComo podemos ver, as viagens especificadas, bem como suas trajetórias, não estão presentes no GTFS filtrado. A mesma lógica aqui demonstrada com a filter_by_trip_id() é válida para as funções que filtram objetos GTFS pelos identificadores agency_id, route_id, service_id, shape_id, stop_id e route_type.\nFiltro por dia e hora\nOutra operação que recorrentemente aparece em análises que envolvem dados GTFS é a de manter serviços que funcionem apenas em determinados horários do dia ou dias da semana. Para isso, o pacote disponibiliza as funções filter_by_weekday() e filter_by_time_of_day().\nA filter_by_weekday() recebe os dias da semana (em inglês) cujos serviços que neles operam devem ser mantidos. Adicionalmente, a função também inclui o argumento combine, que define como filtros de dois ou mais dias funcionam. Quando este recebe o valor ”and”, apenas serviços que operam em todos os dias especificados são mantidos. Quando recebe o valor ”or”, serviços que operam em pelo menos um dos dias são mantidos:\n\n# filtro mantendo apenas serviços que operam no sábado e no domingo\nsmaller_gtfs <- filter_by_weekday(\n  gtfs = no_dups_gtfs,\n  weekday = c(\"saturday\", \"sunday\"),\n  combine = \"and\"\n)\n\nsmaller_gtfs$calendar[, c(\"service_id\", \"sunday\", \"saturday\")]\n\n   service_id sunday saturday\n1:        USD      1        1\n2:        _SD      1        1\n\n# filtro mantendo apenas serviços que operam ou sábado ou no domingo\nsmaller_gtfs <- filter_by_weekday(\n  gtfs = no_dups_gtfs,\n  weekday = c(\"sunday\", \"saturday\"),\n  combine = \"or\"\n)\n\nsmaller_gtfs$calendar[, c(\"service_id\", \"sunday\", \"saturday\")]\n\n   service_id sunday saturday\n1:        USD      1        1\n2:        US_      0        1\n3:        _SD      1        1\n4:        __D      1        0\n5:        _S_      0        1\n\n\nA filter_by_time_of_day(), por sua vez, recebe o começo e o final de uma janela de tempo e mantém os registros relacionados a viagens que rodam dentro dessa janela de horário. O funcionamento da função depende da presença ou não da tabela frequencies no GTFS: o cronograma descrito na stop_times das viagens descritas na tabela frequencies não deve ser filtrado, pois, como comentado no capítulo anterior, ele serve como um modelo que dita o tempo de viagem entre uma parada e outra. Caso a frequencies esteja ausente, no entanto, a stop_times é filtrada segundo o intervalo de tempo especificado. Vamos ver como isso funciona com um exemplo:\n\n# filtro mantendo apenas viagens dentro do período de 5 às 6 da manhã\nsmaller_gtfs <- filter_by_time_of_day(gtfs, from = \"05:00:00\", to = \"06:00:00\")\n\nhead(smaller_gtfs$frequencies)\n\n      trip_id start_time end_time headway_secs\n1: CPTM L07-0   05:00:00 05:59:00          360\n2: CPTM L07-1   05:00:00 05:59:00          360\n3: CPTM L08-0   05:00:00 05:59:00          480\n4: CPTM L08-1   05:00:00 05:59:00          480\n5: CPTM L09-0   05:00:00 05:59:00          480\n6: CPTM L09-1   05:00:00 05:59:00          480\n\nhead(smaller_gtfs$stop_times[, c(\"trip_id\", \"departure_time\", \"arrival_time\")])\n\n      trip_id departure_time arrival_time\n1: CPTM L07-0       04:00:00     04:00:00\n2: CPTM L07-0       04:08:00     04:08:00\n3: CPTM L07-0       04:16:00     04:16:00\n4: CPTM L07-0       04:24:00     04:24:00\n5: CPTM L07-0       04:32:00     04:32:00\n6: CPTM L07-0       04:40:00     04:40:00\n\nfrequencies <- gtfs$frequencies\ngtfs$frequencies <- NULL\n\nsmaller_gtfs <- filter_by_time_of_day(gtfs, from = \"05:00:00\", to = \"06:00:00\")\n\nhead(smaller_gtfs$stop_times[, c(\"trip_id\", \"departure_time\", \"arrival_time\")])\n\n      trip_id departure_time arrival_time\n1: CPTM L07-0       05:04:00     05:04:00\n2: CPTM L07-0       05:12:00     05:12:00\n3: CPTM L07-0       05:20:00     05:20:00\n4: CPTM L07-0       05:28:00     05:28:00\n5: CPTM L07-0       05:36:00     05:36:00\n6: CPTM L07-0       05:44:00     05:44:00\n\n\nO filtro da tabela stop_times pode funcionar de duas formas distintas. Uma opção é manter intactas todas as viagens que cruzam a janela de tempo especificada. A outra é manter apenas os segmentos de viagens que ocorrem dentro da janela (comportamento padrão da função). Este comportamento é controlado com o parâmetro full_trips, como mostrado a seguir (atenção aos horários e aos segmentos presentes em cada exemplo):\n\n# filtro mantendo apenas viagens inteiramente dentro do período de 5 às 6 da manhã\nsmaller_gtfs <- filter_by_time_of_day(\n  gtfs,\n  from = \"05:00:00\", \n  to = \"06:00:00\",\n  full_trips = TRUE\n)\n\nhead(\n  smaller_gtfs$stop_times[,\n    c(\"trip_id\", \"departure_time\", \"arrival_time\", \"stop_sequence\")\n  ]\n)\n\n      trip_id departure_time arrival_time stop_sequence\n1: CPTM L07-0       04:00:00     04:00:00             1\n2: CPTM L07-0       04:08:00     04:08:00             2\n3: CPTM L07-0       04:16:00     04:16:00             3\n4: CPTM L07-0       04:24:00     04:24:00             4\n5: CPTM L07-0       04:32:00     04:32:00             5\n6: CPTM L07-0       04:40:00     04:40:00             6\n\n# filtro mantendo apenas viagens que do período que estão funcionando entre 5 e 6 da manhã\nsmaller_gtfs <- filter_by_time_of_day(\n  gtfs,\n  from = \"05:00:00\",\n  to = \"06:00:00\",\n  full_trips = FALSE\n)\n\nhead(\n  smaller_gtfs$stop_times[,\n    c(\"trip_id\", \"departure_time\", \"arrival_time\", \"stop_sequence\")\n  ]\n)\n\n      trip_id departure_time arrival_time stop_sequence\n1: CPTM L07-0       05:04:00     05:04:00             9\n2: CPTM L07-0       05:12:00     05:12:00            10\n3: CPTM L07-0       05:20:00     05:20:00            11\n4: CPTM L07-0       05:28:00     05:28:00            12\n5: CPTM L07-0       05:36:00     05:36:00            13\n6: CPTM L07-0       05:44:00     05:44:00            14\n\n\nFiltro espacial\nPor fim, o pacote gtfstools também disponibiliza uma função que permite filtrar o objeto GTFS usando um polígono espacial. A filter_by_sf() recebe um objeto do tipo sf/sfc (representação espacial estabelecida pelo pacote sf), ou sua bounding box, e mantém os registros cujas viagens são selecionadas por uma operação espacial especificada pelo usuário. Embora aparentemente complicado, este processo de filtragem é muito facilmente compreendido quando apresentado visualmente. Para isso, vamos filtrar o GTFS da SPTrans pela bouding box da trajetória de id 68962. O código abaixo apresenta a distribuição espacial dos dados não filtrados, com a bounding box destacada em vermelho:\n\n# carrega biblioteca ggplot2 para visualização de dados\nlibrary(ggplot2)\n\nshape_68962 <- convert_shapes_to_sf(gtfs, shape_id = \"68962\")\nbbox <- sf::st_bbox(shape_68962)\n\nshapes <- convert_shapes_to_sf(gtfs)\nbbox_geom <- sf::st_as_sfc(bbox)\n\nggplot() +\n  geom_sf(data = shapes) +\n  geom_sf(data = bbox_geom, fill = NA, color = \"red\") +\n  theme_minimal()\n\n\n\n\nNote que nós usamos a função convert_shapes_to_sf(), também disponibilizada pelo gtfstools, que converte uma determinada trajetória descrita no GTFS em um objeto espacial do tipo sf. Por padrão, a filter_by_sf() mantém os dados relacionados aos registros de viagens cujas trajetórias possuem alguma interseção com o polígono espacial selecionado:\n\nfiltered_gtfs <- filter_by_sf(gtfs, bbox, spatial_operation = sf::st_intersects)\nfiltered_shapes <- convert_shapes_to_sf(filtered_gtfs)\n\nggplot() +\n  geom_sf(data = filtered_shapes) +\n  geom_sf(data = bbox_geom, fill = NA, color = \"red\") +\n  theme_minimal()\n\n\n\n\nNós podemos, no entanto, controlar a operação espacial usada no processo de filtragem. Por exemplo, o código abaixo mostra como nós podemos manter os dados relacionados a viagens que estão contidas dentro do polígono espacial:\n\nfiltered_gtfs <- filter_by_sf(gtfs, bbox, spatial_operation = sf::st_contains)\nfiltered_shapes <- convert_shapes_to_sf(filtered_gtfs)\n\nggplot() +\n  geom_sf(data = filtered_shapes) +\n  geom_sf(data = bbox_geom, fill = NA, color = \"red\") +\n  theme_minimal()"
  },
  {
    "objectID": "5_gtfstools.html#mapeamento-do-headway-das-linhas",
    "href": "5_gtfstools.html#mapeamento-do-headway-das-linhas",
    "title": "\n5  Manipulação e visualização de dados GTFS\n",
    "section": "\n5.4 Mapeamento do headway das linhas",
    "text": "5.4 Mapeamento do headway das linhas\nComo mostrado nas seções anteriores, o gtfstools disponibiliza uma grande caixa de ferramentas que podem ser usadas no processamento e na análise de arquivos GTFS. O pacote, no entanto, oferece diversas outras funções que não podem ser apresentadas neste livro, por questões de espaço. A lista completa de funções disponíveis pode ser conferida no site do pacote.\nA apresentação das funções feitas até aqui tem um importante caráter demonstrativo, porém não mostra como elas podem ser usadas de forma conjunta no desenvolvimento de uma análise de um arquivo GTFS. Esta seção preenche esta lacuna, mostrando como o pacote pode ser usado, por exemplo, para responder a seguinte pergunta: como se distribuem espacialmente os tempos entre veículos de uma mesma linha (ou seja, o headway) no GTFS da SPTrans?\nA primeira etapa é definir o escopo da nossa análise. A fim de exemplo, vamos considerar o headway no pico da manhã, entre 7h e 9h, em uma típica terça-feira de operação. Para isso, precisamos filtrar o nosso feed:\n\n# ler dados de GTFS\ngtfs <- read_gtfs(path = file_path)\n\n# filtrando GTFS\nfiltered_gtfs <- gtfs |>\n  remove_duplicates() |>\n  filter_by_weekday(\"tuesday\") |>\n  filter_by_time_of_day(from = \"07:00:00\", to = \"09:00:00\")\n\n# checando resultado do filtro\nfiltered_gtfs$frequencies[trip_id == \"2105-10-0\"]\n\n     trip_id start_time end_time headway_secs\n1: 2105-10-0   07:00:00 07:59:00          900\n2: 2105-10-0   08:00:00 08:59:00         1200\n\n# checando resultado do filtro\nfiltered_gtfs$calendar\n\n   service_id monday tuesday wednesday thursday friday saturday sunday\n1:        USD      1       1         1        1      1        1      1\n2:        U__      1       1         1        1      1        0      0\n   start_date   end_date\n1: 2008-01-01 2020-05-01\n2: 2008-01-01 2020-05-01\n\n\nEm seguida, precisamos calcular o headway dentro do período estabelecido. Essa informação pode ser encontrada na tabela frequencies, porém há um elemento complicador: cada viagem está associada a mais de um headway, como podemos ver acima (um registro para o período entre 7:00h e 7:59h e outro para o período entre entre 8:00h e 8:59h). Para resolver esta questão, portanto, vamos calcular o headway médio no intervalo entre 7:00h e 9:00h.\nOs primeiros registros da tabela frequencies do GTFS da SPTrans parecem sugerir que os períodos do dia estão listados sempre de uma em uma hora, porém isto não é uma regra estabelecida na especificação GTFS e nem é a prática adotada em outros GTFS. Por isso, nós vamos calcular a média ponderada do headway no período especificado. Para isso, precisamos multiplicar cada headway pelo intervalo de tempo em que ele é válido, e dividir o total desta soma pelo intervalo de tempo total (duas horas). Para calcular o intervalo de tempo em que cada headway é válido, nós usamos a função convert_time_to_seconds() para calcular o começo e o fim do intervalo em segundos e subtraímos o valor do fim pelo do começo, como abaixo:\n\nfiltered_gtfs <- convert_time_to_seconds(filtered_gtfs)\n\nfiltered_gtfs$frequencies[trip_id == \"2105-10-0\"]\n\n     trip_id start_time end_time headway_secs start_time_secs end_time_secs\n1: 2105-10-0   07:00:00 07:59:00          900           25200         28740\n2: 2105-10-0   08:00:00 08:59:00         1200           28800         32340\n\nfiltered_gtfs$frequencies[, time_interval := end_time_secs - start_time_secs]\n\nEm seguida, calculamos o headway médio:\n\navg_headway <- filtered_gtfs$frequencies[,\n  .(avg_headway = weighted.mean(x = headway_secs, w = time_interval)),\n  by = trip_id\n]\n\navg_headway[trip_id == \"2105-10-0\"]\n\n     trip_id avg_headway\n1: 2105-10-0        1050\n\nhead(avg_headway)\n\n      trip_id avg_headway\n1: CPTM L07-0         360\n2: CPTM L07-1         360\n3: CPTM L08-0         300\n4: CPTM L08-1         300\n5: CPTM L09-0         240\n6: CPTM L09-1         240\n\n\nPrecisamos agora gerar a trajetória espacial de cada viagem e juntar esta informação à do headway médio. Para isso, vamos utilizar a função get_trip_geometry(), que, dado um objeto GTFS, retorna a trajetória espacial de suas viagens. Esta função nos permite especificar de quais viagens nós queremos as trajetórias, logo vamos calcular apenas as daquelas que estão presentes na tabela de headways médios:\n\nselected_trips <- avg_headway$trip_id\n\ngeoms <- get_trip_geometry(\n  gtfs = filtered_gtfs,\n  trip_id = selected_trips,\n  file = \"shapes\"\n)\n\nhead(geoms)\n\nSimple feature collection with 6 features and 2 fields\nGeometry type: LINESTRING\nDimension:     XY\nBounding box:  xmin: -46.98404 ymin: -23.73644 xmax: -46.63535 ymax: -23.19474\nGeodetic CRS:  WGS 84\n     trip_id origin_file                       geometry\n1 CPTM L07-0      shapes LINESTRING (-46.63535 -23.5...\n2 CPTM L07-1      shapes LINESTRING (-46.87255 -23.1...\n3 CPTM L08-0      shapes LINESTRING (-46.64073 -23.5...\n4 CPTM L08-1      shapes LINESTRING (-46.98404 -23.5...\n5 CPTM L09-0      shapes LINESTRING (-46.77604 -23.5...\n6 CPTM L09-1      shapes LINESTRING (-46.69711 -23.7...\n\n\nO objeto geoms está no formato sf, e não no data.table, que precisamos que ele esteja para juntarmos à tabela de headways. Depois de convertê-lo para o formato adequado e juntá-lo à tabela de headways, precisamos apenas configurar o nosso mapa como desejado. No exemplo abaixo, nós usamos cores e espessuras de linhas que variam de acordo com o headway de cada viagem:\n\nlibrary(data.table)\nlibrary(sf)\n\n# converte objeto em data.table e faz ‘merge’ para fazer as infos espaciais\nsetDT(geoms)\navg_headway[geoms, on = \"trip_id\", geometry := i.geometry]\n\n# converte objeto de volta para sf para poder fazer o mapa\navg_headway_sf <- st_sf(avg_headway)\n\n# plotar figura\nggplot(avg_headway_sf) +\n  geom_sf(aes(color = avg_headway, size = avg_headway), alpha = 0.8) +\n  theme_minimal()\n\n\n\n\nComo podemos ver, o pacote gtfstools torna o desenvolvimento de análises de feeds de transporte público algo fácil e que requer apenas o conhecimento básico de pacotes de manipulação de tabela (como o data.table ou o dplyr) para grande parte das etapas que as compõem. O exemplo apresentado nesta seção mostra como muitas de suas funções podem ser usadas conjuntamente para revelar aspectos importantes de sistemas de transporte público descritos no formato GTFS.\n\n\n\n\nHerszenhut, Daniel, Rafael H. M. Pereira, Pedro R. Andrade, and João Bazzo. 2022. “Gtfstools: General Transit Feed Specification (GTFS) Editing and Analysing Tools.” Zenodo. https://doi.org/10.5281/ZENODO.6577028."
  },
  {
    "objectID": "s4_avaliacao_impacto.html",
    "href": "s4_avaliacao_impacto.html",
    "title": "SEÇÃO 4: Avaliação de impacto de projetos de transporte",
    "section": "",
    "text": "Embora muito utilizado na literatura científica, o foco em questões de acessibilidade urbana ainda é relativamente recente no planejamento e operação de sistemas de transporte público por parte de agências de transportes e tomadores de decisão (Papa et al. 2015; Boisjoly and El-Geneidy 2017). Muito disto se dá pela dificuldade de incorporar análises de acessibilidade a métodos de avaliação de projetos e à atividades de planejamento do dia-a-dia (Silva et al. 2017; Büttner 2021).\nNesta seção, nós usamos um estudo de caso de um projeto de expansão de metrô para ilustrar podemos usar o R para avaliar o impacto de projetos de infraestrutura de transporte sobre acessibilidade urbana. O capítulo apresenta um método para medir tanto o impacto de investimentos de transporte sobre o nível médio de acessibilidade da população, como também para investigar o impacto de projetos sobre as desigualdades de acesso a oportunidades. A aplicação do método envolve a edição de arquivos GTFS, o cálculo de matrizes de tempo de viagem, a tomada de decisão por trás da escolha de qual medida de acessibilidade utilizar, a estimativa dos níveis de acessibilidade, a visualização espacial desses níveis e o cálculo e análise de indicadores de desigualdade. Assim, esse estudo de caso engloba muitos dos pontos abordados neste livro, e serve como uma aplicação prática dos conceitos até então apresentados.\nÉ importante mencionar que uma avaliação de projeto, investimento ou política pública deve abranger um grande leque de critérios de diferentes naturezas. Esses critérios vão desde aspectos de participação social na formulação da política/projeto até o seu impacto considerando dimensões ambientais, econômicas, sociais, entre outras. Embora uma avaliação de impacto de acessibilidade seja muito importante para a caracterização dos potenciais benefícios e desempenho de redes de transporte como um todo, ela é apenas uma dessas dimensões, e deve complementar ou ser complementada por outras análises.\n\n\n\n\nBoisjoly, Geneviève, and Ahmed M. El-Geneidy. 2017. “How to Get There? A Critical Assessment of Accessibility Objectives and Indicators in Metropolitan Transportation Plans.” Transport Policy 55 (April): 38–50. https://doi.org/10.1016/j.tranpol.2016.12.011.\n\n\nBüttner, Benjamin. 2021. “Accessibility Tools for Transport Policy and Planning.” In International Encyclopedia of Transportation, edited by Roger Vickerman, 83–86. Oxford: Elsevier. https://doi.org/10.1016/B978-0-08-102671-7.10618-9.\n\n\nPapa, Enrica, Cecilia Silva, Marco Te Brömmelstroet, and Angela Hull. 2015. “Accessibility Instruments for Planning Practice: A Review of European Experiences.” Journal of Transport and Land Use, June. https://doi.org/10.5198/jtlu.2015.585.\n\n\nSilva, Cecília, Luca Bertolini, Marco te Brömmelstroet, Dimitris Milakis, and Enrica Papa. 2017. “Accessibility Instruments in Planning Practice: Bridging the Implementation Gap.” Transport Policy 53 (January): 135–45. https://doi.org/10.1016/j.tranpol.2016.09.006."
  },
  {
    "objectID": "6_cenarios_transporte.html",
    "href": "6_cenarios_transporte.html",
    "title": "\n6  Comparando a acessibilidade entre dois cenários de transporte\n",
    "section": "",
    "text": "Neste capítulo, nós vamos ilustrar como usar a metodologia ensinada nos capítulos anteriores para medir impacto de projetos de transporte sobre acessibilidade urbana. Como estudo de caso, vamos fazer uma avaliação do projeto de expansão da Linha Leste do metrô de Fortaleza (Figura 6.1). O traçado da Linha Leste possui 7.3 km de extensão e liga o Centro de Fortaleza ao bairro Papicu, permitindo a integração das linhas de metrô Sul e Oeste com corredores de Veículo Leve sobre Trilhos (VLT) e o terminal de ônibus no Papicu (Figura 6.2) No momento em que esse livro foi escrito, o metrô ainda estava em fase de construção. Portanto, estamos tratando de uma avaliação ex-ante em que avaliamos o futuro impacto que esta expansão de infraestrutura deverá ter sobre a acessibilidade urbana da cidade.\nFonte: Braga et al. (2022)\nFonte: Braga et al. (2022)\nÉ importante notar que, na prática, a implementação deste investimento também deverá envolver mudanças nas frequências das linhas de metrô Sul e Oeste, além do racionamento do sistema de ônibus municipais, conforme o Plano de Acessibilidade Sustentável de Fortaleza (Pasfor)1. Essas mudanças adicionais no sistema de transporte público não foram incorporadas aos nossos cenários. Portanto, o estudo de caso que apresentamos aqui considera um cenário simplificado que considera apenas a implementação da Linha Leste. Para uma avaliação mais completa do impacto de acessibilidade da implementação da Linha Leste e das mudanças previstas no Pasfor, por favor veja Braga et al. (2022).\nPara a avaliação de impacto da Linha Leste do metrô, nós precisaremos comparar os níveis de acessibilidade antes e depois da implementação do novo corredor. Precisamos, portanto, utilizar diferentes arquivos GTFS para representar os cenários antes e depois, e seguir os seguintes passos: 1. Calcular duas matrizes de tempo de viagem, uma antes e outra depois do investimento 2. Calcular dois cenários de acessibilidade, um antes e outro depois do investimento 3. Comparar esses as condições de acessibilidade nos cenários antes e depois, examinando como os impactos de acessibilidade se distribuem espacialmente e entre populações de diferentes níveis socioeconômicos.\nNeste capítulo, vamos cobrir este passo-a-passo em detalhes, começando primeiro pelo detalhamento dos dados de transporte público em formato GTFS que vamos usar."
  },
  {
    "objectID": "6_cenarios_transporte.html#dados-de-gtfs-usados-na-análise",
    "href": "6_cenarios_transporte.html#dados-de-gtfs-usados-na-análise",
    "title": "\n6  Comparando a acessibilidade entre dois cenários de transporte\n",
    "section": "\n6.1 Dados de GTFS usados na análise",
    "text": "6.1 Dados de GTFS usados na análise\nNesta análise, usaremos os arquivos GTFS disponibilizados pela Empresa de Transporte Urbano de Fortaleza (Etufor) e a Empresa do Metrô de Fortaleza (Metrofor). Esses dados descrevem o sistema de transporte público operante na cidade de Fortaleza em outubro de 2019. Como esses são arquivos grandes, somando quase 20 MB no total, eles não estão disponíveis dentro dos pacotes r5r e gtfstools, como nos exemplos que usamos até aqui no livro. Para baixar esses dados, nós usamos o código abaixo, que faz o download dos feeds de GTFS para arquivos temporários usando a função o pacote httr:\n\nlibrary(httr)\n\n# criar o endereço de arquivos temporários na máquina local\nmetrofor_path <- tempfile(\"metrofor\", fileext = \".zip\")\netufor_path <- tempfile(\"etufor\", fileext = \".zip\")\n\n# download dados da metrofor\nhttr::GET(\n  \"https://github.com/ipeaGIT/intro_access_book/releases/download/data_1st_edition/gtfs_for_metrofor_2021-01.zip\",\n  httr::write_disk(metrofor_path)\n)\n# download dados da etufor\nhttr::GET(\n  \"https://github.com/ipeaGIT/intro_access_book/releases/download/data_1st_edition/gtfs_for_etufor_2019-10.zip\",\n  httr::write_disk(etufor_path)\n)\n\nPara simularmos a operação da nova Linha Leste do metrô, precisamos também de um feed que descreva como deverá ser a operação deste corredor quando ele entrar em operação. Este feed deve conter algumas informações-chave, como por exemplo o traçado da futura linha de metrô, a localização de suas estações, a velocidade operacional do metrô e a frequência planejada dos serviços. No exemplo que vamos apresentar neste livro, nós vamos utilizar o GTFS do projeto da Linha Leste que foi criado anteriormente pelo Ipea para um estudo mais detalhado de avaliação do impacto de acessibilidade deste projeto (Braga et al. 2022). Assim como os feeds da ETUFOR e da METROFOR, este arquivo GTFS está disponível para download no repositório do livro no GitHub, e pode ser baixado com o código:\n\n# criar o endereço do arquivo temporário\nlinha_leste_path <- tempfile(\"linha_leste\", fileext = \".zip\")\n\n# download do GTFS da Linha Leste\nhttr::GET(\n  \"https://github.com/ipeaGIT/intro_access_book/releases/download/data_1st_edition/gtfs_linha_leste.zip\", \n  httr::write_disk(linha_leste_path)\n)\n\nEsses três arquivos GTFS serão usados em conjunto para calcular as condições de acessibilidade de Fortaleza em 2019 (antes da implementação do projeto do metrô) e para o cenário futuro quando a Linha Leste estiver funcionando. Para a análise de 2019, nós vamos calcular as matrizes de tempo de viagem com base apenas nos feeds da METROFOR e da ETUFOR de outubro de 2019, que representam a típica operação de transporte público da cidade antes da implementação do novo corredor. No cenário pós-implementação, incluiremos também o GTFS da Linha Leste, incorporando à análise a operação planejada desta linha após sua finalização."
  },
  {
    "objectID": "6_cenarios_transporte.html#cálculo-das-matrizes-de-tempo-de-viagem",
    "href": "6_cenarios_transporte.html#cálculo-das-matrizes-de-tempo-de-viagem",
    "title": "\n6  Comparando a acessibilidade entre dois cenários de transporte\n",
    "section": "\n6.2 Cálculo das matrizes de tempo de viagem",
    "text": "6.2 Cálculo das matrizes de tempo de viagem\nTendo definido quais dados de GTFS vamos usar em cada um dos cenários analisados do transporte público, o próximo passo é calcular as matrizes de tempo de viagem, que posteriormente serão utilizadas para estimar os níveis de acessibilidade. Para isso, nós vamos utilizar a função travel_time_matrix() do pacote r5r, como apresentado anteriormente na Section 3.1.\nAntes de calcular as matrizes de fato, nós precisamos organizar os nossos arquivos na estrutura que o r5r requer. Com o código abaixo, nós vamos criar uma pasta separada para cada um dos nossos cenários (antes e depois), e vamos salvar nessas pastas os arquivos de dados necessários para o roteamento. Primeiro, vamos criar uma pasta raíz chamada analysis_dir:\n\n# cria pasta raíz da análise de dados\nanalysis_dir <- \"impact_analysis\"\n\ndir.create(analysis_dir)\n\nDentro desta pasta raiz, vamos criar agora as pastas de roteamento dos cenários antes e depois (dir_before e dir_after), contendo seus respectivos feeds:\n\n# criando pasta dos cenários\ndir_before <- file.path(analysis_dir, \"before\")\ndir_after <- file.path(analysis_dir, \"after\")\n\ndir.create(dir_before)\ndir.create(dir_after)\n\n# copiando os arquivos de GTFS para as pastas dos cenários antes e depois\nfile.copy(from = metrofor_path, to = file.path(dir_before, \"metrofor.zip\"))\nfile.copy(from = metrofor_path, to = file.path(dir_after, \"metrofor.zip\"))\n\nfile.copy(from = etufor_path, to = file.path(dir_before, \"etufor.zip\"))\nfile.copy(from = etufor_path, to = file.path(dir_after, \"etufor.zip\"))\n\nfile.copy(from = linha_leste_path, to = file.path(dir_after, \"linha_leste.zip\"))\n\n# visualizando esquema de arquivos na pasta\nfs::dir_tree(analysis_dir)\n\n\n\n\n\n\nimpact_analysis\n├── after\n│   ├── etufor.zip\n│   ├── linha_leste.zip\n│   └── metrofor.zip\n└── before\n    ├── etufor.zip\n    └── metrofor.zip\n\n\n\n\n\nPara estimarmos o tempo de viagem na nossa área de estudo, nós precisamos também de um arquivo com os dados do OpenStreetMap representando a rede viária local em formato .pbf. E opcionalmente iremos utilizar também um arquivo representando a topografia local, em formato .tif. Esses arquivos, assim como os GTFS, estão disponíveis para download no repositório do livro. Partindo do pressuposto que a implementação da Linha Leste não afetaria o traçado das ruas e calçadas na região, bem como a topografia local, podemos usar os mesmos arquivos nas duas matrizes de tempo de viagem. No bloco de código seguinte, nós baixamos esses dados e copiamos esses arquivos para as pastas dos dois cenários de transporte.\n\n# cria endereço temporário dos arquivos na máquina local\npbf_path <- tempfile(\"street_network\", fileext = \".osm.pbf\")\ntif_path <- tempfile(\"topography\", fileext = \".tif\")\n\n# download dos dados de OSM\nhttr::GET(\n  \"https://github.com/ipeaGIT/intro_access_book/releases/download/data_1st_edition/for_2020.osm.pbf\",\n  httr::write_disk(pbf_path)\n)\n# download dos dados de topografia\nhttr::GET(\n  \"https://github.com/ipeaGIT/intro_access_book/releases/download/data_1st_edition/topografia3_for.tif\",\n  httr::write_disk(tif_path)\n)\n# copia arquivo para as pastas dos cenários antes e depois\nfile.copy(from = pbf_path, to = file.path(dir_before, \"street_network.osm.pbf\"))\nfile.copy(from = pbf_path, to = file.path(dir_after, \"street_network.osm.pbf\"))\n\nfile.copy(from = tif_path, to = file.path(dir_before, \"topography.tif\"))\nfile.copy(from = tif_path, to = file.path(dir_after, \"topography.tif\"))\n\n\n\n\n\n# visualizando esquema de arquivos na pasta\nfs::dir_tree(analysis_dir)\n\nimpact_analysis\n├── after\n│   ├── etufor.zip\n│   ├── linha_leste.zip\n│   ├── metrofor.zip\n│   ├── street_network.osm.pbf\n│   └── topography.tif\n└── before\n    ├── etufor.zip\n    ├── metrofor.zip\n    ├── street_network.osm.pbf\n    └── topography.tif\n\n\n\n\n\nAgora com os dados organizados nas pastas, podemos começar o cálculo das matrizes de tempo de viagem. A primeira etapa é construir a rede de transporte multimodal usada pelo r5r no roteamento, o que é feito com o comando setup_r5(). Essa rede de transporte multimodal é criada por esta função que combina os dados da malha de ruas, do sistema de transporte público e de topografia. Essa função também retorna uma conexão com o R5 que aqui nós chamamos de r5r_core_. No exemplo abaixo, nós vamos criar duas redes, uma para cada cenário:\n\n# aloca memória disponível para Java\noptions(java.parameters = \"-Xmx2G\")\n\n# carrega biblioteca\nlibrary(r5r)\n\n# cria rede de transporte multimodal de cada cenário\nr5r_core_before <- setup_r5(dir_before, use_elevation = FALSE, verbose = FALSE)\nr5r_core_after <- setup_r5(dir_after, use_elevation = FALSE, verbose = FALSE)\n\nCom as redes de transporte criadas para cada cenário, prosseguimos agora para o cálculo das matrizes de tempo de viagem. Nesta etapa nós vamos utilizar como origens e destinos os centróides de uma grade espacial de hexágonos de Fortaleza disponibilizada pelo pacote aopdata (mais detalhes sobre o pacote são apresentados na Seção 5). Na grade espacial utilizada, cada hexágono tem uma área de aproximadamente 0.10 Km2, o que permite uma análise espacial bem detalhada.\nPara comparar os dois cenários, nós vamos calcular quanto tempo uma pessoa demoraria para viajar partindo de cada origem para todos os destinos considerando os mesmos parâmetros de viagem. Aqui, nós vamos considerar viagens a pé ou por transporte público, considerar que as pessoas iriam caminhar no máximo até 800 metros nas pernas de acesso e egresso das paradas de transporte público, e limitar o tempo máximo de viagem em até 60 minutos. Vamos considerar o horário de partida de 07:00 em uma típica segunda-feira de operação:\n\n# carrega bibliotecas\nlibrary(data.table)\nlibrary(aopdata)\nlibrary(sf)\n\n# leitura dos dados da grade espacial\nfor_grid <- read_grid(city = \"Fortaleza\", showProgress = FALSE)\n\n# geração dos centroids das células espaciais\npoints <- st_centroid(for_grid)\n\n# renomeia o nome da coluna com id das células\nnames(points)[1] <- 'id'\n\n# calcula matriz de tempo de viagem do cenário 'antes'\nttm_before <- travel_time_matrix(\n  r5r_core_before,\n  origins = points,\n  destinations = points,\n  mode = c(\"WALK\", \"TRANSIT\"),\n  departure_datetime = as.POSIXct(\n    \"02-03-2020 07:00:00\",\n    format = \"%d-%m-%Y %H:%M:%S\"\n  ),\n  max_walk_dist = 800,\n  max_trip_duration = 60,\n  verbose = FALSE,\n  progress = FALSE\n)\n\n# calcula matriz de tempo de viagem do cenário 'depois'\nttm_after <- travel_time_matrix(\n  r5r_core_after,\n  origins = points,\n  destinations = points,\n  mode = c(\"WALK\", \"TRANSIT\"),\n  departure_datetime = as.POSIXct(\n    \"02-03-2020 07:00:00\",\n    format = \"%d-%m-%Y %H:%M:%S\"\n  ),\n  max_walk_dist = 800,\n  max_trip_duration = 60,\n  verbose = FALSE,\n  progress = FALSE\n)\n\nhead(ttm_before)\n\n            fromId            toId travel_time\n1: 89801040323ffff 89801040323ffff           2\n2: 89801040323ffff 89801040327ffff          22\n3: 89801040323ffff 8980104032fffff          14\n4: 89801040323ffff 89801040333ffff           9\n5: 89801040323ffff 89801040337ffff          30\n6: 89801040323ffff 8980104036fffff          25\n\nhead(ttm_after)\n\n            fromId            toId travel_time\n1: 89801040323ffff 89801040323ffff           2\n2: 89801040323ffff 89801040327ffff          22\n3: 89801040323ffff 8980104032fffff          14\n4: 89801040323ffff 89801040333ffff           9\n5: 89801040323ffff 89801040337ffff          30\n6: 89801040323ffff 8980104036fffff          25\n\n\n\n\n\nÀ primeira vista, nossas matrizes parecem iguais: todos os tempos de viagem na amostra de pares mostrados acima são idênticos. Isto ocorre porque o projeto de expansão do metrô fica restrito à uma área relativamente pequena no centro da cidade de Fortaleza. Assim, muitos deslocamentos entre regiões da cidade de fato não devem ser afetados pela implementação da nova linha de metrô. Para diversos pares de origem-destino, no entanto, vemos que os tempos de viagens entre eles deverão ser impactados pela Linha Leste:\n\n# merge dos tempos de viagem dos dois cenários\ncomparison <- merge(\n  ttm_before,\n  ttm_after,\n  by = c(\"fromId\", \"toId\"),\n  suffixes = c(\"_before\", \"_after\")\n)\n\n# mostrar apenas os pares OD que deverão ter queda nos tempos de viagem\ncomparison[travel_time_after < travel_time_before]\n\n               fromId            toId travel_time_before travel_time_after\n   1: 89801041b2fffff 8980104c14bffff                 55                54\n   2: 89801041b2fffff 8980104c15bffff                 55                53\n   3: 89801041b2fffff 8980104c397ffff                 52                48\n   4: 8980104532bffff 8980104c13bffff                 57                53\n   5: 89801045363ffff 8980104c13bffff                 57                53\n  ---                                                                     \n8673: 8980107b6dbffff 8980104c02fffff                 56                52\n8674: 8980107b6dbffff 8980104c13bffff                 45                42\n8675: 8980107b6dbffff 8980104c14bffff                 57                54\n8676: 8980107b6dbffff 8980104c15bffff                 56                53\n8677: 8980107b6dbffff 8980104c397ffff                 58                48"
  },
  {
    "objectID": "6_cenarios_transporte.html#cálculo-da-acessibilidade-nos-cenários-antes-e-depois",
    "href": "6_cenarios_transporte.html#cálculo-da-acessibilidade-nos-cenários-antes-e-depois",
    "title": "\n6  Comparando a acessibilidade entre dois cenários de transporte\n",
    "section": "\n6.3 Cálculo da acessibilidade nos cenários antes e depois",
    "text": "6.3 Cálculo da acessibilidade nos cenários antes e depois\nO cálculo da acessibilidade é muito simples, e requer apenas um processamento básico dos nossos dados e a aplicação de uma das funções que calcula indicadores de acessibilidade do pacote accessibility. Para facilitar o tratamento dos dados, nós vamos empilhar as matrizes de tempo de viagem dos dois cenários em uma única tabela, identificando cada cenário com a coluna scenario:\n\nrm(comparison); gc()\n\n           used (Mb) gc trigger  (Mb) max used  (Mb)\nNcells  1157430 61.9    2127613 113.7  1739678  93.0\nVcells 10721083 81.8   24119885 184.1 22743381 173.6\n\n# empilhando matrizes de tempo de viagem antes e depois\nttm <- rbind(ttm_before, ttm_after, idcol = \"scenario\")\nttm[, scenario := factor(scenario, labels = c(\"antes\", \"depois\"))]\n\nttm\n\n         scenario          fromId            toId travel_time\n      1:    antes 89801040323ffff 89801040323ffff           2\n      2:    antes 89801040323ffff 89801040327ffff          22\n      3:    antes 89801040323ffff 8980104032fffff          14\n      4:    antes 89801040323ffff 89801040333ffff           9\n      5:    antes 89801040323ffff 89801040337ffff          30\n     ---                                                     \n3406972:   depois 8980107b6dbffff 8980107b6cbffff           8\n3406973:   depois 8980107b6dbffff 8980107b6cfffff          14\n3406974:   depois 8980107b6dbffff 8980107b6d3ffff           8\n3406975:   depois 8980107b6dbffff 8980107b6d7ffff          15\n3406976:   depois 8980107b6dbffff 8980107b6dbffff           0\n\n\n\n# deletando objetos para liberar memória RAM\nrm(ttm_before, ttm_after)\ngc()\n\n           used (Mb) gc trigger  (Mb) max used  (Mb)\nNcells  1157665 61.9    2127613 113.7  1739678  93.0\nVcells 12425012 94.8   33641852 256.7 33641852 256.7\n\n\nPara o cálculo da acessibilidade, vamos precisar de uma tabela com os dados de uso do solo da cidade de Fortaleza. Para isso, nós usamos a função read_landuse() do pacote aopdata, que traz a informação com a quantidade de população, e oportunidades de empregos e escolas em cada hexágono da cidade.\n\n# download dados de uso do solo\nfor_data <- read_landuse(city = \"Fortaleza\", showProgress = FALSE)\n\nPara fins de demonstração, vamos calcular a acessibilidade a postos de trabalho e a escolas públicas de ensino médio na nossa área de estudo. Os dados do total de empregos e escolas em cada hexágono estão listados nas colunas T001 e E004, respectivamente. Vamos renomeá-las para facilitar sua identificação e manter apenas as colunas necessárias na tabela de dados de uso do solo. Também vamos manter também as colunas P001, de população total em cada hexágono, e R003, do decil de renda em que cada hexágono se encontra, que serão úteis mais à frente:\n\n# nome das colunas a serem mantidas\ncols_to_keep <- c(\"id\", \"jobs\", \"schools\", \"population\", \"decile\")\n\n# renomeando colunas\nsetnames(\n  for_data,\n  old = c(\"id_hex\", \"T001\", \"E004\", \"P001\", \"R003\"),\n  new = cols_to_keep\n)\n\n# deletando demais colunas que não vamos usar\nfor_data[, setdiff(names(for_data), cols_to_keep) := NULL]\n\nfor_data\n\n                   id population decile jobs schools\n   1: 89801040323ffff         30      1    0       0\n   2: 89801040327ffff        318      1    7       0\n   3: 8980104032bffff          0     NA    0       0\n   4: 8980104032fffff        103      1   98       0\n   5: 89801040333ffff         43      1    0       0\n  ---                                               \n2558: 8980107b6cbffff       2575      4  124       0\n2559: 8980107b6cfffff       2997      3    4       0\n2560: 8980107b6d3ffff       1751      8   14       0\n2561: 8980107b6d7ffff       2032      4  134       0\n2562: 8980107b6dbffff       1896      9  193       0\n\n\nUma decisão-chave no cálculo de acessibilidade é a escolha da medida a ser utilizada. É extremamente importante pesar as vantagens e desvantagens de cada medida e compreender quais indicadores se adequam às oportunidades para quais se deseja calcular os níveis de acessibilidade. Neste exemplo, utilizaremos duas medidas distintas:\n\nNo cálculo da acessibilidade a empregos, vamos usar a medida de oportunidades cumulativas. Esta métrica nos permite entender quantos empregos são acessíveis dentro de um determinado custo de viagem, representando, desta forma, a oferta de empregos aos habitantes de cada uma das células de nossa grade. Embora essa medida não leve em consideração a competição por empregos, sua principal vantagem é que ela é de muito simples comunicação e interpretação. Em nosso exemplo, vamos tomar como limite de custo um tempo de viagem de 60 minutos, que é muito próximo do tempo médio de deslocamento casa-trabalho por transporte público de Fortaleza em 2019 (cerca de 58 minutos), conforme o Pasfor2.\n\n\nNo cálculo da acessibilidade a escolas públicas, vamos usar a medida de custo mínimo de viagem. Esta métrica é especialmente útil para avaliar a cobertura de serviços públicos essenciais, como educação e saúde básica. Ela também traz informações que permitem a gente identificar qual parcela da população de uma cidade está a uma distância maior do que seria razoável para acessar esses serviços essenciais.\n\nComo mostrado anteriormente, na Section 3.2, o cálculo dessas medidas pode ser feito com as funções cumulative_cutoff() e cost_to_closest(), respectivamente, do pacote accessibility:\n\n# carrega biblioteca\nlibrary(accessibility)\n\n# renomeia colunas\nsetnames(ttm, old = c(\"fromId\", \"toId\"), new = c(\"from_id\", \"to_id\"))\n\n# calcula medida de oportunidades cumulativas\naccess_to_jobs <- cumulative_cutoff(\n  travel_matrix = ttm,\n  land_use_data = for_data,\n  opportunity = \"jobs\",\n  travel_cost = \"travel_time\",\n  cutoff = 60,\n  group_by = \"scenario\"\n)\naccess_to_jobs\n\n                   id scenario   jobs\n   1: 89801040323ffff    antes  46159\n   2: 89801040327ffff    antes  25499\n   3: 8980104032bffff    antes    118\n   4: 8980104032fffff    antes  66513\n   5: 89801040333ffff    antes  46159\n  ---                                \n5120: 8980107b6cbffff   depois 366197\n5121: 8980107b6cfffff   depois 256888\n5122: 8980107b6d3ffff   depois 332209\n5123: 8980107b6d7ffff   depois 338965\n5124: 8980107b6dbffff   depois 367061\n\n# calcula medida de tempo mínimo de viagem\ntime_to_schools <- cost_to_closest(\n  travel_matrix = ttm,\n  land_use_data = for_data,\n  opportunity = \"schools\",\n  travel_cost = \"travel_time\",\n  group_by = \"scenario\"\n)\ntime_to_schools\n\n                   id scenario travel_time\n   1: 89801040323ffff    antes          36\n   2: 89801040323ffff   depois          36\n   3: 89801040327ffff    antes          41\n   4: 89801040327ffff   depois          41\n   5: 8980104032bffff    antes         Inf\n  ---                                     \n5120: 8980107b6d3ffff   depois          18\n5121: 8980107b6d7ffff    antes          14\n5122: 8980107b6d7ffff   depois          14\n5123: 8980107b6dbffff    antes          15\n5124: 8980107b6dbffff   depois          15\n\n\nComo podemos ver, o resultado da função de custo mínimo de viagem inclui alguns valores Inf. As origens listadas com este valor não conseguem alcançar nenhuma escola pública dentro de 60 minutos (limite de tempo de viagem imposto no cálculo da matriz). O valor Inf, portanto, é utilizado para sinalizar esta condição. Para fins de simplicidade, vamos considerar que essas regiões estão a 80 minutos de viagem de uma escola. Assim, nós podemos calcular a diferença de acessibilidade entre os cenários antes e depois da seguinte maneira:\n\n# imputa tempo de viagem de 80 min. para valores Inf\ntime_to_schools[, travel_time := ifelse( is.infinite(travel_time), 80, travel_time)]\n\n# calcula diferença de acessibilidade entre cenários\naccess_to_jobs[, diff := shift(jobs, type = \"lead\") - jobs, by = id]\ntime_to_schools[, diff := shift(travel_time, type = \"lead\") - travel_time, by = id]"
  },
  {
    "objectID": "6_cenarios_transporte.html#análise-dos-níveis-de-acessibilidade-antes-e-depois",
    "href": "6_cenarios_transporte.html#análise-dos-níveis-de-acessibilidade-antes-e-depois",
    "title": "\n6  Comparando a acessibilidade entre dois cenários de transporte\n",
    "section": "\n6.4 Análise dos níveis de acessibilidade antes e depois",
    "text": "6.4 Análise dos níveis de acessibilidade antes e depois\nAgora que calculamos os níveis de acessibilidade em cada cenário, precisamos compreender como a futura implementação da Linha Leste do Metrô deverá impactar as condições de acessibilidade em nossa área de estudo. Uma primeira maneira de captar isso é o impacto que expansão deverá ter na acessibilidade média da cidade. Para isso, nós calculamos a quantidade média de empregos acessíveis em cada cenário. Aqui é importante calcular a média de acessibilidade ponderada pela população de cada hexágono.\nOs resultados abaixo mostram que, em 2019, a população de Fortaleza conseguia acessar em média 240.663 empregos em até 60 minutos de transporte público. A implementação da nova Linha Leste do metrô deverá aumentar esse valor em 1%, para 243.023 empregos acessíveis em média.\n\n# carrega biblioteca de visualização de dados\nlibrary(ggplot2)\nlibrary(patchwork)\n\n# recupera info da populacao residente e renda nos hexágonos\naccess_to_jobs[for_data, on = 'id', c('population', 'decile') := list(i.population, i.decile)]\n\n# calcula média ponderada de acessibilidade antes e depois\nresultado_medio <- access_to_jobs[population > 0, \n                                  .(avg_access  = weighted.mean(x=jobs, w = as.numeric(population), na.rm=T)), \n                                  by=scenario]\n\nresultado_medio\n\n   scenario avg_access\n1:    antes   243898.4\n2:   depois   246328.2\n\n# figura\nggplot(data = resultado_medio, aes(x = scenario, y = avg_access/1000)) + \n  geom_col(fill='#0f3c53') +\n  geom_text(aes(label = round(avg_access/1000, 2)), vjust = -0.5) +\n  ylab(\"Empregos acessíveis\\n(em milhares)\") +\n  theme_minimal()\n\n\n\n\nAnalisando-se o tempo de acesso à escola pública de ensino médio mais próxima, nota-se que a Linha Leste deverá ter um resultado quase nulo na média de acessibilidade a essas escolas. Em média, a população de Fortaleza demorava em 2019 cerca de 13 minutos para chegar até a escola pública de ensino médio mais próxima de casa. Após a conclusão da extensão do metrô, esse resultado permance praticamente inalterado.\n\n# recupera info da populacao residente nos hexágonos\ntime_to_schools[for_data, on = 'id', population := i.population]\n\n# calcula média ponderada de acessibilidade antes e depois\nresultado_medio <- time_to_schools[population > 0, \n                                  .(avg_access  = weighted.mean(x=travel_time, w = as.numeric(population), na.rm=T)), \n                                  by=scenario]\n\nresultado_medio\n\n   scenario avg_access\n1:    antes   12.66587\n2:   depois   12.65692\n\n# figura\nggplot(data = resultado_medio, aes(x = scenario, y = avg_access)) + \n  geom_col(fill='#0d6556') +\n  geom_text(aes(label = round(avg_access, 2)), vjust = -0.5) +\n  ylab(\"Média do tempo até a escola\\nmais próxima(em minutos)\") +\n  theme_minimal()\n\n\n\n\nEm síntese, os resultados mostram que o projeto de construção da Linha Leste do Metrô tem baixo impacto na acessibilidade média da população. Esse resultado ocorre em grande medida por duas razões. A primeira delas é porque, neste estudo de caso, estamos fazendo uma análise simplificada que considera apenas a construção do projeto da Linha Leste do metrô, e ignora as demais intervenções que deverão acompanhar esta intervenção, como o aumento de frequência das demais linhas de metrô e trens na cidade. A segunda razão de encontrarmos impactos tão baixos é o fato de que a proposta da Linha Leste consiste numa extensão de trecho relativamente pequeno da rede de transporte. Soma-se a isso o fato de que este projeto é localizado próximo ao centro da cidade, que já era a região de mais alta acessibilidade da cidade em 2019.\nEmbora tenhamos visto que o projeto deverá ter pequeno impacto na acessibilidade média de toda a cidade, é importante entendermos como esse impacto de acessibilidade varia espacialmente. Para isso, vamos juntar nossas tabelas de estimativas de acessibilidade com a grade espacial da nossa área de estudo, disponível no objeto for_grid baixado do pacote aopdata anteriormente.\n\n# traz info espacial para tabelas de acessibilidade\nsetDT(for_grid)\naccess_to_jobs[for_grid, on = c(id = \"id_hex\"), geom := i.geom]\ntime_to_schools[for_grid, on = c(id = \"id_hex\"), geom := i.geom]\n\n# converte tabela em objeto espacial\naccess_to_jobs_sf <- st_sf(access_to_jobs)\ntime_to_schools_sf <- st_sf(time_to_schools)\n\nFeito isso, o código abaixo mostra nos mapas a distribuição espacial dos níveis de acessibilidade nos dois cenários (antes e depois) e a diferênça de acessibilidade entre os dois cenários.\nOs ganhos de acessibilidade ao emprego se concentram principalmente próximos às estações do novo corredor e dos corredores já existentes que se ligam a ele. Isto mostra como a implantação de uma infraestrutura de transporte pode impactar não apenas suas imediações, mas também locais mais afastados, graças à conectividade da rede.\n\n# mapas dos cenários antes-e-depois\ntemp1 <- ggplot(access_to_jobs_sf) +\n         geom_sf(aes(fill = jobs), color = NA) +\n         facet_wrap(~ scenario, nrow = 1) +\n         scale_fill_viridis_c(\n           option = \"inferno\",\n           label = scales::label_number(scale = 1/1000)\n           ) + \n         labs(fill='Empregos\\nacessíveis\\n(em milhares)') +\n         theme_void()\n\n# mapa da diferença\ntemp2 <- ggplot(subset(access_to_jobs_sf, diff >=0)) +\n         geom_sf(aes(fill = diff), color = NA) +\n         scale_fill_viridis_c(\n           option = \"cividis\",\n           label = scales::label_number(scale = 1/1000)\n         ) + \n         labs(fill='Diferença de\\nempregos\\nacessíveis\\n(em milhares)') +\n         theme_void()\n# plot\ntemp1 /temp2 + plot_layout(ncol=1,heights=c(1,1))\n\n\n\n\nPor sua vez, o mapa de diferença no tempo de acesso a escolas (abaixo) apresenta um cenário diferente: praticamente nenhuma região da cidade apresenta melhorias no tempo de acesso. Diferentemente da distribuição de empregos, que tende a seguir critérios econômicos, a distribuição de equipamentos públicos como escolas tende a ser planejada usando critérios de equidade, sendo, portanto, mais equilibrada no território. Isso explica em boa parte porque observamos maiores níveis de acessibilidade em quase todas regiões da cidade. Isso também explica porque a construção da Linha Leste na parte central da cidade em nada afeta o tempo de acesso das pessoas que moram em locais afastados desse corredor. Não apenas isso, mas mesmo para as pessoas que moram perto do novo corredor a sua implementação não muda os níveis de acesso a escolas. Isto é um sinal que esta área já possuia uma boa oferta de escolas e era bem servida de transporte público, mesmo antes da finalização da Linha Leste.\n\n# mapas dos cenários antes-e-depois\ntemp1 <- ggplot(time_to_schools_sf) +\n         geom_sf(aes(fill = travel_time), color = NA) +\n         facet_wrap(~ scenario, nrow = 1) +\n         scale_fill_viridis_c(\n           option = \"viridis\", direction = -1) + \n         labs(fill='Tempo até\\n a escola\\nmaispróxima\\n(em minutos)') +\n         theme_void()\n\n# mapa da diferença\ntemp2 <- ggplot(subset(time_to_schools_sf, diff <=0)) +\n         geom_sf(aes(fill = diff), color = NA) +\n         scale_fill_viridis_c(\n           option = \"viridis\", direction = -1) + \n        labs(fill='Diferença no\\ntempo até\\n a escola\\nmaispróxima\\n(em minutos)') +\n        theme_void()\n\n# plot\ntemp1 /temp2 + plot_layout(ncol=1,heights=c(1,1))"
  },
  {
    "objectID": "6_cenarios_transporte.html#desigualdade-de-acessibilidade",
    "href": "6_cenarios_transporte.html#desigualdade-de-acessibilidade",
    "title": "\n6  Comparando a acessibilidade entre dois cenários de transporte\n",
    "section": "\n6.5 Desigualdade de acessibilidade",
    "text": "6.5 Desigualdade de acessibilidade\nUma dimensão-chave para avaliação de projetos de transporte é o seu aspecto distributivo. Quem se beneficia dessas políticas? Sob uma perspectiva de equidade, se espera que políticas governamentais deveriam priorizar melhorar as condições de acessibilidade das pessoas em piores condições socioeconômicas e que mais dependem do transporte público (Pereira, Schwanen, and Banister 2017; van Wee 2022).\nAqui nós vamos examinar como os ganhos de acessibilidade esperados da expansão do metrô de Fortaleza se distribuem entre pessoas de diferentes níveis de renda. Para isso, nós precisamos examinar como o nível de acesso a empregos se distribuía entre a população antes da construção da Linha Leste, e como essa distribuição deve ser alterada após a expansão da linha do metrô. O gráfico de box plot abaixo nos permite visualizar como é a distribuição de níveis de acessibilidade entre grupos socioeconômicos nos dois cenários da nossa análise, antes e após a construção da Linha Leste.\n\n# distribuição de acessibilidade por renda antes-e-depois\nggplot(data = access_to_jobs[population > 0]) +\n  geom_boxplot(aes(x=as.factor(decile), y=jobs/1000, color=as.factor(decile),\n                   weight = population, group = decile), show.legend = FALSE) +\n  facet_wrap(~ scenario, nrow = 1) +\n  scale_colour_brewer(palette = 'RdBu') +\n  labs(x='Decil de renda', y='Empregos acessíveis\\n(em milhares)') +\n  scale_x_discrete(labels = c(\"D1 mais\\nPobres\", paste0(\"D\", 2:9), \"D10 mais\\nRicos\")) +\n  theme_minimal()\n\n\n\n\nOs dois gráficos mostram claramente que em Fortaleza as pessoas mais ricas possuem maior acesso a empregos. Em Fortaleza, assim como na maior parte das grandes cidades brasileiras, os mais ricos tendem a morar próximos às grandes concentrações de emprego e próximos ao centro da cidade, enquanto os mais pobres tendem a ocupar regiões periféricas (Pereira et al. 2022). Consequentemente, os mais ricos costumam ter melhores condições de acessibilidade urbana do que os mais pobres - não apenas porque moram mais perto dos empregos, mas porque também, geralmente, moram em regiões centrais mais bem servidas de transporte público do que as periferias.\nAssim como no caso da distribuição espacial da acessibilidade, é difícil enxergar nesses box plots acima como as condições de acessibilidade mudaram entre os cenários antes e depois. Lançando mão do mesmo recurso que fizemos anteriormente, podemos enxergar na próxima figura como os ganhos de acessibilidade entre os cenários se distribuem por decil de renda:\n\n# diferença entre cenários\nggplot(data = access_to_jobs[population > 0 & !is.na(diff)] ) +\n  geom_boxplot(aes(x=as.factor(decile), y=diff, color=as.factor(decile),\n                   weight = population, group = decile), show.legend = FALSE) +\n  scale_colour_brewer(palette = 'RdBu') +\n  labs(x='Decil de renda', y='Quantidade a mais de\\nempregos acessíveis (em milhares)',\n       color = 'Decil de\\n renda') +\n  scale_x_discrete(labels = c(\"D1 mais\\nPobres\", paste0(\"D\", 2:9), \"D10 mais\\nRicos\")) +\n  theme_minimal()\n\n\n\n\nComo podemos ver, os ganhos de acessibilidade foram mais ou menos iguais para a população acima do terceiro decil de renda. Também é possível observar ganhos ligeiramente maiores entre as camadas médias da população, em especial os decis 5, 6 e 7. No entanto, o hexágono que mostrou maior aumento de acessibilidade aparece como outlier do 10º decil, apresentando um ganho de mais de 60.000 empregos em relação ao cenário pré-implementação.\nUma maneira simples de medir o impacto do projeto de transporte sobre a desigualdade de acessibilidade é utilizar uma medida sintética de desigualdade. Esse tipo de medida busca resumir a distribuição dos níveis de acessibilidade entre grupos populacionais (aqui, decis de renda) em um único indicador que facilite a comunicação dos resultados e que possa ser usado, por exemplo, na elaboração de planos e metas. As medidas de desigualdade mais frequentemente utilizadas na literatura de acessibilidade são a Razão de Palma e o Índice de Gini (Lucas, van Wee, and Maat 2016; Guzman and Oviedo 2018; Pritchard et al. 2019).\nNeste exemplo, vamos calcular a Razão de Palma dos cenários antes e depois. Esta medida é o resultado da divisão da acessibilidade média dos 10% mais ricos pela acessibilidade média dos 40% mais pobres:\n\\[P = \\frac{\\overline{A_{tp10}}}{\\overline{A_{bt40}}}\\]\nem que \\(P\\) é a Razão de Palma, \\(\\overline{A_{tp10}}\\) é a acessibilidade média dos 10% mais ricos e \\(\\overline{A_{bt40}}\\) é a acessibilidade média dos 40% mais pobres.\n\n\n\n\n\n\nVantagens da Razão de Palma\n\n\n\n\n\nUma das vantagens da Razão de Palma frente ao Índice de Gini é a sua facilidade de comunicação e interpretação. Valores maiores do que 1 indicam um cenário em que os ricos possuem níveis médios de acessibilidade maior do que os pobres, e valores menores do que 1 a situação inversa. Outra vantagem da Razão de Palma é que ela reflete claramente como a desigualdade varia entre dois grupos de especial interesse para nós: os mais privilegiados e os mais vulneráveis de uma população. O Índice de Gini, por sua vez, estima o quanto uma distribuição desvia de uma distribuição hipotética em que todos possuem o mesmo nível de acesso, mas nada diz sobre as condições socioeconômicas daqueles que detêm os maiores e menores níveis de acessibilidade. Se uma determinada política aumenta os níveis de acessibilidades de pessoas de alta renda que moram em locais de baixa acessibilidade, por exemplo, o Índice de Gini indicaria que houve uma diminuição da desigualdade, mesmo que nenhuma população vulnerável tenha se beneficiado dessa política. Dificilmente uma política como essa poderia ser considerada equitativa.\n\n\n\nAo calcularmos a Razão de Palma nos cenários antes e depois da implementação do projeto de transporte, nós conseguimos entender qual o impacto da Linha Leste na desigualdade de acesso a empregos em Fortaleza:\n\n# calcula acessibilidade média dos mais ricos nos cenários antes-e-depois\nrichest_access <- access_to_jobs[\n  decile == 10,\n  .(access = weighted.mean(jobs, w = population)),\n  by = scenario\n]\n\n# calcula acessibilidade média dos mais pobres nos cenários antes-e-depois\npoorest_access <- access_to_jobs[\n  decile %in% 1:4,\n  .(access = weighted.mean(jobs, w = as.numeric(population))),\n  by = scenario\n]\n\n# combina acessibilidade dos ricos e pobres\npalma_ratio <- merge(\n  richest_access,\n  poorest_access,\n  by = \"scenario\",\n  suffixes = c(\"_richest\", \"_poorest\")\n)\n\n# calculando Razão de Palma\npalma_ratio[, palma := access_richest / access_poorest]\n\n# figura\nggplot(data = palma_ratio, aes(x = scenario, y = palma)) + \n  geom_col(fill='#0d6556') +\n  geom_text(aes(label = round(palma, 2)), vjust = -0.5) +\n  ylab(\"Razão de Palma\") +\n  theme_minimal()\n\n\n\n\nA figura acima aponta que, no ano de 2019, a população mais rica de Fortaleza conseguia acessar em média 2.19 vezes mais empregos do que a população mais pobre utilizando-se o transporte público em até 60 minutos de viagem. O gráfico também mostra que essa desigualdade medida pela Razão de Palma sofreu apenas uma pequena queda entre os cenários pré e pós implementação da Linha Leste. Ou seja, podemos concluir que, neste nosso cenário simplificado de avaliação da Linha Leste, a expansão do metrô de Fortaleza seria uma política apenas ligeiramente progressiva. Em outras palavras, o futuro impacto desse projeto deverá dar uma pequena contribuição para redução da desigualdade de acesso a oportunidades.\n\n\n\n\n\n\nÉ importante lembrar que esta avaliação apresentada aqui é uma versão simplificada para fins didáticos. Para uma avaliação mais completa da Linha Leste do metrô de Fortaleza, que também considera ajustes nas frequências de outros corredores e mudanças nas linhas de ônibus da cidade, veja o trabalho de Braga et al. (2022).\n\n\n\nNeste capítulo nós focamos na avaliação de impacto de projetos de transporte sobre as condições de acessibilidade da população. Vale ressaltar, no entanto, que uma avaliação completa de políticas públicas deve abranger considerar também outros critérios como participação social na formulação da política e seus impactos considerando dimensões ambientais, econômicas, sociais, entre outras. Embora uma avaliação de impacto de acessibilidade seja muito importante para a caracterização dos potenciais benefícios e desempenho de redes de transporte como um todo, ela é apenas uma dessas dimensões, e deve complementar ou ser complementada por outras análises.\n\n\n\n\nBraga, Carlos Kaue Vieira, Diego Bogado Tomasiello, Daniel Herszenhut, João Lucas Albuquerque Oliveira, and Rafael Henrique Moraes Pereira. 2022. “Impactos da expansão do metrô de Fortaleza sobre o acesso a oportunidades de emprego, saúde e educação.” http://www.ipea.gov.br, May.\n\n\nGuzman, Luis A., and Daniel Oviedo. 2018. “Accessibility, Affordability and Equity: Assessing ‘Pro-Poor’ Public Transport Subsidies in Bogotá.” Transport Policy 68 (September): 37–51. https://doi.org/10.1016/j.tranpol.2018.04.012.\n\n\nLucas, Karen, Bert van Wee, and Kees Maat. 2016. “A Method to Evaluate Equitable Accessibility: Combining Ethical Theories and Accessibility-Based Approaches.” Transportation 43 (3): 473–90. https://doi.org/10.1007/s11116-015-9585-2.\n\n\nPereira, Rafael H. M., Carlos Kauê Vieira Braga, Daniel Herszenhut, Marcus Saraiva, and Diego Bogado Tomasiello. 2022. “Estimativas de acessibilidade a empregos e serviços públicos via transporte ativo, público e privado nas 20 maiores cidades do Brasil em 2017, 2018, 2019.” Texto para Discussão IPEA 2800.\n\n\nPereira, Rafael H. M., Tim Schwanen, and David Banister. 2017. “Distributive Justice and Equity in Transportation.” Transport Reviews 37 (2): 170–91. https://doi.org/10.1080/01441647.2016.1257660.\n\n\nPritchard, John P., Diego Tomasiello, Mariana Giannotti, and Karst Geurs. 2019. “An International Comparison of Equity in Accessibility to Jobs: London, São Paulo and the Randstad.” Findings, February. https://doi.org/10.32866/7412.\n\n\nvan Wee, Bert. 2022. “Accessibility and Equity: A Conceptual Framework and Research Agenda.” Journal of Transport Geography 104 (October): 103421. https://doi.org/10.1016/j.jtrangeo.2022.103421."
  },
  {
    "objectID": "s5_dados_aop.html",
    "href": "s5_dados_aop.html",
    "title": "SEÇÃO 5: Dados do Projeto AOP",
    "section": "",
    "text": "Objetivo: O objetivo deste capítulo é mostrar como fazer download e analisar os dados do projeto Acesso a Oportunidades (AOP) utilizando o pacote aopdata no R.\nNos capítulos anteriores você aprendeu como calcular indicadores de acessibilidade. No entanto, em muitos casos, você não tem disponibilidade para calcular esses indicadores por conta própria e tudo o que você quer é analisar os resultados que já foram calculados por alguém.\nO projeto Acesso a Oportunidades disponibiliza uma extensa base de dados com informações sobre a distribuição da população, atividades econômicas e serviços públicos, além de várias estimativas de acessibilidade urbana para diversos tipos de atividades. Essas estimativas de acessibilidade estão disponíveis para diferentes modos de transporte (caminhada, bicicleta, transporte público e automóvel), horários do dia (pico e fora-pico), grupos populacionais (segundo níveis de renda, cor, sexo e idade) e para diferentes atividades (empregos, escolas, serviços de saúde e centros de assistência social). Nesta versão, a base de dados traz essas informações para diversos anos (2017, 2018 e 2019), se apoiando em uma única metodologia consistente para as 20 maiores cidades do Brasil. Veja abaixo Tabela 1 e Tabela 2."
  },
  {
    "objectID": "s5_dados_aop.html#quais-dados-estão-disponíveis",
    "href": "s5_dados_aop.html#quais-dados-estão-disponíveis",
    "title": "SEÇÃO 5: Dados do Projeto AOP",
    "section": "Quais dados estão disponíveis?",
    "text": "Quais dados estão disponíveis?\nEscopo dos dados\n\n\n\n\nFigura 1: Escopo dos dados do AOP\n\n\n\n\n\n\n\n\nFigura 2: Escopo geográfico dos dados do AOP\n\n\n\n\nDados de população, empregos e serviços públicos\n\n\n\n\nTabela 1: Informações socioeconômicas da população e de distribuição espacial de atividades, segundo ano e fonte de dados\n\n\n\n\n\n\n\nDado\nInformações\nAnos\nFonte\n\n\n\nCaracterísticas sociodemográficas da população\nQuantidade de pessoas segundo sexo, faixa de idade e cor/raça; média da renda domiciliar per capita\n2010\nCenso Demográfico, IBGE\n\n\nEstabelecimentos de educação\nQuantidade de creches e escolas públicas segundo nível infantil, fundamental e médio\n2017, 2018, 2019\nCenso Escolar, Inep\n\n\nEstabelecimentos de saúde\nQuantidade de estabelecimentos de saúde que atendem pelo SUS segundo nível de atenção baixa, média e alta complexidade\n2017, 2018, 2019\nCadastro Nacional de Estabelecimentos de Saúde (CNES), Ministério da Saúde\n\n\nAtividade econômica\nQuantidade de empregos formais conforme o nível de instrução dos trabalhadores baixa, média e alta escolaridade\n2017, 2018, 2019\nRelação Anual de Informações Sociais (RAIS), Ministério da Economia\n\n\nEstabelecimentos de assistência social\nQuantidade de CRAS\n2017, 2018, 2019\nCenso SUAS, Ministério da Cidadania\n\n\n\n\n\n\nDados de acessibilidade urbana\n\n\n\n\nTabela 2: Indicadores de acessibilidade calculados no Projeto Acesso a Oportunidades\n\n\n\n\n\n\n\nIndicador (código)\nDescrição\nTipo de oportunidades\nLimites de tempo de viagem\n\n\n\nTempo mínimo de viagem (TMI)\nTempo até a oportunidade mais próxima\nSaúde, Educação, CRAS\nA pé (60 mins); Bicicleta, Transporte público e carro (120 mins)\n\n\nMedida cumulativa ativa (CMA)\nQuantidade de oportunidades acessíveis em um determinado limite de tempo\nTrabalho, Saúde, Educação, CRAS\nA pé e bicicleta (15, 30, 45 e 60 mins); Transporte público e carro (15, 30, 60, 90 e 120 mins)\n\n\nMedida cumulativa passiva (CMP)\nQuantidade de pessoas que acessam a localidade em um determinado limite de tempo\n-\nA pé e bicicleta (15, 30, 45 e 60 mins); Transporte público e carro (15, 30, 60, 90 e 120 mins)\n\n\n\n\n\n\nTodas as bases de dados criadas pelo Projeto Acesso a Oportunidades (AOP) estão disponíveis para download no site do projeto ou pelo pacote de R aopdata. Nas próximas seções são apresentados exemplos de como baixar e visualizar esses dados em R.\n\n\n\n\nPereira, Rafael H. M., Carlos Kauê Vieira Braga, Daniel Herszenhut, Marcus Saraiva, and Diego Bogado Tomasiello. 2022. “Estimativas de acessibilidade a empregos e serviços públicos via transporte ativo, público e privado nas 20 maiores cidades do Brasil em 2017, 2018, 2019.” Texto para Discussão IPEA 2800.\n\n\nPereira, Rafael H. M., Daniel Herszenhut, Carlos Kauê Vieira Braga, João Pedro Bazzo, João Lucas Albuquerque Oliveira, João Pedro Parga, Marcus Saraiva, Luiz Pedro Silva, Lucas Warwar, and Diego Bogado Tomasiello. 2022. “Distribuição espacial de características sociodemográficas e localização de empregos e serviços públicos das vinte maiores cidades do Brasil.” Texto para Discussão IPEA 2772 (June): 28. https://doi.org/10.38116/td2772."
  },
  {
    "objectID": "7_aopdata_populacao.html",
    "href": "7_aopdata_populacao.html",
    "title": "\n7  Dados de população e socioeconômicos\n",
    "section": "",
    "text": "Para fazer o download dos dados do projeto AOP usando o pacote aopdata, você pode usar a função read_population(). Essa função baixa estimativas do Censo Demográfico de 2010 do IBGE sobre a distribuição espacial da população e suas características em termos de renda domiciliar per capita, cor, sexo e idade. Nesta função, o parâmetro city permite você indicar os dados de qual cidade serão baixados.\nOs dados estão agregados espacialmente em uma grade de hexágonos H3 na resolução 9, na qual cada hexágono tem uma área de 0.11 km², o que equivale a aproximadamente o tamanho de um quarteirão. Para baixar os dados com as informações espaciais de geometria da grade espacial, você deve usar o parâmetro geometry = TRUE.\nNeste exemplo, abaixo, nós mostramos como baixar os dados de população do Censo de 2010 para Fortaleza.\n\nlibrary(aopdata)\n\n# download aop population data\ndf <- read_population(\n  city = \"Fortaleza\",\n  year = 2010,\n  geometry = TRUE,\n  showProgress = FALSE\n)\n\nOs dados da tabela tem essa aparência aqui:\n\nhead(df)\n\nSimple feature collection with 6 features and 22 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -38.50828 ymin: -3.889301 xmax: -38.4983 ymax: -3.878958\nGeodetic CRS:  WGS 84\n  year          id_hex abbrev_muni name_muni code_muni P001 P002 P003 P004 P005\n1 2010 89801040323ffff         for Fortaleza   2304400   30    8   21    0    1\n2 2010 89801040327ffff         for Fortaleza   2304400  318   77  233    0    8\n3 2010 8980104032bffff         for Fortaleza   2304400    0    0    0    0    0\n4 2010 8980104032fffff         for Fortaleza   2304400  103   24   77    0    2\n5 2010 89801040333ffff         for Fortaleza   2304400   43   11   31    0    1\n6 2010 89801040337ffff         for Fortaleza   2304400  348   86  252    0   10\n  P006 P007 P010 P011 P012 P013 P014 P015 P016  R001 R002 R003\n1   17   13    3    4    2    3    8    9    1 168.6    1    1\n2  168  150   30   50   26   38   80   82   12 202.6    1    1\n3    0    0    0    0    0    0    0    0    0    NA   NA   NA\n4   53   50   10   16    8   13   25   27    4 245.6    1    1\n5   22   21    4    7    3    5   11   12    1 187.3    1    1\n6  175  173   34   54   27   41   89   89   14 168.6    1    1\n                        geometry\n1 POLYGON ((-38.50232 -3.8858...\n2 POLYGON ((-38.50527 -3.8840...\n3 POLYGON ((-38.49932 -3.8841...\n4 POLYGON ((-38.50227 -3.8824...\n5 POLYGON ((-38.50237 -3.8893...\n6 POLYGON ((-38.50532 -3.8875...\n\n\nDe imediato, se nota que os nomes das variáveis (colunas) da base de dados estão organizadas com códigos, como P001, P002, …, R001, R002, etc. A descrição completa do dicionário de variáveis está disponível aqui. A descrição de algumas dessas colunas é apresentada nas próximas seções, onde mostramos como fazer a visualização de alguns desses dados em mapas e gráficos."
  },
  {
    "objectID": "7_aopdata_populacao.html#mapa-de-população-total",
    "href": "7_aopdata_populacao.html#mapa-de-população-total",
    "title": "\n7  Dados de população e socioeconômicos\n",
    "section": "\n7.2 Mapa de população total",
    "text": "7.2 Mapa de população total\nAntes de visualizar os dados do aopdata, nós precisamos carregar algumas bibliotecas de visualização e manipulação de dados.\n\nlibrary(patchwork)\nlibrary(ggplot2)\nlibrary(scales)\nlibrary(sf)\n\nCom um comando, é possível visualizar a distribuição espacial da população de Fortaleza. A figura mostra um mapa coroplético onde a cor de cada célula da grade espacial é preenchida com base na quantidade total de pessoas residentes (variável P001).\n\nggplot(subset(df, P001 > 0)) +\n  geom_sf(aes(fill = P001), color = NA, alpha = 0.8) +\n  scale_fill_distiller(palette = \"YlOrRd\", direction = 1) +\n  labs(\n    title = \"Population distribution\",\n    subtitle = \"Fortaleza\",\n    fill = \"Total population\"\n  ) +\n  theme_void()"
  },
  {
    "objectID": "7_aopdata_populacao.html#mapa-de-população-por-cor",
    "href": "7_aopdata_populacao.html#mapa-de-população-por-cor",
    "title": "\n7  Dados de população e socioeconômicos\n",
    "section": "\n7.3 Mapa de população por cor",
    "text": "7.3 Mapa de população por cor\nAlém da informação sobre a população total em cada célula, o dados do aopdata também permitem saber a quantidade de pessoas de diferentes cores (variáveis P002 a P005), sexo (variáveis P006 e P007) e faixas etárias (variáveis P010 a P016). O código abaixo ilustra como é simples calcular a proporção de pessoas negras e brancas em cada hexágono e visualizar esses dados num mapa.\n\npop_b <- ggplot(subset(df, P001 > 0)) +\n  geom_sf(aes(fill = P003 / P001), color = NA, alpha = 0.8) +\n  scale_fill_distiller(\n    palette = \"RdPu\",\n    direction = 1,\n    labels = percent,\n    limits = c(0, 1)\n  ) +\n  labs(title = \"Proportion of black population\", fill = \"Black pop.\") +\n  theme_void()\n\npop_w <- ggplot(subset(df, P001 > 0)) +\n  geom_sf(aes(fill = P002 / P001), color = NA, alpha = 0.8) +\n  scale_fill_distiller(\n    palette = \"YlGnBu\",\n    direction = 1,\n    labels = percent,\n    limits = c(0, 1)\n  ) +\n  labs(title = \"Proportion of white population\", fill = \"White pop.\") +\n  theme_void()\n\npop_b + pop_w"
  },
  {
    "objectID": "7_aopdata_populacao.html#mapa-de-população-por-renda",
    "href": "7_aopdata_populacao.html#mapa-de-população-por-renda",
    "title": "\n7  Dados de população e socioeconômicos\n",
    "section": "\n7.4 Mapa de população por renda",
    "text": "7.4 Mapa de população por renda\nOs dados trazem também informação sobre a renda domiciliar per capita média de cada hexágono (R001), e sua classificação em termos de quintil (R002) e decil de renda (R003). Com esses dados, é possível visualizar com o comando abaixo a distribuição espacial dos diferentes níveis de renda da cidade.R\n\nrenda_c <- ggplot(subset(df, P001 > 0)) +\n  geom_sf(aes(fill = R001), color = NA, alpha = 0.8) +\n  scale_fill_distiller(palette = \"YlOrRd\", direction = 1) +\n  labs(title = \"Renda domiciliar per capita média\", fill = \"Renda em R$\") +\n  theme_void()\n\nrenda_d <- ggplot(subset(df, !is.na(R002))) +\n  geom_sf(aes(fill = factor(R003)), color = NA, alpha = 0.8) +\n  scale_fill_brewer(palette = \"RdBu\") +\n  labs(\n    title = \"Decils de renda domiciliar per capita\",\n    fill = \"Decil de renda\"\n  ) +\n  theme_void() +\n  theme(legend.key.size = unit(0.3, \"cm\"))\n\nrenda_c + renda_d"
  },
  {
    "objectID": "8_aopdata_uso_solo.html",
    "href": "8_aopdata_uso_solo.html",
    "title": "\n8  Dados de distribuição espacial de oportunidades\n",
    "section": "",
    "text": "O pacote aopdata também permite baixar, para todas cidades incluídas no projeto, dados anuais da distribuição espacial de empregos (de baixa, média e alta escolaridade), estabelecimentos de saúde (de baixa, média e alta complexidade), escolas pública (ensino infantil, fundamental e médio), e de centros de referência de assistência social (Cras).\nTodos esses dados podem ser baixados com a função read_landuse(), que funciona da mesma maneira que a função read_population(). Você só precisa indicar nos parâmetros da função qual cidade (city) e ano (year) devem ser baixados, além de apontar se deseja que os dados contenham as informações espaciais dos hexágonos (geometry = TRUE).\nNeste exemplo, abaixo, nós mostramos como baixar os dados de uso do solo no ano de 2019 para Belo Horizonte. Note que essa função automaticamente já baixa também os dados de população.\n\nlibrary(aopdata)\n\ndf <- read_landuse(\n  city = \"Belo Horizonte\",\n  year = 2019,\n  geometry = TRUE,\n  showProgress = FALSE\n)\n\nhead(df)\n\nSimple feature collection with 6 features and 39 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -43.87914 ymin: -19.86084 xmax: -43.85906 ymax: -19.82421\nGeodetic CRS:  WGS 84\n           id_hex abbrev_muni      name_muni code_muni P001 P002 P003 P004 P005\n1 89a881345a3ffff         bho Belo Horizonte   3106200    0    0    0    0    0\n2 89a881345a7ffff         bho Belo Horizonte   3106200    0    0    0    0    0\n3 89a881345b7ffff         bho Belo Horizonte   3106200    0    0    0    0    0\n4 89a88136103ffff         bho Belo Horizonte   3106200  508  141  353    4   10\n5 89a88136107ffff         bho Belo Horizonte   3106200  428  114  304    3    7\n6 89a8813610bffff         bho Belo Horizonte   3106200  399  111  277    3    8\n  P006 P007 P010 P011 P012 P013 P014 P015 P016  R001 R002 R003 year T001 T002\n1    0    0    0    0    0    0    0    0    0    NA   NA   NA 2019    0    0\n2    0    0    0    0    0    0    0    0    0    NA   NA   NA 2019    0    0\n3    0    0    0    0    0    0    0    0    0    NA   NA   NA 2019    0    0\n4  253  255   53   86   30   43  176  110   10 502.9    2    3 2019  100   17\n5  210  218   42   72   27   38  142   98    9 491.8    2    3 2019   44   19\n6  203  196   42   68   24   34  138   86    7 502.8    2    3 2019  104   31\n  T003 T004 E001 E002 E003 E004 M001 M002 M003 M004 S001 S002 S003 S004 C001\n1    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0\n2    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0\n3    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0\n4   72   11    1    1    0    0  321  321    0    0    0    0    0    0    0\n5   23    2    0    0    0    0    0    0    0    0    0    0    0    0    0\n6   58   15    1    0    1    0  817    0  817    0    0    0    0    0    0\n                        geometry\n1 POLYGON ((-43.86011 -19.829...\n2 POLYGON ((-43.86313 -19.827...\n3 POLYGON ((-43.86321 -19.830...\n4 POLYGON ((-43.8731 -19.8608...\n5 POLYGON ((-43.87612 -19.859...\n6 POLYGON ((-43.87001 -19.859...\n\n\nAntes de visualizar os dados de uso do solo nas próxima seções, vamos carregar algumas bibliotecas de visualização e manipulação de dados.\n\nlibrary(patchwork)\nlibrary(ggplot2)\nlibrary(scales)\nlibrary(sf)"
  },
  {
    "objectID": "8_aopdata_uso_solo.html#mapa-de-empregos",
    "href": "8_aopdata_uso_solo.html#mapa-de-empregos",
    "title": "\n8  Dados de distribuição espacial de oportunidades\n",
    "section": "\n8.2 Mapa de empregos",
    "text": "8.2 Mapa de empregos\nComo nos exemplos anteriores, é possível visualizar o mapa de distribuição espacial de empregos usando o pacote ggplot2 com o código abaixo:\n\nggplot(df) +\n  geom_sf(aes(fill = T001), color = NA, alpha = 0.9) +\n  scale_fill_distiller(palette = \"YlGnBu\", direction = 1) +\n  labs(\n    title = \"Distribuição espacial de empregos\",\n    subtitle = \"Belo Horizonte\",\n    fill = \"N. de empregos\"\n  ) +\n  theme_void()"
  },
  {
    "objectID": "8_aopdata_uso_solo.html#mapa-de-escolas",
    "href": "8_aopdata_uso_solo.html#mapa-de-escolas",
    "title": "\n8  Dados de distribuição espacial de oportunidades\n",
    "section": "\n8.3 Mapa de escolas",
    "text": "8.3 Mapa de escolas\nAs variáveis que indicam o número de escolas em cada célula são aquelas que começam com a letra E. Neste exemplo abaixo, nós mapeamos a distribuição espacial de todas escolas de Belo Horizonte a partir da variável E001.\n\nggplot(df) +\n  geom_sf(aes(fill = as.factor(E001)), color = NA, alpha = 0.9) +\n  scale_fill_brewer(palette = \"YlGnBu\", direction = 1) +\n  labs(\n    title = \"Distribuição espacial de escolas\",\n    subtitle = \"Belo Horizonte\",\n    fill = \"N. de escolas\"\n  ) +\n  theme_void()"
  },
  {
    "objectID": "8_aopdata_uso_solo.html#mapa-de-estabelecimentos-de-saúde",
    "href": "8_aopdata_uso_solo.html#mapa-de-estabelecimentos-de-saúde",
    "title": "\n8  Dados de distribuição espacial de oportunidades\n",
    "section": "\n8.4 Mapa de estabelecimentos de saúde",
    "text": "8.4 Mapa de estabelecimentos de saúde\nPara analisar a distribuição espacial de estabelecimentos de saúde, você deve analisar as variáveis que começam com a letra S. O código abaixo nos permite comparar a distribuição espacial de estabelecimentos de saúde de baixa complexidade (S002) e alta complexidade (S004).\n\nsau_b <- ggplot(df) +\n  geom_sf(aes(fill = as.factor(S002)), color = NA, alpha = 0.9) +\n  scale_fill_brewer(palette = \"YlGnBu\", direction = 1, limits = factor(0:4)) +\n  labs(\n    title = \"Estabelecimentos de saúde\",\n    subtitle = \"Baixa complexidade\",\n    fill = \"N. de estabelecimentos\"\n  ) +\n  theme_void()\n\nsau_a <- ggplot(df) +\n  geom_sf(aes(fill = as.factor(S004)), color = NA, alpha = 0.9) +\n  scale_fill_brewer(palette = \"YlGnBu\", direction = 1, limits = factor(0:4)) +\n  labs(\n    title = \"Estabelecimentos de saúde\",\n    subtitle = \"Alta complexidade\",\n    fill = \"N. de estabelecimentos\"\n  ) +\n  theme_void()\n\nsau_b  + sau_a  + plot_layout(guides = 'collect')"
  },
  {
    "objectID": "8_aopdata_uso_solo.html#mapa-de-cras",
    "href": "8_aopdata_uso_solo.html#mapa-de-cras",
    "title": "\n8  Dados de distribuição espacial de oportunidades\n",
    "section": "\n8.5 Mapa de CRAS",
    "text": "8.5 Mapa de CRAS\nPor fim, a distribuição espacial dos Centros de Referência de Assistência Social (CRAS) pode ser analisada com a variável C001.\n\nggplot(df) +\n  geom_sf(aes(fill = as.factor(C001)), color = NA, alpha = 0.9) +\n  scale_fill_brewer(palette = \"YlGnBu\", direction = 1) +\n  labs(\n    title = \"Centros de Referência de Assistência Social (Cras)\",\n    subtitle = \"Belo Horizonte\",\n    fill = \"N. de Cras\"\n  ) +\n  theme_void()"
  },
  {
    "objectID": "9_aopdata_acessibilidade.html",
    "href": "9_aopdata_acessibilidade.html",
    "title": "\n9  Estimativas e mapas de acessibilidade\n",
    "section": "",
    "text": "Finalmente, o pacote aopdata também permite baixar, para todas cidades incluídas no projeto, estimativas anuais de acesso a empregos, serviços saúde, educação e assistência social por modo de transporte\nTodos esses dados podem ser baixados com a função read_access(), que funciona da mesma maneira que as funções read_population() e read_landuse() apresentadas nos capítulos anteriores. Aqui, no entanto, além de indicar a cidade (city) e o ano (year) de referência para baixar os dados, você também precisa informar qual o modo de transporte (mode) será baixado e se você quer estimativas de acessibilidade no horário de pico (peak = TRUE) ou fora-pico (peak = FALSE). Esses dados representam a acessibilidade mediana entre 6h e 8h e entre 14h e 16h, respectivamente.\nNeste exemplo, abaixo, nós mostramos como baixar os dados de acessibilidade urbana no ano de 2019 para São Paulo no período de pico. Nesse exemplo, nós baixamos tanto as estimativas de acessibilidade por automóvel quanto por transporte público, e empilhamos os dados num único data.frame. Note que essa função também baixa os dados de população e de uso do solo automaticamente.\n\nlibrary(aopdata)\n\n# download aop accessibility data\ndf_pt <- read_access(\n  city = \"São Paulo\",\n  mode = \"public_transport\",\n  year = 2019,\n  peak = TRUE,\n  geometry = TRUE,\n  showProgress = FALSE\n)\n\ndf_car <- read_access(\n  city = \"São Paulo\",\n  mode = \"car\",\n  year = 2019,\n  peak = TRUE,\n  geometry = TRUE,\n  showProgress = FALSE\n)\n\n# row bind into a single data.frame\ndf <- rbind(df_pt, df_car)\nhead(df)\n\nSimple feature collection with 6 features and 205 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -46.63863 ymin: -23.71413 xmax: -46.62834 ymax: -23.70485\nGeodetic CRS:  WGS 84\n           id_hex abbrev_muni name_muni code_muni year P001 P002 P003 P004 P005\n1 89a81000003ffff         spo Sao Paulo   3550308 2019  322  127  190    0    5\n2 89a81000007ffff         spo Sao Paulo   3550308 2019   16    3   13    0    0\n3 89a8100000bffff         spo Sao Paulo   3550308 2019 2386 1142 1232    2   10\n4 89a8100000fffff         spo Sao Paulo   3550308 2019  885  260  622    0    3\n5 89a81000013ffff         spo Sao Paulo   3550308 2019  725  340  380    0    5\n6 89a81000017ffff         spo Sao Paulo   3550308 2019  211  110   98    0    3\n  P006 P007 P010 P011 P012 P013 P014 P015 P016  R001 R002 R003 T001 T002 T003\n1  158  164   33   63   28   35   85   75    3 477.6    2    3   72   19   50\n2    9    7    2    2    2    3    2    5    0  65.7    1    1    0    0    0\n3 1216 1170  247  410  174  269  682  572   32 377.2    1    1   52    6   24\n4  460  425   96  124   88  127  175  266    9 363.9    1    1    0    0    0\n5  371  354   85  129   51   78  196  173   13 503.5    2    3    0    0    0\n6  104  107   20   33   16   25   52   59    6 687.9    3    6  113   18   65\n  T004 E001 E002 E003 E004 M001 M002 M003 M004 S001 S002 S003 S004 C001\n1    3    0    0    0    0    0    0    0    0    0    0    0    0    0\n2    0    0    0    0    0    0    0    0    0    0    0    0    0    0\n3   22    0    0    0    0    0    0    0    0    0    0    0    0    0\n4    0    0    0    0    0    0    0    0    0    0    0    0    0    0\n5    0    0    0    0    0    0    0    0    0    0    0    0    0    0\n6   30    2    0    2    1 1477    0 1168  309    0    0    0    0    0\n              mode peak CMATT15 CMATB15 CMATM15 CMATA15 CMAST15 CMASB15 CMASM15\n1 public_transport    1     315      71     175      69       0       0       0\n2 public_transport    1     313      70     174      69       0       0       0\n3 public_transport    1     229      43     161      25       2       2       2\n4 public_transport    1     551     123     343      85       3       3       3\n5 public_transport    1     421      90     262      69       2       2       2\n6 public_transport    1     312      76     187      49       0       0       0\n  CMASA15 CMAET15 CMAEI15 CMAEF15 CMAEM15 CMAMT15 CMAMI15 CMAMF15 CMAMM15\n1       0       2       0       2       1    1477       0    1168     309\n2       0       2       0       2       1    1477       0    1168     309\n3       0       0       0       0       0       0       0       0       0\n4       0       4       1       3       2    3132     460    1965     707\n5       0       2       0       2       1    1477       0    1168     309\n6       0       2       0       2       1    1477       0    1168     309\n  CMACT15 CMPPT15 CMPPH15 CMPPM15 CMPPB15 CMPPA15 CMPPI15 CMPPN15 CMPP0005I15\n1       0    4895    2428    2467    2238      27       2    2628         505\n2       0    4895    2428    2467    2238      27       2    2628         505\n3       0    9537    4645    4892    4685      64       3    4785         872\n4       0   13109    6331    6778    6453      61       8    6587        1088\n5       0    4934    2452    2482    2368      48       0    2518         461\n6       0    3199    1608    1591    1567      20       0    1612         317\n  CMPP0614I15 CMPP1518I15 CMPP1924I15 CMPP2539I15 CMPP4069I15 CMPP70I15 CMATT30\n1         809         371         566        1313        1247        84    4797\n2         809         371         566        1313        1247        84    4228\n3        1538         726        1138        2550        2539       174    2648\n4        2012         967        1575        3383        3783       301    6200\n5         749         373         587        1271        1372       121    5773\n6         487         239         374         807         891        84    6608\n  CMATB30 CMATM30 CMATA30 CMAST30 CMASB30 CMASM30 CMASA30 CMAET30 CMAEI30\n1    1293    2789     715       5       5       5       0      18       5\n2    1170    2452     606       4       4       4       0      13       4\n3     714    1526     408       4       4       4       0       9       2\n4    1598    3641     961       5       5       5       0      19       6\n5    1589    3271     913       5       5       5       0      18       5\n6    1821    3659    1128       6       6       6       0      22       5\n  CMAEF30 CMAEM30 CMAMT30 CMAMI30 CMAMF30 CMAMM30 CMACT30 CMPPT30 CMPPH30\n1      13       4   15148    2409   10765    1974       1   59041   28457\n2       9       3   10497    1949    6931    1617       1   40049   19392\n3       7       3    7222    1069    5137    1016       1   59792   28974\n4      13       5   15710    2527   10551    2632       2  101380   48709\n5      13       4   15148    2409   10765    1974       1   81985   39473\n6      17       5   19547    2409   14343    2795       1   83186   40111\n  CMPPM30 CMPPB30 CMPPA30 CMPPI30 CMPPN30 CMPP0005I30 CMPP0614I30 CMPP1518I30\n1   30584   28535     446      29   30031        5263        8809        4111\n2   20657   19159     273      14   20603        3610        6061        2866\n3   30818   28424     365      25   30978        5376        9204        4241\n4   52671   47601     955      66   52758        9076       15239        6971\n5   42512   39784     695      49   41457        7189       12278        5675\n6   43075   40359     728      51   42048        7302       12371        5749\n  CMPP1924I30 CMPP2539I30 CMPP4069I30 CMPP70I30 CMATT60 CMATB60 CMATM60 CMATA60\n1        6817       15664       16733      1644   96195   18711   54773   22711\n2        4673       10486       11274      1079   72810   14161   40949   17700\n3        6927       15859       16646      1539  147237   26399   82208   38630\n4       11658       27259       28303      2874  107938   21292   61768   24878\n5        9311       21712       23351      2469  161353   28971   91687   40695\n6        9459       22070       23710      2525  158016   28997   91280   37739\n  CMAST60 CMASB60 CMASM60 CMASA60 CMAET60 CMAEI60 CMAEF60 CMAEM60 CMAMT60\n1      50      38      48       6     120      40      76      29   87761\n2      40      34      39       2     108      36      68      28   79902\n3      57      45      56       5     135      45      88      30   93958\n4      56      43      54       6     128      42      82      31   92799\n5      59      44      57       7     141      47      90      32   97925\n6      56      43      54       6     139      47      87      32   96281\n  CMAMI60 CMAMF60 CMAMM60 CMACT60 CMPPT60 CMPPH60 CMPPM60 CMPPB60 CMPPA60\n1   15059   56558   16144       5  547471  259971  287500  277734   11134\n2   14014   50455   15433       5  501558  238550  263008  247962    8781\n3   16318   61918   15722       6  633994  299454  334540  339064   19838\n4   15615   60049   17135       5  689942  325560  364382  378571   21810\n5   16744   63838   17343       6  666492  314759  351733  360532   20661\n6   16812   62265   17204       6  632529  299225  333304  334655   17957\n  CMPPI60 CMPPN60 CMPP0005I60 CMPP0614I60 CMPP1518I60 CMPP1924I60 CMPP2539I60\n1     407  258196       44866       76195       34899       59393      146870\n2     383  244432       41903       71199       32501       54873      134759\n3     473  274619       49586       83666       38585       67298      169669\n4     496  289065       53223       89680       41446       72354      184045\n5     483  284816       51720       87430       40333       70418      178015\n6     451  279466       49804       84545       38888       67458      168928\n  CMPP4069I60 CMPP70I60 CMATT90 CMATB90 CMATM90 CMATA90 CMAST90 CMASB90 CMASM90\n1      162048     23200 1168463  166686  577124  424653     169     111     160\n2      146361     19962 1088120  153982  540566  393572     160     107     152\n3      194234     30956 1428750  211239  719220  498291     190     119     179\n4      214049     35145 1362473  191461  669950  501062     182     117     172\n5      205504     33072 1443193  211449  723001  508743     203     131     191\n6      192822     30084 1406215  203383  701014  501818     204     132     193\n  CMASA90 CMAET90 CMAEI90 CMAEF90 CMAEM90 CMAMT90 CMAMI90 CMAMF90 CMAMM90\n1      42     337     107     207      92  218542   30864  131526   56152\n2      39     328     105     201      90  213963   30365  128917   54681\n3      50     370     123     222     101  232126   34693  138061   59372\n4      46     355     117     214      92  223492   32779  134438   56275\n5      51     415     136     248     114  264729   38719  158252   67758\n6      51     415     137     247     114  266946   39578  159137   68231\n  CMACT90 CMPPT90 CMPPH90 CMPPM90 CMPPB90 CMPPA90 CMPPI90 CMPPN90 CMPP0005I90\n1      10 1697502  790958  906544 1113577   80011    1336  502578      111963\n2       9 1617428  753988  863440 1054271   74800    1240  487117      107419\n3      10 1918445  894649 1023796 1274988   90290    1602  551565      125137\n4      10 2096063  978494 1117569 1384576   94542    2065  614880      138110\n5      12 2027043  946208 1080835 1333715   91633    1714  599981      133501\n6      12 1950319  910888 1039431 1272271   88334    1558  588156      129637\n  CMPP0614I90 CMPP1518I90 CMPP1924I90 CMPP2539I90 CMPP4069I90 CMPP70I90\n1      183412       87698      165449      454122      573567    121291\n2      176240       84154      157827      432825      545306    113657\n3      204140       97829      187004      513061      650643    140631\n4      225800      107835      205069      561408      707435    150406\n5      218843      104726      198411      541774      684520    145268\n6      212862      101535      191408      521731      655761    137385\n  CMATT120 CMATB120 CMATM120 CMATA120 CMAST120 CMASB120 CMASM120 CMASA120\n1  2136716   328724  1094450   713542      357      235      338       82\n2  2095040   321900  1068319   704821      355      235      337       80\n3  2203072   344047  1136019   723006      374      243      356       86\n4  2494268   397258  1308021   788989      418      266      395       97\n5  2275396   357833  1177979   739584      401      265      381       90\n6  2195795   342423  1130056   723316      387      257      367       88\n  CMAET120 CMAEI120 CMAEF120 CMAEM120 CMAMT120 CMAMI120 CMAMF120 CMAMM120\n1      821      288      481      221   518042    83000   313683   121359\n2      815      288      479      216   516846    83610   313657   119579\n3      855      293      508      230   532772    82410   323147   127215\n4      976      340      576      260   610890    97742   369803   143345\n5      948      333      559      251   600516    97066   367244   136206\n6      942      334      554      254   604830    98765   368433   137632\n  CMACT120 CMPPT120 CMPPH120 CMPPM120 CMPPB120 CMPPA120 CMPPI120 CMPPN120\n1       20  4018897  1890513  2128384  2540395   134426     4039  1340037\n2       20  3860887  1814742  2046145  2445536   130803     3868  1280680\n3       21  4320562  2032079  2288483  2745882   142238     4320  1428122\n4       24  4752649  2234731  2517918  3037441   153875     5098  1556235\n5       22  4351102  2049261  2301841  2735091   140022     4377  1471612\n6       21  4191716  1974700  2217016  2627575   136196     4172  1423773\n  CMPP0005I120 CMPP0614I120 CMPP1518I120 CMPP1924I120 CMPP2539I120 CMPP4069I120\n1       281477       467671       217602       408477      1084792      1300130\n2       269676       448086       208699       391944      1041317      1251187\n3       301337       501274       233530       439651      1163931      1400822\n4       330744       549438       256378       484187      1277780      1541189\n5       307070       511736       237911       444278      1173140      1401287\n6       297029       494835       229726       427661      1129908      1348228\n  CMPP70I120 TMIST TMISB TMISM TMISA TMIET TMIEI TMIEF TMIEM TMICT\n1     258748    17    17    17    53   8.0    26   8.0   8.0    21\n2     249978    21    21    21    55   9.0    28   9.0   9.0    23\n3     280017    13    13    13    50  17.0    26  17.0  17.0    30\n4     312933    13    13    13    53   7.0    13   7.0   7.0    28\n5     275680    12    12    12    51   8.0    24   8.0   8.0    19\n6     264329    16    16    16    49   5.8    22   5.8   5.8    16\n                        geometry\n1 POLYGON ((-46.63251 -23.711...\n2 POLYGON ((-46.63552 -23.709...\n3 POLYGON ((-46.62941 -23.709...\n4 POLYGON ((-46.63242 -23.708...\n5 POLYGON ((-46.6326 -23.7141...\n6 POLYGON ((-46.63561 -23.712...\n\n\nOs nomes das variáveis (colunas) com estimativas de acessibilidade também estão organizadas com códigos, como CMAEF30, TMISB ou CMPPM60. O nome das colunas com estimativas de acessibilidade são a junção de três componentes: o tipo de indicador de acessibilidade; o tipo de oportunidade / pessoas; e o tempo limite.\n\n\nO tipo de indicador de acessibilidade é indicado pelas primeiras 3 letras. O projeto AOP atualmente inclui três tipos de indicadores:\n\n\nCMA - Indicador de acessibilidade cumulativo ativo\n\nCMP - Indicador de acessibilidade cumulativo passivo\n\nTMI - Indicador de tempo mínimo até oportunidade mais próxima\n\n\n\nO tipo de atividade é indicado pelas letras seguintes, no meio do nome da variável. O projeto AOP atualmente inclui diversos tipos de atividades:\n\n\nTT - Todos empregos\n\nTB - Empregos de baixa escolaridade\n\nTM - Empregos de média escolaridade\n\nTA - Empregos de alta escolaridade\n\nST - Todos estabelecimentos de saúde\n\nSB - Estabelecimentos de saúde de baixa complexidade\n\nSM - Estabelecimentos de saúde de média complexidade\n\nSA - Estabelecimentos de saúde de alta complexidade\n… e assim por diante.\n\nNo caso do indicador de acessibilidade passiva (CMP), as letras do meio do nome da variável indicam qual o grupo populacional de referência.\n\n\nPT - População total\n\nPH - População de homens\n\nPM - População de mulheres\n\nPB - População branca\n\nPN - População negra\n\nP1924I - População de 19 a 24 anos de idade\n\nP2539I - População de 25 a 39 anos de idade\n\n\nO tempo limite de viagem é indicado pelos números no final do nome da variável. Esses números somente se aplicam para os indicadores de acessibildade cumulativa ativa (CMA) e passiva (CMP).\n\nExemplos:\n\n\nCMAEF30: Número de escolas de ensino fundamental acessíveis em até 30 minutos\n\n\nTMISB: Tempo de viagem até o estabelecimento de saúde mais próximo com serviços de baixa complexidade\n\n\nCMPPM60: Quantidade de mulheres que conseguem acessar determinado hexágono em até 60 minutos\n\n\nLembre-se, a descrição completa do dicionário de variáveis está disponível no site to pacote aopdata.\nA seguir, nós mostramos alguns exemplos de como visualizar essas estimativas de acessibilidade."
  },
  {
    "objectID": "9_aopdata_acessibilidade.html#mapa-do-tempo-para-acessar-o-hospital-mais-próximo",
    "href": "9_aopdata_acessibilidade.html#mapa-do-tempo-para-acessar-o-hospital-mais-próximo",
    "title": "\n9  Estimativas e mapas de acessibilidade\n",
    "section": "\n9.2 Mapa do tempo para acessar o hospital mais próximo",
    "text": "9.2 Mapa do tempo para acessar o hospital mais próximo\nNeste exemplo, nós vamos comparar o nível de acessibilidade até hospitais entre modos automóvel vs transporte público. Para analisar qual o tempo mínimo de viagem (TMI) até um hospital de alta complexidade (SA), nós precisamos analisar a variável TMISA. Com o código abaixo, nós carregamos as bibliotecas para manipulação e visualização de dados, e visualizamos a distribuição espacial dos valores de TMISA para ambos modos de transporte.\nNote, no entanto, que os tempos de viagem por transporte público costumam ser muito mais longos do que por automóvel. Então para facilitar a visualização dos resultados, nós truncamos a distribuição dos valores de TMISA em 60 minutos ou mais.\n\nlibrary(ggplot2)\nlibrary(data.table)\nlibrary(patchwork)\nlibrary(scales)\nlibrary(sf)\n\n# truncate max values to 60 min.\ndf$TMISA <- ifelse(df$TMISA > 60, 60, df$TMISA) \n\nggplot(subset(df, !is.na(mode))) +\n  geom_sf(aes(fill = TMISA), color = NA, alpha = 0.9) +\n  scale_fill_viridis_c(\n    option = \"cividis\",\n    direction = -1,\n    breaks = seq(0, 60, 10),\n    labels = c(seq(0, 50, 10), \"60+\")\n  ) +\n  labs(\n    title = \"Tempo de viagem até hospital de alta complex. mais próximo\",\n    subtitle = \"São Paulo\",\n    fill = \"Tempo em\\nminutos\"\n  ) +\n  facet_grid(. ~ mode) +\n  theme_void()"
  },
  {
    "objectID": "9_aopdata_acessibilidade.html#mapa-da-quantidade-de-oportunidades-acessíveis",
    "href": "9_aopdata_acessibilidade.html#mapa-da-quantidade-de-oportunidades-acessíveis",
    "title": "\n9  Estimativas e mapas de acessibilidade\n",
    "section": "\n9.3 Mapa da quantidade de oportunidades acessíveis",
    "text": "9.3 Mapa da quantidade de oportunidades acessíveis\nUma vez que os dados já foram baixados do aopdata, é muito simples comparar por exemplo a quantidade de oportunidades acessíveis em diferentes tempos de viagem. O código abaixo ilustra como visualizar num mapa o número de empregos acessíveis em até 60 e 90 minutos de viagem por transporte público, e como colocar esses mapas lado a lado para comparação.\n\n# limits for legend scale\nvalue_limits <- c(0, max(df_pt$CMATT90, na.rm=T) / 1000)\n\n# create maps\nfig60 <- ggplot(subset(df_pt, !is.na(mode))) +\n  geom_sf(aes(fill = CMATT60 / 1000), color = NA, alpha = 0.9) +\n  scale_fill_viridis_c(option = \"inferno\", limits = value_limits) +\n  labs(subtitle = \"em até 60 min.\", fill = \"Empregos\") +\n  theme_void()\n\nfig90 <- ggplot(subset(df_pt, !is.na(mode))) +\n  geom_sf(aes(fill = CMATT90 / 1000), color = NA, alpha = 0.9) +\n  scale_fill_viridis_c(option = \"inferno\", limits = value_limits) +\n  labs(subtitle = \"em até 90 min.\", fill = \"Empregos\") +\n  theme_void()\n\nfig60 +\n  fig90 + \n  plot_layout(guides = \"collect\") +\n  plot_annotation(\n    title = \"Quantidade de empregos acessíveis por transporte público\",\n    subtitle = \"São Paulo\"\n  )"
  },
  {
    "objectID": "9_aopdata_acessibilidade.html#desigualdades-de-acesso-a-oportunidades",
    "href": "9_aopdata_acessibilidade.html#desigualdades-de-acesso-a-oportunidades",
    "title": "\n9  Estimativas e mapas de acessibilidade\n",
    "section": "\n9.4 Desigualdades de acesso a oportunidades",
    "text": "9.4 Desigualdades de acesso a oportunidades\nExistem diversas maneiras de se analisar quão desiguais são as condições de acesso a oportunidades a partir dos dados do aopdata. Nós apresentamos nesta subseção três exemplos de como esse tipo de análise pode ser realizado.\nDesigualdade no tempo de acesso TMI\nNeste primeiro exemplo, nós vamos comparar qual o tempo médio de viagem até o hospital mais próximo para pessoas de diferentes níveis de renda. Para isso, o código abaixo calcula o valor médio de TMISA ponderada pela população em cada hexágono. Essa ponderação é necessária porque o número de hexágonos pode variar muito entre hexágonos.\nAntes disso, cabe observar que alguns hexágonos da cidade não conseguem acessar nenhum hospital em até 2h de viagem. Em casos como esse, o valor das variáveis TMI__ é infinito (Inf). Para lidar com esses casos, nós substituímos abaixo todos valores Inf por 120 minutos.\n\n# copy data to new data.table\ndt <- copy(df_pt)\nsetDT(dt)\n\n# replace Inf travel time with 120\ndt[, TMISA := fifelse(TMISA==Inf, 120, TMISA)]\n\n# calculate average travel time by income\ntemp <- dt[\n  ,\n  .(average = weighted.mean(x = TMISA, w = P001, na.rm = TRUE)),\n  by = R003\n]\ntemp <- na.omit(temp)\n\nggplot(temp) + \n  geom_col(aes(y = average, x = factor(R003)), fill = \"#2c9e9e\", color = NA) +\n  scale_x_discrete(labels = c(\"D1\\n+Pobres\", paste0(\"D\", 2:9), \"D10\\n+Ricos\")) +\n  labs(\n    title = \"Média de tempo de viagem até o hospital mais proximo\",\n    subtitle = \"por transporte público em São Paulo\",\n    x = \"Decil de renda\",\n    y = \"Tempo de viagem\\nem min.\"\n  ) +\n  theme_minimal()\n\n\n\n\nDesigualdade do número de oportunidades acessíveis CMA\nOutra maneira de examinar a desigualdade de acesso a oportunidades é comparar a quantidade de oportunidades acessíveis por diferentes grupos populacionais considerando-se um mesmo modo de transporte e tempo de viagem. Nesse caso, nós analisamos o Indicador de acessibilidade cumulativo ativo (CMA).\nNeste exemplo abaixo, nós utilizamos box plots para comparar a quantidade de empregos acessíveis por transporte público em até 30 minutos de viagem.\n\nggplot(subset(dt, !is.na(R003))) +\n  geom_boxplot(\n    aes(x = factor(R003), y = CMATT60 / 1000, color = factor(R003))\n  ) +\n  scale_color_brewer(palette = \"RdBu\") +\n  labs(\n    title = \"Distribução do número de empregos acessíveis em até 30 min.\",\n    color = \"Decil\\nde renda\",\n    subtitle = \"por transporte público, São Paulo\",\n    x = \"Decil de renda\",\n    y = \"N. de empregos acessíveis\\n(em milhares)\"\n  ) +\n  scale_x_discrete(labels = c(\"D1\\n+Pobres\", paste0(\"D\", 2:9), \"D10\\n+Ricos\")) +\n  theme_minimal()\n\n\n\n\nTambém é possível comparar como diferentes modos de transporte possibilitam diferentes níveis de acessibilidade, e como essa diferença pode variar muito entre cidades. Nesse exemplo, abaixo, nós vamos comparar a quantidade de empregos acessíveis em até 30 minutos de viagem a pé e de carro. O primeiro passo é baixar os dados de acessibilidade a pé e por automóvel para todas as cidades.\n\ndf_car <- read_access(\n  city = \"all\",\n  mode = \"car\",\n  year = 2019,\n  showProgress = FALSE\n)\n\ndf_walk <- read_access(\n  city = \"all\",\n  mode = \"walk\",\n  year = 2019,\n  showProgress = FALSE\n)\n\nO próximo passo é calcular para cada cidade a média ponderada do número de empregos acessíveis em até 30 minutos (CMATT30) para cada um dos modos de transporte. Com esses resultados prontos para cada modo, nós juntamos essas estimativas num único data.frame e calculamos a razão da acessibilidade por carro dividida pela acessibilidade à pé.\n\n# calculate the average number of jobs accessible in 30min\ndf_car2 <- df_car[\n  ,\n  .(access_car = weighted.mean(CMATT30, w = P001, na.rm = TRUE)),\n  by = name_muni\n]\n\ndf_walk2 <- df_walk[\n  ,\n  .(access_walk = weighted.mean(CMATT30, w = P001, na.rm = TRUE)),\n  by = name_muni\n]\n\n# merge and get the ratio between walking and driving access\ndf <- merge(df_car2, df_walk2)\ndf[, ratio := access_car / access_walk]\n\nhead(df)\n\n        name_muni access_car access_walk    ratio\n1:          Belem   155270.4    9392.235 16.53179\n2: Belo Horizonte   529890.0   12464.233 42.51284\n3:       Brasilia   220575.9    4110.703 53.65892\n4:       Campinas   256333.1    6748.923 37.98133\n5:   Campo Grande   172680.5    4181.209 41.29919\n6:       Curitiba   494376.9   10471.135 47.21331\n\n\nPronto, agora é só visualizar os resultados. Como esperado, a figura abaixo mostra que é possível acessar muito mais empregos em 30 min. por automóvel do que em caminhada. No entanto, essa diferença varia muito entre cidades. Em São Paulo e em Brasília, 30 minutos de viagem por automóvel permite acessar, em média, um número de empregos 54 vezes maior do que a pé. Em Belém, onde observamos a menor diferença, o automóvel ainda permite acessar 17 vezes mais empregos do que a caminhada.\n\nggplot(df, aes(x = ratio, y = reorder(name_muni, ratio))) +\n  geom_bar(stat = \"identity\") +\n  geom_text(aes(x = ratio + 6 , label = paste0(round(ratio), \"x\"))) +\n  labs(\n    title = \"Diferença da quantidade de empregos acessiveis por\\nautomóvel vs a pé\",\n    subtitle = \"em até 30 min. de viagem\",\n    y = \"\",\n    x = \"Número de vezes\"\n  ) +\n  theme_classic()"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "Referências bibliográficas",
    "section": "",
    "text": "Anda, Cuauhtemoc, Alexander Erath, and Pieter Jacobus Fourie. 2017.\n“Transport Modelling in the Age of Big Data.”\nInternational Journal of Urban Sciences 21 (sup1): 19–42. https://doi.org/10.1080/12265934.2017.1281150.\n\n\nArbex, Renato, and Claudio B. Cunha. 2020. “Estimating the\nInfluence of Crowding and Travel Time Variability on Accessibility to\nJobs in a Large Public Transport Network Using Smart Card Big\nData.” Journal of Transport Geography 85 (May): 102671.\nhttps://doi.org/10.1016/j.jtrangeo.2020.102671.\n\n\nBanister, David. 2008. “The Sustainable Mobility Paradigm.”\nTransport Policy 15 (2): 73–80. https://doi.org/10.1016/j.tranpol.2007.10.005.\n\n\n———. 2011. “The Trilogy of Distance, Speed and Time.”\nJournal of Transport Geography 19 (4): 950–59. https://doi.org/10.1016/j.jtrangeo.2010.12.004.\n\n\nBarrington-Leigh, Christopher, and Adam Millard-Ball. 2017. “The\nWorld’s User-Generated Road Map Is More Than 80% Complete.”\nPLOS ONE 12 (8): e0180698. https://doi.org/10.1371/journal.pone.0180698.\n\n\nBertolini, L., F. le Clercq, and L. Kapoen. 2005. “Sustainable\nAccessibility: A Conceptual Framework to Integrate Transport and Land\nUse Plan-Making. Two Test-Applications in the\nNetherlands and a Reflection on the Way Forward.”\nTransport Policy 12 (3): 207–20. https://doi.org/10.1016/j.tranpol.2005.01.006.\n\n\nBoisjoly, Geneviève, and Ahmed M. El-Geneidy. 2017. “How to Get\nThere? A Critical Assessment of Accessibility Objectives\nand Indicators in Metropolitan Transportation Plans.”\nTransport Policy 55 (April): 38–50. https://doi.org/10.1016/j.tranpol.2016.12.011.\n\n\nBraga, Carlos Kaue Vieira, Diego Bogado Tomasiello, Daniel Herszenhut,\nJoão Lucas Albuquerque Oliveira, and Rafael Henrique Moraes Pereira.\n2022. “Impactos da expansão do metrô de Fortaleza sobre o\nacesso a oportunidades de emprego, saúde e educação.”\nhttp://www.ipea.gov.br, May.\n\n\nBrodsky, Isaac. 2018. “H3: Uber’s Hexagonal\nHierarchical Spatial Index.” Uber Engineering\nBlog. https://eng.uber.com/h3/.\n\n\nBüttner, Benjamin. 2021. “Accessibility Tools for\nTransport Policy and Planning.” In\nInternational Encyclopedia of\nTransportation, edited by Roger Vickerman, 83–86.\nOxford: Elsevier. https://doi.org/10.1016/B978-0-08-102671-7.10618-9.\n\n\nCamboim, Silvana Philippi, João Vitor Meza Bravo, and Claudia Robbi\nSluter. 2015. “An Investigation into the\nCompleteness of, and the Updates to,\nOpenStreetMap Data in a Heterogeneous Area in\nBrazil.” ISPRS International Journal of\nGeo-Information 4 (3): 1366–88. https://doi.org/10.3390/ijgi4031366.\n\n\nChurch, A, M Frost, and K Sullivan. 2000. “Transport and Social\nExclusion in London.” Transport Policy 7\n(3): 195–205. https://doi.org/10.1016/S0967-070X(00)00024-X.\n\n\nConway, Matthew Wigginton, Andrew Byrd, and Marco van der Linden. 2017.\n“Evidence-Based Transit and Land Use Sketch\nPlanning Using Interactive Accessibility Methods on\nCombined Schedule and Headway-Based\nNetworks.” Transportation Research Record: Journal of\nthe Transportation Research Board 2653 (1): 45–53. https://doi.org/10.3141/2653-06.\n\n\nDijst, Martin, Tom de Jong, and Jan Ritsema van Eck. 2002.\n“Opportunities for Transport Mode Change: An\nExploration of a Disaggregated Approach.”\nEnvironment and Planning B: Planning and Design 29 (3): 413–30.\nhttps://doi.org/10.1068/b12811.\n\n\nDong, Xiaojing, Moshe E. Ben-Akiva, John L. Bowman, and Joan L. Walker.\n2006. “Moving from Trip-Based to Activity-Based Measures of\nAccessibility.” Transportation Research Part A: Policy and\nPractice 40 (2): 163–80. https://doi.org/10.1016/j.tra.2005.05.002.\n\n\nEl-Geneidy, Ahmed, David Levinson, Ehab Diab, Genevieve Boisjoly, David\nVerbich, and Charis Loong. 2016. “The Cost of Equity:\nAssessing Transit Accessibility and Social Disparity Using\nTotal Travel Cost.” Transportation Research Part A: Policy\nand Practice 91 (September): 302–16. https://doi.org/10.1016/j.tra.2016.07.003.\n\n\nFarrington, John, and Conor Farrington. 2005. “Rural\nAccessibility, Social Inclusion and Social Justice: Towards\nConceptualisation.” Journal of Transport Geography 13\n(1): 1–12. https://doi.org/10.1016/j.jtrangeo.2004.10.002.\n\n\nGeurs, Karst, and Bert van Wee. 2004. “Accessibility Evaluation of\nLand-Use and Transport Strategies: Review and Research\nDirections.” Journal of Transport Geography 12 (2):\n127–40. https://doi.org/10.1016/j.jtrangeo.2003.10.005.\n\n\nGuzman, Luis A., and Daniel Oviedo. 2018. “Accessibility,\nAffordability and Equity: Assessing ‘Pro-Poor’\nPublic Transport Subsidies in Bogotá.” Transport\nPolicy 68 (September): 37–51. https://doi.org/10.1016/j.tranpol.2018.04.012.\n\n\nHerszenhut, Daniel, Rafael H. M. Pereira, Pedro R. Andrade, and João\nBazzo. 2022. “Gtfstools: General Transit Feed\nSpecification (GTFS) Editing and\nAnalysing Tools.” Zenodo. https://doi.org/10.5281/ZENODO.6577028.\n\n\nHerszenhut, Daniel, Rafael H. M. Pereira, Licinio da Silva Portugal, and\nMatheus Henrique de Sousa Oliveira. 2022. “The Impact of Transit\nMonetary Costs on Transport Inequality.” Journal of Transport\nGeography 99 (February): 103309. https://doi.org/10.1016/j.jtrangeo.2022.103309.\n\n\nHiggins, Christopher, Matthew Palm, Amber DeJohn, Luna Xi, James\nVaughan, Steven Farber, Michael Widener, and Eric Miller. 2022.\n“Calculating Place-Based Transit Accessibility:\nMethods, Tools and Algorithmic Dependence.”\nJournal of Transport and Land Use 15 (1). https://doi.org/10.5198/jtlu.2022.2012.\n\n\nKandt, Jens, and Michael Batty. 2021. “Smart Cities, Big Data and\nUrban Policy: Towards Urban Analytics for the Long\nRun.” Cities 109 (February): 102992. https://doi.org/10.1016/j.cities.2020.102992.\n\n\nKim, Hyun-Mi, and Mei-Po Kwan. 2003. “Space-Time Accessibility\nMeasures: A Geocomputational Algorithm with a Focus on the\nFeasible Opportunity Set and Possible Activity Duration.”\nJournal of Geographical Systems 5 (1): 71–91. https://doi.org/10.1007/s101090300104.\n\n\nLevine, Jonathan, Joe Grengs, and Louis A. Merlin. 2019. From\nMobility to Accessibility: Transforming Urban\nTransportation and Land-Use Planning. Cornell University\nPress.\n\n\nLevinson, David, and David King. 2020. Transport Access Manual:\nA Guide for Measuring Connection Between People and\nPlaces. Committee of the Transport Access Manual, University\nof Sydney.\n\n\nLucas, Karen, Giulio Mattioli, Ersilia Verlinghieri, and Alvaro Guzman.\n2016. “Transport Poverty and Its Adverse Social\nConsequences.” Proceedings of the Institution of Civil\nEngineers - Transport 169 (6): 353–65. https://doi.org/10.1680/jtran.15.00073.\n\n\nLucas, Karen, Bert van Wee, and Kees Maat. 2016. “A Method to\nEvaluate Equitable Accessibility: Combining Ethical Theories and\nAccessibility-Based Approaches.” Transportation 43 (3):\n473–90. https://doi.org/10.1007/s11116-015-9585-2.\n\n\nLuo, Wei, and Fahui Wang. 2003. “Measures of Spatial\nAccessibility to Health Care in a GIS\nEnvironment: Synthesis and a Case Study\nin the Chicago Region.” Environment and Planning\nB: Planning and Design 30 (6): 865–84. https://doi.org/10.1068/b29120.\n\n\nLuz, Gregório, and Licinio Portugal. 2022. “Understanding\nTransport-Related Social Exclusion Through the Lens of Capabilities\nApproach.” Transport Reviews 42 (4): 503–25. https://doi.org/10.1080/01441647.2021.2005183.\n\n\nMartens, Karel. 2012. “Justice in Transport as Justice in\nAccessibility: Applying Walzer’s\n‘Spheres of Justice’ to the\nTransport Sector.” Transportation 39 (6): 1035–53. https://doi.org/10.1007/s11116-012-9388-7.\n\n\nMcHugh, Bibiana. 2013. “Pioneering Open Data\nStandards: The GTFS Story.” In Beyond\nTransparency: Open Data and the\nFuture of Civic Innovation, edited by\nBrett Goldstein and Lauren Dyson, First, 125–35. San Francisco,\nCA: Code for America Press.\n\n\nMiller, Eric J. 2018. “Accessibility: Measurement and Application\nin Transportation Planning.” Transport Reviews 38 (5):\n551–55. https://doi.org/10.1080/01441647.2018.1492778.\n\n\nNassir, Neema, Mark Hickman, Ali Malekzadeh, and Elnaz Irannezhad. 2016.\n“A Utility-Based Travel Impedance Measure for Public Transit\nNetwork Accessibility.” Transportation Research Part A:\nPolicy and Practice 88 (June): 26–39. https://doi.org/10.1016/j.tra.2016.03.007.\n\n\nNeutens, Tijs, Tim Schwanen, Frank Witlox, and Philippe De Maeyer. 2010.\n“Equity of Urban Service Delivery: A\nComparison of Different Accessibility\nMeasures.” Environment and Planning A: Economy and\nSpace 42 (7): 1613–35. https://doi.org/10.1068/a4230.\n\n\nPaez, Antonio, Christopher D. Higgins, and Salvatore F. Vivona. 2019.\n“Demand and Level of Service Inflation in Floating Catchment\nArea (FCA) Methods.” Edited by Tayyab Ikram\nShah. PLOS ONE 14 (6): e0218773. https://doi.org/10.1371/journal.pone.0218773.\n\n\nPáez, Antonio, Darren M. Scott, and Catherine Morency. 2012.\n“Measuring Accessibility: Positive and Normative Implementations\nof Various Accessibility Indicators.” Journal of Transport\nGeography 25 (November): 141–53. https://doi.org/10.1016/j.jtrangeo.2012.03.016.\n\n\nPapa, Enrica, Cecilia Silva, Marco Te Brömmelstroet, and Angela Hull.\n2015. “Accessibility Instruments for Planning Practice: A Review\nof European Experiences.” Journal of Transport\nand Land Use, June. https://doi.org/10.5198/jtlu.2015.585.\n\n\nPereira, R. H. M., Carlos Kaue Vieira Braga, Bernardo Serra, and Vanessa\nNadalin. 2019. “Desigualdades socioespaciais de acesso a\noportunidades nas cidades brasileiras, 2019.” {Texto para\nDiscuss\\~ao} 2535. Instituto de Pesquisa Econômica Aplicada\n(Ipea).\n\n\nPereira, Rafael H. M., Pedro R. Andrade, and João Pedro Bazzo Vieira.\n2022. “Exploring the Time Geography of Public Transport Networks\nwith the Gtfs2gps Package.” SocArXiv. https://doi.org/10.31235/osf.io/qydr6.\n\n\nPereira, Rafael H. M., Carlos Kauê Vieira Braga, Daniel Herszenhut,\nMarcus Saraiva, and Diego Bogado Tomasiello. 2022.\n“Estimativas de acessibilidade a empregos e serviços\npúblicos via transporte ativo, público e privado nas 20 maiores cidades\ndo Brasil em 2017, 2018, 2019.” Texto para Discussão\nIPEA 2800.\n\n\nPereira, Rafael H. M., Daniel Herszenhut, Carlos Kauê Vieira Braga, João\nPedro Bazzo, João Lucas Albuquerque Oliveira, João Pedro Parga, Marcus\nSaraiva, Luiz Pedro Silva, Lucas Warwar, and Diego Bogado Tomasiello.\n2022. “Distribuição espacial de características\nsociodemográficas e localização de empregos e serviços públicos das\nvinte maiores cidades do Brasil.” Texto para Discussão\nIPEA 2772 (June): 28. https://doi.org/10.38116/td2772.\n\n\nPereira, Rafael H. M., and Alex Karner. 2021. “Transportation\nEquity.” In International\nEncyclopedia of Transportation, edited by\nRoger Vickerman, 271–77. Oxford: Elsevier. https://doi.org/10.1016/B978-0-08-102671-7.10053-3.\n\n\nPereira, Rafael H. M., Marcus Saraiva, Daniel Herszenhut, Carlos Kaue\nVieira Braga, and Matthew Wigginton Conway. 2021. “R5r:\nRapid Realistic Routing on Multimodal Transport\nNetworks with R5 in\nR.” Transport Findings, March, 21262. https://doi.org/10.32866/001c.21262.\n\n\nPereira, Rafael H. M., Tim Schwanen, and David Banister. 2017.\n“Distributive Justice and Equity in Transportation.”\nTransport Reviews 37 (2): 170–91. https://doi.org/10.1080/01441647.2016.1257660.\n\n\nPritchard, John P., Diego Tomasiello, Mariana Giannotti, and Karst\nGeurs. 2019. “An International Comparison of\nEquity in Accessibility to Jobs:\nLondon, São Paulo and the\nRandstad.” Findings, February. https://doi.org/10.32866/7412.\n\n\nSilva, Cecília, Luca Bertolini, Marco te Brömmelstroet, Dimitris\nMilakis, and Enrica Papa. 2017. “Accessibility Instruments in\nPlanning Practice: Bridging the Implementation Gap.”\nTransport Policy 53 (January): 135–45. https://doi.org/10.1016/j.tranpol.2016.09.006.\n\n\nvan Wee, Bert. 2021. “Transport Modes and\nAccessibility.” In International\nEncyclopedia of Transportation, edited by\nRoger Vickerman, 32–37. Oxford: Elsevier. https://doi.org/10.1016/B978-0-08-102671-7.10402-6.\n\n\n———. 2022. “Accessibility and Equity: A Conceptual\nFramework and Research Agenda.” Journal of Transport\nGeography 104 (October): 103421. https://doi.org/10.1016/j.jtrangeo.2022.103421.\n\n\nVasconcellos, Eduardo Alcantara. 2018. “Urban Transport Policies\nin Brazil: The Creation of a Discriminatory\nMobility System.” Journal of Transport Geography 67\n(February): 85–91. https://doi.org/10.1016/j.jtrangeo.2017.08.014.\n\n\nVenter, Christoffel. 2016. “Assessing the Potential of Bus Rapid\nTransit-Led Network Restructuring for Enhancing Affordable Access to\nEmployment The Case of Johannesburg’s\nCorridors of Freedom.” Research in\nTransportation Economics 59 (November): 441–49. https://doi.org/10.1016/j.retrec.2016.05.006."
  }
]