{
  "hash": "4330b9046840cd0710022565cdbec915",
  "result": {
    "markdown": "# Dados de distribuição espacial de oportunidades\n\n## Download dos dados\n\nO pacote `aopdata` também permite baixar, para todas cidades incluídas no projeto, dados anuais da distribuição espacial de empregos (de baixa, média e alta escolaridade), estabelecimentos de saúde (de baixa, média e alta complexidade), escolas pública (ensino infantil, fundamental e médio), e de centros de referência de assistência social (Cras).\n\nTodos esses dados podem ser baixados com a função `read_landuse()`, que funciona da mesma maneira que a função `read_population()`. Você só precisa indicar nos parâmetros da função qual cidade (`city`) e ano (`year`) devem ser baixados, além de apontar se deseja que os dados contenham as informações espaciais dos hexágonos  (`geometry = TRUE`).\n\nNeste exemplo, abaixo, nós mostramos como baixar os dados de uso do solo no ano de 2019 para Belo Horizonte. Note que essa função automaticamente já baixa também os dados de população, automaticamente.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(aopdata)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'aopdata' was built under R version 4.1.3\n```\n:::\n\n```{.r .cell-code}\n# download aop land use data\ndf <- read_landuse(city='Belo Horizonte',\n                      year=2019,\n                      geometry = TRUE,\n                      showProgress = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nDownloading land use data for the year 2019\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nDownloading population data for the year 2010\n```\n:::\n\n```{.r .cell-code}\nhead(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 6 features and 39 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -43.87914 ymin: -19.86084 xmax: -43.85906 ymax: -19.82421\nGeodetic CRS:  WGS 84\n           id_hex abbrev_muni      name_muni code_muni P001 P002 P003 P004 P005\n1 89a881345a3ffff         bho Belo Horizonte   3106200    0    0    0    0    0\n2 89a881345a7ffff         bho Belo Horizonte   3106200    0    0    0    0    0\n3 89a881345b7ffff         bho Belo Horizonte   3106200    0    0    0    0    0\n4 89a88136103ffff         bho Belo Horizonte   3106200  508  141  353    4   10\n5 89a88136107ffff         bho Belo Horizonte   3106200  428  114  304    3    7\n6 89a8813610bffff         bho Belo Horizonte   3106200  399  111  277    3    8\n  P006 P007 P010 P011 P012 P013 P014 P015 P016  R001 R002 R003 year T001 T002\n1    0    0    0    0    0    0    0    0    0    NA   NA   NA 2019    0    0\n2    0    0    0    0    0    0    0    0    0    NA   NA   NA 2019    0    0\n3    0    0    0    0    0    0    0    0    0    NA   NA   NA 2019    0    0\n4  253  255   53   86   30   43  176  110   10 502.9    2    3 2019  100   17\n5  210  218   42   72   27   38  142   98    9 491.8    2    3 2019   44   19\n6  203  196   42   68   24   34  138   86    7 502.8    2    3 2019  104   31\n  T003 T004 E001 E002 E003 E004 M001 M002 M003 M004 S001 S002 S003 S004 C001\n1    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0\n2    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0\n3    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0\n4   72   11    1    1    0    0  321  321    0    0    0    0    0    0    0\n5   23    2    0    0    0    0    0    0    0    0    0    0    0    0    0\n6   58   15    1    0    1    0  817    0  817    0    0    0    0    0    0\n                        geometry\n1 POLYGON ((-43.86011 -19.829...\n2 POLYGON ((-43.86313 -19.827...\n3 POLYGON ((-43.86321 -19.830...\n4 POLYGON ((-43.8731 -19.8608...\n5 POLYGON ((-43.87612 -19.859...\n6 POLYGON ((-43.87001 -19.859...\n```\n:::\n:::\n\n\n\n\nAntes de visualizar os dados de uso do solo nas próxima seções, vamos carregar algumas bibliotecas de visualização e manipulação de dados.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load libraries\nlibrary(patchwork)\nlibrary(ggplot2)\nlibrary(scales)\nlibrary(sf)\n```\n:::\n\n\n\n\n## Mapa de empregos\n\nComo nos exemplos anteriores, é possível visualizar o mapa de distribuição espacial de empregos usando o pacote `ggplot2` com o código abaixo:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data=df, aes(fill=T001), color=NA, alpha=.9) +\n  scale_fill_distiller(palette = \"YlGnBu\", direction = 1) +\n  labs(title='Distribuição espacial de empregos', \n       subtitle = 'Belo Horizonte', fill=\"N. de empregos\") +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](8_aopdata_uso_solo_files/figure-pdf/plot jobs-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Mapa de escolas\n\nAs variáveis que indicam o número de escolas em cada célula são aquelas que começam com a letra `E__`. Neste exemplo abaixo, nós mapeamos a distribuição espacial de todas escolas de Belo Horizonte a partir da variável `E001`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data=df, aes(fill=as.factor(E001)), color=NA, alpha=.9) +\n   scale_fill_brewer(palette = \"YlGnBu\", direction = 1) +\n  labs(title='Distribuição espacial de escolas', \n       subtitle = 'Belo Horizonte', fill=\"N. de escolas\") +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](8_aopdata_uso_solo_files/figure-pdf/plot schools-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Mapa de estabelecimentos de saúde\n\nPara analisar a distribuição espacial de estabelecimentos de saúde, você deve analisar as variáveis que começam com a letra `S___`. O código abaixo nos permite comparar a distribuição espacial de estabelecimentos de saúde de baixa complexidade (`S002`) e alta complexidade (`S004`).\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsau_b <- ggplot() +\n          geom_sf(data=df, aes(fill=as.factor(S002)), color=NA, alpha=.9) +\n          scale_fill_brewer(palette = \"YlGnBu\", direction = 1, limits=factor(0:4)) +\n          labs(title='Estabelecimentos de saúde', subtitle = 'Baixa complexidade',\n               fill=\"N. de estabelecimentos\") +\n          theme_void()\n\nsau_a <- ggplot() +\n          geom_sf(data=df, aes(fill=as.factor(S004)), color=NA, alpha=.9) +\n          scale_fill_brewer(palette = \"YlGnBu\", direction = 1, limits=factor(0:4)) +\n          labs(title='Estabelecimentos de saúde', subtitle = 'Alta complexidade',\n               fill=\"N. de estabelecimentos\") +\n          theme_void()\n\n# plot maps\nsau_b  + sau_a  + plot_layout(guides = 'collect')\n```\n\n::: {.cell-output-display}\n![](8_aopdata_uso_solo_files/figure-pdf/plot health facilities-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n## Mapa de CRAS\n\nPor fim, a distribuição espacial dos Centros de Referência de Assistência Social (Cras) pode ser analisada com a variável `C001`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data=df, aes(fill=as.factor(C001)), color=NA, alpha=.9) +\n   scale_fill_brewer(palette = \"YlGnBu\", direction = 1) +\n  labs(title='Centros de Referência de Assistência Social (Cras)', \n       subtitle = 'Belo Horizonte', fill=\"N. de Cras\") +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](8_aopdata_uso_solo_files/figure-pdf/plot cras-1.pdf){fig-pos='H'}\n:::\n:::\n",
    "supporting": [
      "8_aopdata_uso_solo_files\\figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}